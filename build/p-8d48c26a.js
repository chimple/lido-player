import{g as t}from"./p-ddf627b0.js";const e="lidoDragSelectedMap",o="lidoSelectedValues",n="lidoActivityScore",a="lidoNextContainer",c="lidoElementDrop",r="dropLength",i="dropHasDrag";var l,s;function d(t,e){const o=new CustomEvent(t,{detail:e});window.dispatchEvent(o)}function u(){d("lidoGameCompleted",{})}function m(t){d("lidoActivityChange",{index:t})}function f(t,e){d("lidoElementClick",{element:t,isCorrect:e,createdAt:(new Date).toISOString()})}!function(t){t.NoFlow="noFlow",t.ShowFlow="showFlow",t.FreeTrace="freeTrace",t.BlindTracing="blindTracing",t.BlindFreeTrace="blindFreeTrace"}(l||(l={})),function(t){t.Diagonal="diagonal"}(s||(s={}));class p{constructor(){}static getInstance(){return p.instance||(p.instance=new p),p.instance}setRiveInstance(t){this.riveInstance=t}getRiveInstance(){return this.riveInstance}}class h{constructor(){this.audioElement=document.createElement("audio"),this.audioElement.id="audio",document.body.appendChild(this.audioElement)}static getI(){return h.instance||(h.instance=new h),h.instance}stop(){(null===window||void 0===window?void 0:window.speechSynthesis)&&window.speechSynthesis.cancel(),this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement.src="",document.querySelectorAll(".speaking-highlight").forEach((t=>B(t)));const t=document.querySelector("#play"),e=document.querySelector("#pause");t&&e&&(t.style.visibility="visible",e.style.visibility="hidden")}async play(t){let e=t.getAttribute("audio")||"";if(!e){const o=t.children;for(let t=0;t<o.length;t++){const n=o[t].getAttribute("audio");n&&(e=n)}}if(e){e=L(e),this.audioElement.src=e,console.log("ðŸš€ Playing audio:",this.audioElement.src);try{await this.audioElement.play(),R(t),await new Promise((e=>{this.audioElement.onended=()=>{B(t),e()}}))}catch(t){console.log("ðŸš€ Audio play error:",t)}}else if(t.textContent)try{R(t),await async function(t){return new Promise(((e,o)=>{if(!("speechSynthesis"in window))return void o(new Error("Speech synthesis is not supported in this browser."));const n=window.speechSynthesis;setTimeout((()=>{const o=new SpeechSynthesisUtterance(t);o.onend=()=>{e(!0)},n.speak(o)}),50)}))}(t.textContent),B(t)}catch(t){console.log("ðŸš€ TTS Error:",t)}}}let g;function v(t){const e=window.getComputedStyle(t).transform;if(e&&"none"!==e){const t=e.match(/matrix\(([^)]+)\)/);if(t)return t[1].split(",").map((t=>parseFloat(t.trim())))[0]}return 1}function b(t,e){const o=Array.from(document.querySelectorAll(`[type="${e}"]`));let n=0,a=null;const c=t.getBoundingClientRect();for(const e of o){if(e===t)continue;const o=S(c,e.getBoundingClientRect());o>n&&(n=o,a=e)}return a}function x(t){return t instanceof MouseEvent?{clientX:t.clientX,clientY:t.clientY}:{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}}function S(t,e){return Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top))}const w=(t,e)=>{const n=document.querySelector("#lido-container").getAttribute("objective").split(",");let a=JSON.parse(localStorage.getItem(o))||[];a=Array.from(t.children).map((t=>t.getAttribute("value"))),localStorage.setItem(o,JSON.stringify(a));const c=a.indexOf(e.value);if(c>=0){const t=C(e.value,[n[c].trim()]);E(t),I()}},y=new class{constructor(){this.rightMoves=0,this.wrongMoves=0,this.finalScore=0}};function O(t,e,o){return(t||"")+(e?` ${e}`:"")+(o?` ${o}`:"")}const N=t=>{t.style.animation="unset";const e=window.getComputedStyle(t).transform;if("none"===e)return 1;{const t=e.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");return parseFloat(e[0])}}return 1},k=(t,e)=>{const o=t.getBoundingClientRect(),n=document.querySelectorAll(`[type="${e}"]`);let a=null,c=0;return n.forEach((n=>{if(n===t)return;const r=n.getBoundingClientRect(),i=Math.max(0,Math.min(o.right,r.right)-Math.max(o.left,r.left))*Math.max(0,Math.min(o.bottom,r.bottom)-Math.max(o.top,r.top));0!==i&&("slide"===e?i>=.8*Math.min(o.width*o.height,r.width*r.height)&&i>c&&(c=i,a=n):i>c&&(c=i,a=n))})),a};async function J(t,n){var a;const l=localStorage.getItem(o)||"",u=localStorage.getItem(e);let m=JSON.parse(localStorage.getItem(i)||" {}");if(n&&(null===(a=n.getAttribute("dropAttr"))||void 0===a?void 0:a.toLowerCase())!==s.Diagonal&&("true"===n.getAttribute("isAllowOnlyOneDrop")||!n.getAttribute("isAllowOnlyOneDrop"))){const o=Object.values(m).find((t=>document.getElementById(t.drop)===n));if(o?o.isFull=!0:console.warn("No matching drop item found for",n),localStorage.setItem(i,JSON.stringify(m)),k(t,"drag")){if(t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease",u){let o=JSON.parse(u);for(const e in o)o[e].includes(t.value)&&delete o[e];localStorage.setItem(e,JSON.stringify(o))}return void document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))}))}}if(!n){t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease";let n=W.get(t);if(n){let e=Object.values(m).find((t=>document.getElementById(t.drop)===n));e&&(e.isFull=!1,localStorage.setItem(i,JSON.stringify(m))),W.delete(t)}if(l){let e=JSON.parse(l);e=e.filter((e=>e!=t.value)),localStorage.setItem(o,JSON.stringify(e))}if(u){let o=JSON.parse(u);for(const e in o)o[e].includes(t.value)&&delete o[e];localStorage.setItem(e,JSON.stringify(o))}return document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),void I()}if(u){let o=W.get(t);if(o){let t=Object.values(m).find((t=>document.getElementById(t.drop)===o));t&&(t.isFull=!1,localStorage.setItem(i,JSON.stringify(m)))}let n=JSON.parse(u);for(const e in n)n[e].includes(t.value)&&delete n[e];localStorage.setItem(e,JSON.stringify(n))}let f=JSON.parse(localStorage.getItem(r))||0;if(f+=1,localStorage.setItem(r,JSON.stringify(f)),f===A(n.value)){const t=Object.values(m).find((t=>document.getElementById(t.drop)===n));t?t.isFull=!0:console.warn("No matching drop item found for",n),localStorage.setItem(i,JSON.stringify(m)),f=0,localStorage.setItem(r,JSON.stringify(f))}W.set(t,n);const p=n.value.includes(t.value);if(function(t,e,o){d(c,{dragElement:t,dropElement:e,isCorrect:o,createdAt:(new Date).toISOString()})}(t,n,p),p){const e=n.getAttribute("onCorrect");e&&await $(e,n,t)}else{const e=n.getAttribute("onInCorrect");await $(e,n,t)}E(p),t.style.opacity="1",await async function(t,n){var a;const c=document.querySelector("#lido-container");if(!c)return;if("true"===c.getAttribute("isAllowOnlyCorrect")&&!n.value.includes(t.value))return void(t.style.transform="translate(0,0)");await $("this.alignMatch='true'",n,t);let r=JSON.parse(null!==(a=localStorage.getItem(e))&&void 0!==a?a:"{}");const i=n.getAttribute("tabindex");r[i]||(r[i]=[]),r[i].push(t.value),localStorage.setItem(e,JSON.stringify(r));const l=Object.keys(r).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>{const o=r[e];return t.push(o.length>1?`(${o.join("|")})`:o[0]),t}),[]);localStorage.setItem(o,JSON.stringify(l)),document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),I()}(t,n)}const $=async(t,e,o)=>{var n;const a=M(t);for(let t=0;t<a.length;t++){const c=a[t],r=document.querySelector(c.actor),i="this"===c.actor?e:"element"===c.actor?o:r||document.getElementById(c.actor);if(i)switch(c.action){case"transform":{const t=window.getComputedStyle(i).transform;i.style.transform="none"!==t?`${t} ${c.value}`:c.value;break}case"alignMatch":{const t=i,e=o,a=document.querySelector("#lido-container"),c=N(a);e.style.transform="translate(0,0)";const r=t.getBoundingClientRect(),l=e.getBoundingClientRect(),d=(r.left+r.width/2-(l.left+l.width/2))/c,u=(r.top+r.height/2-(l.top+l.height/2))/c;e.style.transform=(null===(n=o.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())===s.Diagonal?`translate(${d-70}px, ${u-70}px)`:`translate(${d}px, ${u}px)`;break}case"removeClone":document.querySelectorAll(c.value).forEach((t=>t.remove()));break;case"addClass":i.classList.add(c.value);break;case"speak":await h.getI().play(i);break;case"stop":await h.getI().stop();break;case"sleep":!isNaN(Number(c.value))&&await new Promise((t=>setTimeout(t,Number(c.value))));break;case"avatarAnimate":{const t=p.getInstance().getRiveInstance();t&&c.value&&t.play(c.value);break}default:i.style[c.action]=c.value}}},M=t=>{var e;const o=[];return t?((null===(e=t.split(";"))||void 0===e?void 0:e.map((t=>t.trim()))).forEach((t=>{if(t){const[e,n]=t.split("=").map((t=>t.trim())),a=e.lastIndexOf(".");if(-1!==a){const t=e.substring(0,a).trim(),c=e.substring(a+1).trim();o.push({actor:t,action:c,value:n.replace(/['"]/g,"")})}}})),o):o},C=(t,e)=>{const o=t.split(",").map((t=>t.trim()));let n=0,a=new Set;for(const t of o)if(t.startsWith("(")&&t.endsWith(")")){const o=t.slice(1,-1).split("|").map((t=>t.trim())),a=e[n].slice(1,-1).split("|").map((t=>t.trim()));if(n>=a.length)return!1;for(let t=0;t<o.length;t++)if(!o.includes(a[t]))return!1;n++}else if(t.includes("|")){const e=t.split("|").map((t=>t.trim()));for(const t of e)a.add(t)}else{if(n>=e.length||e[n]!==t)return!1;n++}for(;n<e.length;){if(!a.has(e[n]))return!1;a.delete(e[n]),n++}return n===e.length},A=t=>{const e=t.split(",").map((t=>t.trim()));let o=0;for(const t of e)t.startsWith("(")&&t.endsWith(")")?t.includes("|")?o+=t.split("|").length:o+=1:o+=t.split("|").length;return o},E=t=>{t?y.rightMoves+=1:y.wrongMoves+=1,console.log("Right Moves : ",y.rightMoves),console.log("Wrong Moves : ",y.wrongMoves)},I=()=>{var t;const e=document.querySelector("#lido-container"),n=e.objective,a=null!==(t=localStorage.getItem(o))&&void 0!==t?t:"",c=document.querySelector("#lido-checkButton");a&&A(a)===A(n)?"true"==e.getAttribute("showCheck")?c.classList.remove("lido-disable-check-button"):j():$("this.addClass='lido-disable-check-button'",c)},j=async()=>{var t;const e=document.querySelector("#lido-container");if(!e)return;const a=e.objective,c=null!==(t=JSON.parse(localStorage.getItem(o)))&&void 0!==t?t:[];if(C(a,c)){const t=e.getAttribute("onCorrect");t&&await $(t,e),T()}else{const t=e.getAttribute("onInCorrect");await $(t,e),"true"===e.getAttribute("isContinueOnCorrect")||T()}await(()=>{const t=y.rightMoves;(t=>{var e,o,a;const c=document.querySelector("lido-home");if(!c)return;const r=Number(null!==(e=c.getAttribute("index"))&&void 0!==e?e:0),i=Number(null!==(o=c.getAttribute("totalIndex"))&&void 0!==o?o:0),l=JSON.parse(null!==(a=localStorage.getItem(n))&&void 0!==a?a:"{}");if(l[r.toString()]=t,function(t,e,o){d("lidoActivityEnd",{index:t,totalIndex:e,score:o})}(r,i,t),localStorage.setItem(n,JSON.stringify(l)),i-1==r){const t=Object.values(l),e=t.reduce(((t,e)=>t+e),0)/t.length;y.finalScore=Math.floor(e),console.log("Total Score : ",y.finalScore),function(t){d("lidoLessonEnd",{score:t})}(e),localStorage.removeItem(n)}})(Math.floor(t/(t+y.wrongMoves)*100)),y.rightMoves=0,y.wrongMoves=0})()},T=()=>{h.getI().stop(),console.log("ðŸš€ ~ triggerNextContainer ~ event:",event),d(a,{})},F=async(t,n)=>{const a=document.querySelector("#lido-container");if(!a)return;const c=t.getAttribute("onEntry");await $(c,t);const r=a.getAttribute("canplay");if(null==r||"false"!==r){switch(n){case"drag":!function(t){let o=!1,n=!1,a=0,c=0,r=0,i=0,l=null;const d=document.querySelector("#lido-container");if(!d)return void console.error('Container with ID "container" not found.');let u,m;X(t,"drag");const f=e=>{var d;if(h.getI().stop(),P(t),o=!0,n=!0,e instanceof MouseEvent?(a=e.clientX,c=e.clientY):(a=e.touches[0].clientX,c=e.touches[0].clientY),t.style.opacity="0.8",t.style.cursor="grabbing",(null===(d=t.getAttribute("dropAttr"))||void 0===d?void 0:d.toLowerCase())===s.Diagonal){const e=window.getComputedStyle(t),o=t.getBoundingClientRect();l||(l=t.cloneNode(!0),l.style.left=`${o.left}px`,l.style.top=`${o.top}px`,l.style.width=`${o.width}px`,l.style.height=`${o.height}px`,l.style.transform=e.transform,l.style.zIndex="0",l.setAttribute("visible","true"),l.classList.add("cloned-element"),document.body.appendChild(l))}const u=window.getComputedStyle(t).transform;if("none"!==u){const t=u.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");r=parseFloat(e[4]),i=parseFloat(e[5])}}else r=0,i=0;document.addEventListener("mousemove",b),document.addEventListener("mouseup",S),document.addEventListener("touchmove",b),document.addEventListener("touchend",S)},p=d.getBoundingClientRect(),g=t.getBoundingClientRect();u=p.top-g.top,m=p.left-g.left;const v=new MutationObserver((e=>{for(const o of e)if("attributes"===o.type&&"style"===o.attributeName){const e=d.getBoundingClientRect(),o=t.getBoundingClientRect();u=e.top-o.top,m=e.left-o.left}}));v.observe(d,{attributes:!0,attributeFilter:["style"]});const b=l=>{if(!o)return;n=!1,t.style.transition="none";const f=N(d);let p=0,h=0;l instanceof MouseEvent?(p=(l.clientX-a)/f,h=(l.clientY-c)/f):(p=(l.touches[0].clientX-a)/f,h=(l.touches[0].clientY-c)/f);const g=r+p,v=i+h,b=d.getBoundingClientRect(),x=t.getBoundingClientRect(),S=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),w=x.left/f-S[0],y=x.top-S[1],O=b.width/f-Math.abs(m/f)-x.width/f,J=b.left-w,$=b.top-y,M=b.height/f-Math.abs(u/f)-x.height/f,C=g+w<=b.left?J:Math.min(g,O),A=v+y<=b.top?$:Math.min(v,M);t.style.transform=`translate(${C}px, ${A}px)`;let E=k(t,"drop");document.querySelectorAll("[type='drop']").forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==s.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))})),E&&("lido-text"===E.tagName.toLowerCase()?(E.style.border="2px dashed #ff0000",E.style.backgroundColor="rgba(255, 0, 0, 0.1)"):E.style.opacity="0.3")};let x=null;const S=()=>{var a;if(o=!1,n)return l&&(l.remove(),l=null),void(t.style.opacity="1");document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",S),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",S),t.style.opacity="",t.style.cursor="move";const c=document.querySelectorAll("[type='drop']");c.forEach((()=>{c.forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==s.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))}))}));let r=k(t,"drop");J(t,r),(null===(a=t.getAttribute("dropAttr"))||void 0===a?void 0:a.toLowerCase())===s.Diagonal&&(r?t&&(t.classList.add("diagonal-drop"),r.classList.add("diagonal-target"),x=r):(x&&(x.classList.remove("diagonal-target"),x=null),null==t||t.classList.remove("diagonal-drop"),t.style.transform="translate(0, 0)",l&&(l.remove(),l=null)))};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",f),t.addEventListener("touchstart",f),t.addEventListener("click",(()=>{n&&D(t,"drag")}))}(t);break;case"click":!function(t){if(X(t,"click"),t.style.cursor="pointer",!t)return void console.error("No element provided.");t.addEventListener("click",(async()=>{h.getI().stop();const n=document.querySelector("#lido-container"),a=n.objective.split(","),c=document.querySelector("#lido-checkButton"),r="true"===n.getAttribute("showCheck");if("lido-checkButton"==t.getAttribute("id"))return c.classList.add("lido-disable-check-button"),void await j();const i=t.classList.contains("lido-element-selected");let l=JSON.parse(localStorage.getItem(o))||[];if(1===a.length){localStorage.setItem(o,JSON.stringify([t.value]));const e=a.includes(t.value);if(f(t,e),e){const e=t.getAttribute("onCorrect");t.style.pointerEvents="none",await $(e,t)}else{const e=t.getAttribute("onInCorrect");await $(e,t)}return E(e),void I()}if(r&&c.classList.remove("lido-disable-check-button"),i){t.classList.remove("lido-element-selected"),$(t.getAttribute("onEntry"),t),l=l.filter((e=>e!=t.value)),localStorage.setItem(o,JSON.stringify(l));let n=JSON.parse(localStorage.getItem(e))||{};const a=t.value,i=Object.keys(n).find((t=>n[t].includes(a)));if(i){n[i]=n[i].filter((t=>t!==a)),0===n[i].length&&delete n[i],localStorage.setItem(e,JSON.stringify(n));const t=Object.keys(n).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(n[e])),[]);localStorage.setItem(o,JSON.stringify(t))}r&&0===l.length&&c.classList.add("lido-disable-check-button")}else{{t.classList.add("lido-element-selected");const n=t.value,c=Object.keys(a).find((t=>a[t]===n));let r=JSON.parse(localStorage.getItem(e))||{};c?r[c]=[n]:r[a.length+l.length]=[n],localStorage.setItem(e,JSON.stringify(r));const i=Object.keys(r).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(r[e])),[]);localStorage.setItem(o,JSON.stringify(i));const s=a.includes(t.value);if(f(t,s),s){const e=t.getAttribute("onCorrect");await $(e,t)}else{const e=t.getAttribute("onInCorrect");await $(e,t)}E(s)}r||A(a)!==A(l)||j()}})),t.addEventListener("pointerdown",(()=>{"clickable"===t.getAttribute("animation")&&(t.classList.add("removeShadow"),t.style.top="40px",t.style.position="relative")})),t.addEventListener("pointerup",(()=>{"clickable"===t.getAttribute("animation")&&setTimeout((()=>{t.classList.remove("removeShadow"),t.style.top="0px",t.style.position="relative"}),50)}))}(t);break;case"drop":!function(t){let e=JSON.parse(localStorage.getItem(i)||"{}");const o=t.getAttribute("tabIndex");"object"==typeof e&&null!==e||(e={}),e[o]||(e[o]={drop:t.id,isFull:!1},localStorage.setItem(i,JSON.stringify(e))),t.onclick=()=>{D(t,"drop")},X(t,"drop")}(t);break;case"slide":!function(t){let e=!1,n=!1,a=0,c=0,r=0,i=0;const l=t.parentElement;if(!l)return void console.error("Parent element not found.");const s=e=>{P(t),n=!0,e instanceof MouseEvent?(a=e.clientX,c=e.clientY):(a=e.touches[0].clientX,c=e.touches[0].clientY),t.style.opacity="0.8",t.style.cursor="grabbing";const o=window.getComputedStyle(t).transform;if("none"!==o){const t=o.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");r=parseFloat(e[4]),i=parseFloat(e[5])}}else r=0,i=0;l.getBoundingClientRect(),t.getBoundingClientRect(),document.addEventListener("mousemove",d),document.addEventListener("mouseup",u),document.addEventListener("touchmove",d),document.addEventListener("touchend",u)};new MutationObserver((e=>{for(const o of e)"attributes"===o.type&&"style"===o.attributeName&&(l.getBoundingClientRect(),t.getBoundingClientRect())})).observe(l,{attributes:!0,attributeFilter:["style"]});const d=o=>{if(!n)return;const s=N(l);let d=0,u=0;o instanceof MouseEvent?(d=(o.clientX-a)/s,u=(o.clientY-c)/s):(d=(o.touches[0].clientX-a)/s,u=(o.touches[0].clientY-c)/s);const m=r+d,f=i+u,p=l.getBoundingClientRect(),h=t.getBoundingClientRect(),g=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),v=h.left/s-g[0],b=h.top-g[1],x=p.top-b,S=p.bottom-(h.bottom-g[1]),w=m+v<=p.left?p.left-v:Math.min(m,p.right-(h.right/s-g[0])),y=f+b<=p.top?x:Math.min(f,S);t.style.transform=`translate(${w}px, ${y}px)`;let O=k(t,"slide");if(O&&O!=t){const n=t.parentElement,l=O.parentElement;if(n&&l){const s=document.createComment("element-placeholder"),d=document.createComment("overlapped-placeholder");n.replaceChild(s,t),l.replaceChild(d,O),n.replaceChild(O,s),l.replaceChild(t,d),t.style.transform="translate(0, 0)",a=o instanceof MouseEvent?o.clientX:o.touches[0].clientX,c=o instanceof MouseEvent?o.clientY:o.touches[0].clientY,r=0,i=0,e=!0}}},u=()=>{n=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",u),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",u),t.style.opacity="",t.style.cursor="move",t.style.transform="translate(0, 0)",e&&((t=>{const e=JSON.parse(localStorage.getItem(o))||[],n=document.querySelectorAll("[type='slide']");let a=0;n.forEach((t=>{e[a++]=t.value})),localStorage.setItem(o,JSON.stringify(e));const c=document.querySelector("#lido-container").objective.split(","),r=e.indexOf(t.value),i=C(t.value,[c[r].trim()]);E(i),I()})(t),e=!1)};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",s),t.addEventListener("touchstart",s),t.addEventListener("click",(()=>{D(t,"drag")}))}(t);break;case"word":!function(t){let e=!1,o=!1,n=0,a=0,c=0,r=0;const i=document.querySelector("#lido-container"),l=document.querySelector('[type="blank"]'),s=t.parentElement!==l?t.parentElement:null;if(!i)return void console.error('Container with ID "lido-container" not found.');const d=t=>{o=!0,e=!1;const n=x(t);c=n.clientX,r=n.clientY,document.addEventListener("mousemove",u),document.addEventListener("mouseup",m),document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",m)},u=s=>{const d=x(s),u=Math.abs(d.clientX-c),m=Math.abs(d.clientY-r);if(!e&&(u>5||m>5)){if(e=!0,o=!1,t.parentElement!==l){const e=t.style.width,o=t.style.padding,n=document.createElement("div");t.style.width="auto",t.style.padding="0 20px",n.style.width=`${t.offsetWidth+20}px`,n.style.height=`${t.offsetHeight+20}px`,n.style.border="1px solid",n.style.backgroundColor="#00000021",n.style.borderRadius="10px",t.style.width=e,t.style.padding=o,n.setAttribute("value",`${t.getAttribute("value")}`),t.parentElement.insertBefore(n,t.nextElementSibling)}const c=i.getBoundingClientRect(),r=v(i),s=(d.clientY-c.top-a)/r;t.style.left=(d.clientX-c.left-n)/r+"px",t.style.top=`${s}px`;const u=t.getBoundingClientRect();n=d.clientX-u.left,a=d.clientY-u.top,t.style.opacity="0.8",t.style.cursor="grabbing",t.style.position="absolute",t.style.zIndex="1000",t.style.touchAction="none",t.style.transition="none"}if(!e)return;s.preventDefault();const f=i.getBoundingClientRect(),p=v(i),h=(d.clientY-f.top-a)/p;t.style.left=(d.clientX-f.left-n)/p+"px",t.style.top=`${h}px`;const S=b(t,"word")||b(t,"dummy");S&&S.parentElement!==document.querySelector('[type="blank"]')||S&&"dummy"===S.getAttribute("type")||null!==g&&g===S||(function(t,e){var o,n;if(t===e)return;if(!b(t,"blank"))return;const a=document.querySelector('[type="blank"]'),c=document.querySelector('[type="dummy"]');if(c)e?null===(o=e.parentNode)||void 0===o||o.insertBefore(c,e):a.appendChild(c);else{const o=t.style.width,c=t.style.padding,r=document.createElement("div");t.style.width="auto",t.style.padding="0 20px",r.style.width="0px",r.style.height="0px",t.style.width=o,t.style.padding=c,r.setAttribute("type","dummy");const i=`\n      @keyframes widthIncrease {\n        0% { width: 0px; height: 0px; }\n        100% { width: ${t.offsetWidth}px; height: ${t.offsetHeight}px;}\n      }\n    `;e?null===(n=e.parentNode)||void 0===n||n.insertBefore(r,e):a.appendChild(r);const l=document.styleSheets[0];l.insertRule(i,l.cssRules.length),r.style.animation="widthIncrease 0.3s",r.addEventListener("animationend",(()=>{r.style.width=`${t.offsetWidth}px`,r.style.height=`${t.offsetHeight}px`}))}}(t,S),g=S)},m=()=>{if(e=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",m),o){if(o=!1,t.parentElement===s){const e=document.createElement("div"),o=t.style.width,n=t.style.padding;t.style.width="auto",t.style.padding="0 20px",e.style.width=`${t.offsetWidth+20}px`,e.style.height=`${t.offsetHeight+20}px`,t.style.width=o,t.style.padding=n,l.appendChild(e),t.style.transition="transform 0.5s ease",$("this.alignMatch=true",e,t),setTimeout((()=>{const a=document.createElement("div");t.style.width="auto",t.style.padding="0 20px",a.style.width=`${t.offsetWidth+20}px`,a.style.height=`${t.offsetHeight+20}px`,a.style.border="1px solid",a.style.backgroundColor="#00000021",a.style.borderRadius="10px",t.style.width=o,t.style.padding=n,a.setAttribute("value",`${t.getAttribute("value")}`),t.parentElement.insertBefore(a,t.nextElementSibling),t.style.transform="translate(0,0)",e.replaceWith(t),w(l,t)}),500)}else{const e=Array.from(s.children).find((e=>e.getAttribute("value")===t.getAttribute("value")));t.style.transition="transform 0.5s ease",$("this.alignMatch=true",e,t),setTimeout((()=>{t.style.transform="translate(0,0)",e.replaceWith(t)}),500)}return}const n=document.querySelector('[type="dummy"]');if(n&&n.replaceWith(t),s){const e=Array.from(s.children),o=function(t,e){const o=t.getBoundingClientRect(),n=e.getBoundingClientRect();return!(o.right<n.left||o.left>n.right||o.bottom<n.top||o.top>n.bottom)}(t,s);console.log("overlap : ",o),(o||t.parentElement===s)&&e.forEach((e=>{e!==t&&e.getAttribute("value")===t.getAttribute("value")&&e.replaceWith(t)}))}t.style.opacity="",t.style.cursor="move",t.style.zIndex="",t.style.transform="",t.style.transition="",t.style.position="",t.style.left="",t.style.top="",g=null,w(l,t)};t.style.cursor="move",t.addEventListener("mousedown",d),t.addEventListener("touchstart",d)}(t)}!function(t){if(!t)return;const e=t.getAttribute("onTouch");e&&(t.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",e),e&&await $(e,t)})}(t)}};async function D(t,e){if(document.querySelectorAll(`[type='${e}']`).forEach((t=>{P(t)})),!document.querySelector("#dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style",t.innerHTML="\n      .highlight {\n        // border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        // border-radius: 12px; /* Larger rounded corners */\n        // background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        // box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        // outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    ",document.head.appendChild(t)}null==t||t.classList.add("highlight"),t.ariaPressed="true";const o="drop"===e?t:document.querySelector("[type='drop'].highlight"),n="drag"===e?t:document.querySelector("[type='drag'].highlight");if(o||async function(t){const e=JSON.parse(localStorage.getItem(i)||"{}"),o=t;if(!o)return void console.error("Element not found");const n=getComputedStyle(o).transform;if(P(t),n&&"none"!==n&&"matrix(1, 0, 0, 1, 0, 0)"!==n)return o.style.transition="transform 0.5s ease",o.style.transform="translate(0px, 0px)",void J(o,null);let a=Object.values(e).find((t=>!t.isFull));if(a){const t=document.querySelector(`#${a.drop}`);o.style.transition="transform 0.5s ease",J(o,t)}}(t),o&&n){n.style.transition="transform 0.5s ease",n.style.transform="";const t=document.querySelector("#lido-container"),e=N(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",e);const a=o.getBoundingClientRect(),c=n.getBoundingClientRect();n.style.transform=`translate(${(a.left-c.left)/e}px, ${(a.top-c.top)/e}px)`,document.querySelectorAll("*").forEach((t=>{P(t)})),await J(n,o)}}const W=new Map;function P(t){t.classList.remove("highlight"),t.ariaPressed="false"}function R(t){if(!t)return;t.classList.add("speaking-highlight");const e="#speaking-highlight-style";if(!document.querySelector(e)){const o=document.createElement("style");o.id=e,o.innerHTML=`\n      .speaking-highlight {\n        --base-transform: ${t.style.transform};\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9) !important; /* Stronger orange glow effect */\n        // border: 3px solid green !important;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: var(--base-transform) scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n      }\n    `,document.head.appendChild(o)}}function B(t){t&&t.classList.remove("speaking-highlight")}function L(e){const o=document.querySelector("#lido-container").getAttribute("baseUrl");return(null==e?void 0:e.startsWith("http"))||(null==e?void 0:e.startsWith("blob"))?e:o?o+e:t(e)}function G(t,e,o,n,a){if(void 0===n)return;const c=Array.from(t.children);let r=n;e&&n<e&&(r=e),o&&n>o&&(r=o),c.forEach(((t,e)=>{t.style.display=e<r?a:"none"}))}const U=(t,e)=>t&&t.includes(",")?t.split(",").reduce(((t,e)=>{const[o,n]=e.split(".");return t[o.trim()]=n.trim(),t}),{})[e]||"":t,X=(t,e)=>{const o=document.querySelectorAll("[type='drag']"),n=document.querySelectorAll("[type='drop']"),a=document.querySelectorAll("[type='click']");let c=0;if("click"===e)return a.forEach((t=>{const e=t;let o=null;if(e.getAttribute("flexibleWidth"))o=e;else{const t=e.children;for(let e=0;e<t.length;e++){const n=t[e];if(n.getAttribute("flexibleWidth")){o=n;break}}}if(o){const t=o.style.width,e=o.style.padding;o.style.width="auto",o.style.padding="0 20px";const n=o.offsetWidth;o.style.width=t,o.style.padding=e,n>c&&(c=n)}})),void a.forEach((t=>{const e=t;if(e.getAttribute("flexibleWidth")){if("true"===e.getAttribute("flexibleWidth"))return;e.style.width=`${c}px`}else{const t=e.children;for(let e=0;e<t.length;e++){const o=t[e];if(o.getAttribute("flexibleWidth")){if("true"===o.getAttribute("flexibleWidth"))return;o.style.width=`${c}px`;break}}}}));o.forEach((t=>{const e=t,o=e.style.width,n=e.style.padding;e.style.width="auto",e.style.padding="0 20px";const a=e.offsetWidth;e.style.width=o,e.style.padding=n,a>c&&(c=a)})),o.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");"false"===n?o.style.width=`${c}px`:"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")})),n.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");if("false"===n){const t=parseFloat(getComputedStyle(o).borderWidth);if("number"==typeof t){const e=c-2*t,n=parseFloat(o.style.height)-2*t;return o.style.height=`${n}px`,void(o.style.width=`${e}px`)}}else"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")}))};export{e as D,a as N,p as R,o as S,l as T,r as a,i as b,L as c,m as d,u as e,O as f,G as h,F as i,U as p,T as t}