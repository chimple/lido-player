const t="dragSelectedMap";const n="selectedValues";function e(t,n,e){return(t||"")+(n?` ${n}`:"")+(e?` ${e}`:"")}const o=t=>{const n=window.getComputedStyle(t).transform;if(n==="none"){return 1}else{const t=n.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");const e=parseFloat(n[0]);return e}}return 1};function c(t){let n=false;let e=0;let c=0;let r=0;let a=0;const i=document.getElementById("container");if(!i){console.error(`Container with ID "container" not found.`);return}const l=o=>{p(t);n=true;if(o instanceof MouseEvent){e=o.clientX;c=o.clientY}else{e=o.touches[0].clientX;c=o.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const s=window.getComputedStyle(t).transform;if(s!=="none"){const t=s.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");r=parseFloat(n[4]);a=parseFloat(n[5])}}else{r=0;a=0}document.addEventListener("mousemove",b);document.addEventListener("mouseup",w);document.addEventListener("touchmove",b);document.addEventListener("touchend",w)};const u=i.getBoundingClientRect();const d=t.getBoundingClientRect();let f=u.top-d.top;let m=u.left-d.left;const h=new MutationObserver((n=>{for(const e of n){if(e.type==="attributes"&&e.attributeName==="style"){const n=i.getBoundingClientRect();const e=t.getBoundingClientRect();f=n.top-e.top;m=n.left-e.left}}}));const x={attributes:true,attributeFilter:["style"]};h.observe(i,x);const b=s=>{if(!n)return;const l=o(i);let u=0;let d=0;if(s instanceof MouseEvent){u=(s.clientX-e)/l;d=(s.clientY-c)/l}else{u=(s.touches[0].clientX-e)/l;d=(s.touches[0].clientY-c)/l}const h=r+u;const g=a+d;const p=i.getBoundingClientRect();const x=t.getBoundingClientRect();const b=t.style.transform.match(/-?\d+(\.\d+)?/g);const w=b.map(Number);const v=x.left/l-w[0];const M=x.top-w[1];const S=p.width/l-Math.abs(m/l)-x.width/l;const y=p.left-v;const k=p.top-M;const E=p.height/l-Math.abs(f/l)-x.height/l;const $=h+v<=p.left?y:Math.min(h,S);const N=g+M<=p.top?k:Math.min(g,E);t.style.transform=`translate(${$}px, ${N}px)`;const O=document.querySelectorAll("[type='drop']");let C=null;let T=0;O.forEach((t=>{const n=t.getBoundingClientRect();const e=Math.max(0,Math.min(x.right,n.right)-Math.max(x.left,n.left));const o=Math.max(0,Math.min(x.bottom,n.bottom)-Math.max(x.top,n.top));const c=e*o;if(c>T){T=c;C=t}}));O.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));if(C){C.style.border="2px dashed #ff0000";C.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const w=e=>{console.log("ðŸš€ ~ onEnd ~ endEv:",e);n=false;document.removeEventListener("mousemove",b);document.removeEventListener("mouseup",w);document.removeEventListener("touchmove",b);document.removeEventListener("touchend",w);t.style.opacity="";t.style.cursor="move";const o=document.querySelectorAll("[type='drop']");o.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));const c=t.getBoundingClientRect();let r=null;let a=0;o.forEach((t=>{const n=t.getBoundingClientRect();const e=Math.max(0,Math.min(c.right,n.right)-Math.max(c.left,n.left));const o=Math.max(0,Math.min(c.bottom,n.bottom)-Math.max(c.top,n.top));const s=e*o;if(s>a){a=s;r=t}}));s(t,r)};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",l);t.addEventListener("touchstart",l);t.addEventListener("click",(n=>{g(t,"drag")}))}function s(e,o){var c;if(!o)return;let s=JSON.parse((c=localStorage.getItem(t))!==null&&c!==void 0?c:"{}");if(!s[o.getAttribute("tabindex")]){s[o.getAttribute("tabindex")]=[]}s[o.getAttribute("tabindex")]=[e["value"]];localStorage.setItem(t,JSON.stringify(s));const a=Object.keys(s).sort(((t,n)=>parseInt(t)-parseInt(n)));const u=a.reduce(((t,n)=>t.concat(s[n])),[]);console.log("ðŸš€ ~ onEnd ~ dragScore:",s,u);localStorage.setItem(n,JSON.stringify(u));if(i(o["value"],[e["value"]])){const t=o.getAttribute("onMatch");if(t){r(t,o,e)}}else{m([o,e])}l()}const r=(t,n,e)=>{console.log("ðŸš€ ~ executeActions ~ actionsString:",t);const o=a(t);console.log("ðŸš€ ~ executeActions ~ actions:",o);o.forEach((t=>{const o=t.actor==="this"?n:t.actor==="element"?e:document.getElementById(t.actor);console.log("ðŸš€ ~ executeActions ~ targetElement:",o,t.action);if(o){if(t.action==="transform"){const n=window.getComputedStyle(o).transform;o.style.transform=n!=="none"?`${n} ${t.value}`:t.value}else{o.style[t.action]=t.value}}}))};const a=t=>{const n=[];const e=t.split(";").map((t=>t.trim()));e.forEach((t=>{if(t){const[e,o]=t.split("=").map((t=>t.trim()));const c=e.lastIndexOf(".");if(c!==-1){const t=e.substring(0,c).trim();const s=e.substring(c+1).trim();n.push({actor:t,action:s,value:o.replace(/['"]/g,"")})}}}));return n};const i=(t,n)=>{const e=t.split(",").map((t=>t.trim()));let o=0;let c=new Set;for(const t of e){if(t.startsWith("(")&&t.endsWith(")")){const e=t.slice(1,-1).split("|").map((t=>t.trim()));if(o>=n.length)return false;if(!e.includes(n[o]))return false;o++}else if(t.includes("|")){const n=t.split("|").map((t=>t.trim()));for(const t of n){c.add(t)}}else{if(o>=n.length||n[o]!==t)return false;o++}}while(o<n.length){if(!c.has(n[o])){return false}c.delete(n[o]);o++}return o===n.length};function l(){var e;const o=document.getElementById("container");if(!o)return;const c=o["objective"];const s=JSON.parse((e=localStorage.getItem(n))!==null&&e!==void 0?e:"[]");const r=i(c,s);console.log("ðŸš€ ~ onActivityComplete ~ res:",r,c,s);if(r){localStorage.removeItem(n);localStorage.removeItem(t);setTimeout((()=>{u()}),1500)}}const u=()=>{const t=new CustomEvent("nextContainer");console.log("ðŸš€ ~ triggerNextContainer ~ event:",t);window.dispatchEvent(t)};const d=(t,n)=>{switch(n){case"drag":{c(t);break}case"click":{f(t);break}case"drop":{h(t);break}}};function f(t){t.style.cursor="pointer";if(!t){console.error("No element provided.");return}const e=()=>{console.log("Element clicked:",t);localStorage.setItem(n,JSON.stringify([t["value"]]));t.style.border="2px solid yellow";t.style.boxShadow="0px 0px 10px rgba(255, 255, 0, 0.7)";t.style.transition="transform 0.2s ease, border 0.5s ease";t.style.transform="scale(1.1)";setTimeout((()=>{t.style.transform="scale(1)";t.style.border="";t.style.boxShadow="";const n=document.getElementById("container");const e=n["objective"];if(i(e,[t["value"]])){const n=t.getAttribute("onTouch");r(n,t)}else{m([t])}}),500);l()};t.addEventListener("click",e)}function m(t){const n="wrong-answer-animation-style";if(!document.getElementById(n)){const t=document.createElement("style");t.id=n;t.innerHTML=`\n          @keyframes enhanced-shake {\n              0% { left: 0; }\n              10% { left: -8px; }\n              20% { left: 8px; }\n              30% { left: -8px; }\n              40% { left: 8px; }\n              50% { left: -6px; }\n              60% { left: 6px; }\n              70% { left: -4px; }\n              80% { left: 4px; }\n              90% { left: -2px; }\n              100% { left: 0; }\n          }\n          \n          .wrong-answer {\n              position: relative; /* Enable relative positioning to move the element */\n              animation: enhanced-shake 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97);\n              background-color: #ffdddd; /* Flash red background to indicate wrong answer */\n              box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); /* Subtle red shadow */\n          }\n      `;document.head.appendChild(t)}t.forEach((t=>{t.classList.add("wrong-answer");t.addEventListener("animationend",(()=>{t.classList.remove("wrong-answer")}),{once:true})}))}function h(t){t.onclick=()=>{g(t,"drop")}}function g(t,n){const e=document.querySelectorAll(`[type='${n}']`);e.forEach((t=>{p(t)}));if(!document.getElementById("dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style";t.innerHTML=`\n      .highlight {\n        border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        border-radius: 12px; /* Larger rounded corners */\n        background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    `;document.head.appendChild(t)}t===null||t===void 0?void 0:t.classList.add("highlight");t.ariaPressed="true";const c=n==="drop"?t:document.querySelector("[type='drop'].highlight");const r=n==="drag"?t:document.querySelector("[type='drag'].highlight");if(c&&r){r.style.transition="transform 0.5s ease";r.style.transform="";const t=document.getElementById("container");const n=o(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",n);const e=c.getBoundingClientRect();const a=r.getBoundingClientRect();const i=(e.left-a.left)/n;const l=(e.top-a.top)/n;r.style.transform=`translate(${i}px, ${l}px)`;setTimeout((()=>{s(r,c)}),500);const u=document.querySelectorAll(`*`);u.forEach((t=>{p(t)}));setTimeout((()=>{r.style.transform=""}),1e3)}}function p(t){t.classList.remove("highlight");t.ariaPressed="false"}export{t as D,n as S,e as f,d as i};
//# sourceMappingURL=p-be47b959.js.map