import{r as t,h as e,H as i,g as n,a as s}from"./p-160313d2.js";import{i as o,S as d,D as a,d as r,a as h,c,T as l,t as f}from"./p-097b6bd8.js";const u=".col{top:var(--y, 0);left:var(--x, 0);height:var(--height, 100%);width:var(--width, 100%);background-color:var(--bgColor, #eeeeee);padding:15px;border-radius:10px;display:flex;justify-content:space-around;flex-direction:column;align-items:center}.col>*{}";const p=u;const g=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,display:this.visible?"flex":"none",zIndex:this.z};return e(i,{key:"2df2c91ee5a105673f1bec5f143be3f398b0c63f",id:this.id,class:"col",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("slot",{key:"38358c41e323a67f97ab6e340c08e98c0c6dbf5a"}))}get el(){return n(this)}};g.style=p;const b=".container{position:relative;height:100%;width:100%;background-color:var(--bgColor, #ffffff);display:flex;flex-direction:column;justify-content:center;align-items:center}";const v=b;const x=class{constructor(e){t(this,e);this.id=undefined;this.objective=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined;this.canplay=true;this.showCheck=undefined;this.isContinueOnCorrect=undefined;this.baseUrl=""}scaleContainer(t){var e;const i=[window.innerWidth];if((e=window.screen)===null||e===void 0?void 0:e.width){i.push(window.screen.width)}const n=Math.min(...i);const s=document.documentElement.clientHeight;const o=n/1600;const d=s/900;const a=Math.min(o,d);t.style.transform=`translate(-50%, -50%) scale(${a})`}componentDidLoad(){this.scaleContainer(this.el);document.body.style.backgroundColor=this.bgColor;window.addEventListener("resize",(()=>this.scaleContainer(this.el)));window.addEventListener("load",(()=>this.scaleContainer(this.el)));o(this.el,this.type)}render(){const t={backgroundColor:this.bgColor,width:"1600px",height:"900px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"};console.log("ðŸš€ ~ AppContainer ~ canplay:",this.canplay);return e(i,{key:"e4748f56d1520a0418d3378c695f5968e9d7c53e",id:"container",tabindex:0,class:"container",objective:this.objective,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,onTouch:this.onTouch,onInCorrect:this.onInCorrect,onCorrect:this.onCorrect,onEntry:this.onEntry,showCheck:this.showCheck,isContinueOnCorrect:this.isContinueOnCorrect},e("slot",{key:"2ea749cec0f51f1ebcd0b810700de21eaf138a7d"}))}get el(){return n(this)}};x.style=v;const y="@import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap'); body{overflow:hidden}.disable-check-button{pointer-events:none;background-color:#9393935c !important;color:white}";const m=y;const w="@keyframes rightToPlace{from{transform:translateX(2000px)}to{left:0}}@keyframes placeToLeft{from{}to{transform:translateX(-2000px)}}@keyframes shake{0%{transform:translateX(0)}10%{transform:translateX(-5px)}20%{transform:translateX(5px)}30%{transform:translateX(-5px)}40%{transform:translateX(5px)}50%{transform:translateX(-5px)}60%{transform:translateX(5px)}70%{transform:translateX(-5px)}80%{transform:translateX(5px)}90%{transform:translateX(-5px)}100%{transform:translateX(0)}}@keyframes fallAndBounce{0%{transform:translateY(-1000px)}25%{transform:translateY(0px)}50%{transform:translateY(-200px)}75%{transform:translateY(0)}90%{transform:translateY(-100px)}100%{transform:translateY(0)}}@keyframes placeToDown{0%{transform:translateY(0)}100%{transform:translateY(1000px)}}";const k=w;const C=".snackbar{visibility:visible;min-width:250px;background-color:#333;color:#fff;text-align:center;border-radius:2px;padding:16px;position:fixed;z-index:1;bottom:30px;left:50%;transform:translateX(-50%);font-size:17px}.dot-container{text-align:center;position:fixed;z-index:1;width:fit-content;top:1%;left:50%;transform:translate(-50%)}.dot{height:15px;width:15px;margin:0 4px;background-color:#bbb;border-radius:50%;display:inline-block;transition:background-color 0.3s;cursor:pointer}.dot.completed{background-color:grey}.dot.current{background-color:green}.dot:not(.completed):not(.current){background-color:#bbb}";const I=C;const L=class{constructor(e){t(this,e);this.nextContainer=t=>{if(t!=undefined&&t==this.currentContainerIndex)return;localStorage.removeItem(d);localStorage.removeItem(a);if(t!=undefined&&t<this.containers.length){this.currentContainerIndex=t;r(this.currentContainerIndex)}else if(this.currentContainerIndex<this.containers.length-1){this.currentContainerIndex++;r(this.currentContainerIndex)}else if(this.currentContainerIndex>=this.containers.length-1){this.showCompletionMessage=true;h();this.currentContainerIndex=0;setTimeout((()=>{this.showCompletionMessage=false}),3e3)}this.containers=[...this.containers]};this.xmlData=undefined;this.initialIndex=0;this.canplay=true;this.baseUrl="";this.currentContainerIndex=this.initialIndex;this.showCompletionMessage=false;this.containers=[]}componentWillLoad(){window.addEventListener("nextContainer",(()=>{this.nextContainer()}));window.addEventListener("changeContainer",(t=>{this.nextContainer(t.detail.index)}));this.parseXMLData(this.xmlData);window.addEventListener("beforeunload",(()=>{localStorage.removeItem(d);localStorage.removeItem(a)}))}disconnectedCallback(){window.removeEventListener("nextContainer",(()=>{this.nextContainer()}));window.removeEventListener("changeContainer",(t=>{this.nextContainer(t.detail.index)}))}parseXMLData(t){if(t){const e=new DOMParser;const i=e.parseFromString(t,"text/xml");const n=i.documentElement;this.parseContainers(n)}}parseElement(t){const i=t.nodeName.toLowerCase();const n={};Array.from(t.attributes).forEach((t=>{n[t.name]=t.value}));const s=Array.from(t.childNodes).map((t=>{if(t.nodeType===1){return this.parseElement(t)}else if(t.nodeType===3&&t.textContent.trim()!==""){return t.textContent}return null})).filter(Boolean);const o={"app-container":e("app-container",Object.assign({},n,{canplay:this.canplay,baseUrl:this.baseUrl}),s),"app-col":e("app-col",Object.assign({},n),s),"app-trace":e("app-trace",Object.assign({},n),s),"app-image":e("app-image",Object.assign({},n),s),"app-row":e("app-row",Object.assign({},n),s),"app-text":e("app-text",Object.assign({},n),s),"app-pos":e("app-pos",Object.assign({},n),s),"app-shape":e("app-shape",Object.assign({},n),s),"app-wrap":e("app-wrap",Object.assign({},n),s),"app-random":e("app-random",Object.assign({},n),s)};if(o[i]){return o[i]}else{console.warn(`Unknown tag: ${i}`);return null}}parseContainers(t){const e=[];const i=t.querySelectorAll("app-container");i.forEach((t=>{const i=this.parseElement(t);if(i){e.push(i)}}));this.containers=e}renderDots(){return e("div",{id:"dot-indicator",class:"dot-container"},this.containers.map(((t,i)=>e("span",{class:`dot ${i<this.currentContainerIndex?"completed":i===this.currentContainerIndex?"current":""}`,onClick:()=>this.jumpToContainer(i)}))))}jumpToContainer(t){this.nextContainer(t)}render(){if(!this.xmlData){return e("div",null,"Please provide XML data.")}return e(i,{index:this.currentContainerIndex,totalIndex:this.containers.length},e("div",{key:this.currentContainerIndex},this.containers[this.currentContainerIndex]),this.renderDots(),this.showCompletionMessage&&e("div",{class:"snackbar"},"All containers have been displayed!"))}};L.style=m+(k+I);const j=".image{user-select:none;-webkit-user-drag:none;object-fit:contain;max-width:100%;max-height:100%;aspect-ratio:1 / 1;}";const T=j;const $=class{constructor(e){t(this,e);this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined;this.src=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,display:this.visible?"flex":"none",alignItems:"center",justifyContent:"center"};return e(i,{key:"25119f2df77a6c1ee7b8e7eaa1869d0ac800d3d7",type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,value:this.value,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("img",{key:"89cf01c70ee6b3e45e0911bd78553e127b1200d3",class:"image",src:c(this.src),alt:"",style:t}))}get el(){return n(this)}};$.style=T;const D=".pos{top:var(--y, 0);left:var(--x, 0);height:var(--height, 100%);width:var(--width, 100%);background-color:var(--bgColor, #eeeeee);display:flex;justify-content:space-around;flex-direction:column;position:fixed}.pos>*{position:absolute}";const P=D;const X=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,display:this.visible?"block":"none"};return e(i,{key:"0f3ebae7ead7f31a05e58cadd376c2dd013e3e13",id:this.id,class:"pos",type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,value:this.value,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("slot",{key:"3ff077355fe6484ab8773be3ca2b2764c1338287"}))}get el(){return n(this)}};X.style=P;const z=".random{display:flex;justify-content:space-between;align-items:center;position:absolute;}.random>*{position:absolute}";const M=z;const E=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){const t=this.el.querySelectorAll(".random > *");t.forEach((t=>{const e=Math.random()*100;const i=Math.random()*100;t.style.top=`${e}%`;t.style.left=`${i}%`}))}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"block":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(i,{key:"2965ae9147b075145b6ebe45654ff031a5bb0bca",class:"random",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("slot",{key:"baaa70ebd6ec62df14b15cbc071847cc88154f7e"}))}get el(){return n(this)}};E.style=M;const W=class{constructor(e){t(this,e);this.xmlPath=undefined;this.initialIndex=0;this.canplay=true;this.baseUrl="";this.xmlData=undefined}async componentWillLoad(){var t;const e=(t=this.xmlPath)!==null&&t!==void 0?t:this.baseUrl+"/index.xml";console.log("ðŸš€ ~ AppRoot ~ componentWillLoad ~ this.baseUrl:",this.baseUrl);console.log("ðŸš€ ~ AppRoot ~ componentWillLoad ~ this.xmlPath:",this.xmlPath);console.log("ðŸš€ ~ AppRoot ~ componentWillLoad ~ xmlPath:",e);try{const t=e.startsWith("http")?e:s(e);const i=await fetch(t);if(!i.ok){throw new Error(`Failed to fetch XML data: ${i.statusText}`)}const n=await i.text();this.xmlData=n}catch(t){console.error("Error fetching XML data:",t);this.xmlData=null}}render(){if(this.xmlData===undefined){return e("div",null,"Loading...")}if(this.xmlData===null){return e("div",null,"Error loading XML data. Please check the path or URL.")}return e("app-home",{initialIndex:this.initialIndex,canplay:this.canplay,xmlData:this.xmlData,baseUrl:this.baseUrl})}static get assetsDirs(){return["assets"]}};const S=".row{display:flex;justify-content:space-between;align-items:center;}.row>*{}";const O=S;const A=class{constructor(e){t(this,e);this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"flex":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(i,{key:"cdbbc10edf317023481ada15fbadcce6cdb5e19b",class:"row",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("slot",{key:"cbcd99fbb87ec9f13dd20e531bcfc9ca529cf316"}))}get el(){return n(this)}};A.style=O;const B=".shape{position:absolute;top:var(--y);left:var(--x);display:var(--display);z-index:var(--z)}.rectangle{border-radius:0}.circle{width:var(--width);height:var(--width);border-radius:50%;background-color:var(--bgColor)}.ellipse{width:var(--width);height:var(--height);border-radius:50%;background-color:var(--bgColor)}.triangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--bgColor);clip-path:polygon(50% 0%, 100% 100%, 0% 100%)}.rightTriangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--bgColor);clip-path:polygon(100% 0%, 100% 100%, 0% 100%)}.leftTriangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--triangleBgColor);clip-path:polygon(0% 0%, 100% 100%, 0% 100%)}.parallelogram{width:var(--paralleWidth);height:var(--paralleHeight);transform:skew(20deg)}.star{width:var(--starWidth);height:var(--starHeight);background-color:var(--starBgColor);clip-path:polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)}.pentagon{width:var(--pentagonWidth);height:var(--pentagonHeight);background-color:var(--pentagonBgColor);clip-path:polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%)}.heptagon{width:var(--heptagonWidth);height:var(--heptagonHeight);background-color:var(--heptagonBgColor);clip-path:polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)}.octagon{width:var(--octagonWidth);height:var(--octagonHeight);background-color:var(--octagonBgColor);clip-path:polygon(25% 0%, 75% 0%, 100% 25%, 100% 75%, 75% 100%, 25% 100%, 0% 75%, 0% 25%)}.rhombus{width:var(--rhombusWidth);height:var(--rhombusHeight);background-color:var(--rhombusBgColor);clip-path:polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)}.heart{height:var(--heartHeight);width:var(--heartWidth);border-image:radial-gradient(var(--heartBgColor) 69%, #0000 70%) 84.5%/50%;clip-path:polygon(-41% 0, 50% 91%, 141% 0)}";const F=B;const _=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.shapeType=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.shapeType!=="polygon"?this.height:undefined,width:this.shapeType!=="polygon"?this.width:undefined,top:this.y,left:this.x,display:this.visible?"block":"none",zIndex:this.z,backgroundColor:this.shapeType!=="polygon"?this.bgColor:"transparent"};return e(i,{key:"2aec9bf25812686f8bfdd77798ee60b741631378",class:`shape ${this.shapeType}`,value:this.value,type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry})}get el(){return n(this)}};_.style=F;const H=".text{background-color:#fff;box-shadow:0 2px 4px rgba(0, 0, 0, 0.1);transition:background-color 0.3s ease;user-select:none;align-items:center;justify-content:center;text-align:center;border-radius:8px;color:#333;cursor:pointer}.text:hover{background-color:#f0f0f0}";const Y=H;const G=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.string=undefined;this.font=undefined;this.fontSize=undefined;this.fontColor=undefined;this.highlightWhileSpeaking=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,fontSize:this.fontSize,fontFamily:this.font,color:this.fontColor,display:this.visible?"flex":"none"};return e(i,{key:"4c5ae92a6475c188b0ac0e767494b04d6d181730",class:"text",value:this.value,type:this.type,tabindex:this.tabIndex,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry,id:this.id,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden},this.string)}get el(){return n(this)}};G.style=Y;const V=":host{display:block;position:relative}#svgContainer{position:absolute;top:0;left:0;right:0;bottom:50px;display:flex;justify-content:center;align-items:center;overflow:hidden}svg{width:100%;height:100%;max-height:calc(100vh - 50px);touch-action:none}#draggableCircle{cursor:pointer;fill:red;transition:fill 0.2s, r 0.2s}.blindTracing{stroke:none !important}.blindFreeTrace{stroke:none !important}.hovered{cursor:grab;fill:darkred}#controls{position:fixed;bottom:0;left:0;right:0;display:flex;justify-content:space-between;padding:10px;background-color:#f0f0f0;border-top:1px solid #ccc}button{padding:10px;font-size:16px}@media (max-width: 600px){button{padding:8px;font-size:14px}}.trace-path-green{stroke:green !important}";const U=V;const R=class{constructor(e){t(this,e);this.id=undefined;this.svgSource=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.tabIndex=undefined;this.mode=undefined;this.fileIndex=-1;this.isDragging=false;this.activePointerId=null}async initializeSVG(){let t={fileIndex:-1,currentPathIndex:0,lastLength:0,totalPathLength:0,isDragging:false,circle:null,paths:[],svg:null,proximityThreshold:100,freeTraceProximityThreshold:50,rafId:null,pointerMoveEvent:null,activePointerId:null,mode:this.mode,flowMarkers:[],freeTraceLines:[]};await this.loadAnotherSVG(t,true)}componentWillLoad(){this.initializeSVG()}async fetchSVG(t){const e=await fetch(t);if(!e.ok){throw new Error(`Failed to fetch SVG (${t}): ${e.statusText}`)}return await e.text()}calculateBoundingBox(t,e=22){let i=Infinity,n=Infinity,s=-Infinity,o=-Infinity;t.forEach((t=>{const e=t.getTotalLength();const d=100;for(let a=0;a<=d;a++){const r=t.getPointAtLength(a/d*e);if(r.x<i)i=r.x;if(r.y<n)n=r.y;if(r.x>s)s=r.x;if(r.y>o)o=r.y}}));i-=e;n-=e;s+=e;o+=e;return{minX:i,minY:n,maxX:s,maxY:o}}insertSVG(t){const e=document.getElementById("svgContainer");e.innerHTML=t;const i=e.querySelector("svg");i.removeAttribute("width");i.removeAttribute("height");const n=i.querySelectorAll("path, line");const s=this.calculateBoundingBox(Array.from(n));const o=s.maxX-s.minX;const d=s.maxY-s.minY;i.setAttribute("viewBox",`${s.minX} ${s.minY} ${o} ${d}`)}getSVGElement(){const t=document.getElementById("svgContainer");return t.querySelector("svg")}getPaths(t){return Array.from(t.querySelectorAll("path, line"))}createFlowMarkersForPath(t,e=10){var i;const n=t.getTotalLength();const s=n/(e+1);const o=[];for(let n=1;n<=e;n++){const e=t.getPointAtLength(n*s);const d=t.getPointAtLength((n+.5)*s);const a=Math.atan2(d.y-e.y,d.x-e.x);const r=document.createElementNS("http://www.w3.org/2000/svg","polygon");r.setAttribute("points","-5,-5 0,0 -5,5");r.setAttribute("fill","blue");r.setAttribute("transform",`translate(${e.x},${e.y}) rotate(${a*180/Math.PI})`);r.setAttribute("class","flow-indicator");o.push(r);(i=t.parentNode)===null||i===void 0?void 0:i.appendChild(r)}return o}updateFlowIndicators(t){const e=t.svg.querySelectorAll(".flow-indicator");e.forEach((e=>{if(t.mode===l.NoFlow){e.style.display="none"}else if(t.mode===l.ShowFlow){e.style.display="block"}}))}setupDrawingPath(t){t.paths.forEach(((e,i)=>{const n=e.getTotalLength();const s=e.cloneNode();s.setAttribute("stroke","green");s.setAttribute("stroke-width","13");s.setAttribute("stroke-dasharray",n.toString());s.setAttribute("stroke-dashoffset",n.toString());e.parentNode.appendChild(s,e);e.setAttribute("class","trace-path");s.setAttribute("class","trace-path-green");e.greenPath=s;e.classList.add(t.mode);if(t.mode===l.BlindTracing||t.mode===l.BlindFreeTrace){e.setAttribute("stroke","none")}else{e.setAttribute("stroke","#000");e.setAttribute("stroke-width","10");e.setAttribute("fill","none");e.setAttribute("stroke-dasharray",n.toString());e.setAttribute("stroke-dashoffset","0")}if(i===t.currentPathIndex&&t.mode===l.ShowFlow){t.flowMarkers=this.createFlowMarkersForPath(e)}}));t.totalPathLength=t.paths[t.currentPathIndex].getTotalLength()}setupDraggableCircle(t){var e;const i=t.paths[0].getPointAtLength(0);const n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttribute("id","draggableCircle");n.setAttribute("cx",i.x.toString());n.setAttribute("cy",i.y.toString());n.setAttribute("r","20");n.setAttribute("fill","red");(e=t.svg)===null||e===void 0?void 0:e.appendChild(n);t.circle=n}addEventListeners(t){var e,i,n,s;if(!t.circle||!t.paths||t.paths.length===0)return;t.circle.addEventListener("pointerdown",(e=>{e.preventDefault();const i=this.getPointerPosition(e,t.svg);const n={x:parseFloat(t.circle.getAttribute("cx")),y:parseFloat(t.circle.getAttribute("cy"))};const s=this.getDistanceSquared(i,n);if(s<=t.proximityThreshold*t.proximityThreshold){t.isDragging=true;t.activePointerId=e.pointerId;t.circle.setPointerCapture(e.pointerId)}}));(e=t.svg)===null||e===void 0?void 0:e.addEventListener("pointermove",(e=>{if(!t.isDragging||e.pointerId!==t.activePointerId)return;t.pointerMoveEvent=e;if(!t.rafId){t.rafId=requestAnimationFrame((()=>{this.handlePointerMove(t);t.rafId=null}))}}));(i=t.svg)===null||i===void 0?void 0:i.addEventListener("pointerup",(e=>{if(e.pointerId===t.activePointerId){t.isDragging=false;t.activePointerId=null}}));(n=t.svg)===null||n===void 0?void 0:n.addEventListener("pointercancel",(e=>{if(e.pointerId===t.activePointerId){t.isDragging=false;t.activePointerId=null}}));(s=t.svg)===null||s===void 0?void 0:s.addEventListener("contextmenu",(t=>{t.preventDefault()}))}handlePointerMove(t){var e,i,n,s;if(!t.isDragging)return;if(!t.circle||!t.paths||t.paths.length===0)return;const o=t.pointerMoveEvent;const d=this.getPointerPosition(o,t.svg);const a={x:parseFloat(t.circle.getAttribute("cx")),y:parseFloat(t.circle.getAttribute("cy"))};const r=t.paths[t.currentPathIndex];if(!r){console.error("No valid path found at the current index");return}let h;if(t.mode===l.FreeTrace||t.mode===l.BlindFreeTrace){h=t.freeTraceProximityThreshold*t.freeTraceProximityThreshold}else{h=t.proximityThreshold*t.proximityThreshold}const c=this.getDistanceSquared(d,a);if(c>h){return}const u=this.getClosestPointOnPath(r,d);const p=this.getDistanceSquared(d,u);if(p>h){return}if(t.mode===l.FreeTrace||t.mode===l.BlindFreeTrace){if(!t.currentFreePath){t.currentFreePath=[]}if(!t.currentFreePath[t.currentPathIndex]){const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("stroke","green");i.setAttribute("stroke-width","8");i.setAttribute("fill","none");i.setAttribute("d",`M${d.x},${d.y}`);(e=t.svg)===null||e===void 0?void 0:e.appendChild(i);t.currentFreePath[t.currentPathIndex]=i;t.lastPointerPos=d}const n=t.lastPointerPos||d;const s=t.currentFreePath[t.currentPathIndex].getAttribute("d");const o=(n.x+d.x)/2;const a=(n.y+d.y)/2;const h=`${s} Q ${n.x},${n.y} ${o},${a}`;t.currentFreePath[t.currentPathIndex].setAttribute("d",h);t.circle.setAttribute("cx",d.x.toString());t.circle.setAttribute("cy",d.y.toString());(i=t.svg)===null||i===void 0?void 0:i.appendChild(t.circle);t.lastPointerPos=d;const c=r.getTotalLength();const l=c-u.length;if(l<5){this.moveToNextPath(t);t.currentFreePath[t.currentPathIndex]=null}return}if(t.isDragging&&u.length>=t.lastLength){t.lastLength=u.length;t.circle.setAttribute("cx",u.x.toString());t.circle.setAttribute("cy",u.y.toString());(n=t.svg)===null||n===void 0?void 0:n.appendChild(t.circle);(s=r.greenPath)===null||s===void 0?void 0:s.setAttribute("stroke-dashoffset",(t.totalPathLength-t.lastLength).toString())}if(t.totalPathLength-1-t.lastLength<5&&t.currentPathIndex<t.paths.length-1){this.moveToNextPath(t)}else if(t.totalPathLength-1-t.lastLength<5&&t.currentPathIndex===t.paths.length-1){f()}}getPointerPosition(t,e){var i;const n=e.createSVGPoint();n.x=t.clientX;n.y=t.clientY;const s=(i=e.getScreenCTM())===null||i===void 0?void 0:i.inverse();return s?n.matrixTransform(s):{x:t.clientX,y:t.clientY}}getDistanceSquared(t,e){const i=t.x-e.x;const n=t.y-e.y;return i*i+n*n}getClosestPointOnPath(t,e){const i=t.getTotalLength();let n={x:0,y:0,length:0};let s=Infinity;const o=20;let d={x:0,y:0,length:0};let a=Infinity;for(let n=0;n<=i;n+=o){const i=t.getPointAtLength(n);const s=this.getDistanceSquared(e,i);if(s<a){a=s;d={x:i.x,y:i.y,length:n}}}const r=2;const h=Math.max(d.length-o,0);const c=Math.min(d.length+o,i);for(let i=h;i<=c;i+=r){const o=t.getPointAtLength(i);const d=this.getDistanceSquared(e,o);if(d<s){s=d;n={x:o.x,y:o.y,length:i}}}return n}async loadAnotherSVG(t,e){t.isDragging=false;try{if(t.svg){this.cleanupPreviousSVG(t)}const e=await this.fetchSVG(this.svgSource);this.insertSVG(e);t.svg=this.getSVGElement();t.paths=this.getPaths(t.svg);this.setupDrawingPath(t);this.setupDraggableCircle(t);this.addEventListeners(t)}catch(t){console.error(`Error loading SVG (${this.svgSource}):`,t)}}cleanupPreviousSVG(t){var e,i;if(t.circle){(e=t.svg)===null||e===void 0?void 0:e.removeChild(t.circle);t.circle=null}const n=(i=t.svg)===null||i===void 0?void 0:i.querySelectorAll(".flow-indicator");n.forEach((t=>{t.remove()}));t.currentPathIndex=0;t.lastLength=0;t.totalPathLength=t.paths[0].getTotalLength()}moveToNextPath(t){var e,i;t.isDragging=false;t.currentPathIndex++;t.lastLength=0;if(t.currentPathIndex>=t.paths.length){f();return}const n=t.paths[t.currentPathIndex];if(!n){console.error("No valid path found at the next index");return}t.totalPathLength=n.getTotalLength();const s=n.getPointAtLength(0);(e=t.circle)===null||e===void 0?void 0:e.setAttribute("cx",s.x.toString());(i=t.circle)===null||i===void 0?void 0:i.setAttribute("cy",s.y.toString());if(t.mode===l.ShowFlow){t.flowMarkers=this.createFlowMarkersForPath(n)}}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,zIndex:this.z,position:"absolute"};return e(i,{key:"c957926b2f3e281966de8d1dca6580931af54019",class:"trace",id:this.id,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,tabindex:this.tabIndex},e("div",{key:"f841bf92fec27ed26594c5ccca937fa20210451f",id:"svgContainer"}))}static get assetsDirs(){return["svg"]}};R.style=U;const N=".wrap{display:grid;grid-gap:10px;grid-template-columns:repeat(auto-fill, minmax(186px, auto))}.wrap>*{padding:10px;background-color:var(--child-bg-color, #f0f0f0);box-sizing:border-box}";const q=N;const Q=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onInCorrect=undefined;this.onCorrect=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"grid":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(i,{key:"4666063d0e586e2a1f1c44435ebcd528a833c60c",class:"wrap",value:this.value,type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onCorrect:this.onCorrect,onInCorrect:this.onInCorrect,onEntry:this.onEntry},e("slot",{key:"4886f7cb73320a90593ce855dceba63a75e6d01a"}))}get el(){return n(this)}};Q.style=q;export{g as app_col,x as app_container,L as app_home,$ as app_image,X as app_pos,E as app_random,W as app_root,A as app_row,_ as app_shape,G as app_text,R as app_trace,Q as app_wrap};
//# sourceMappingURL=p-9686ddc5.entry.js.map