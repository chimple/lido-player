import{g as t}from"./p-ddf627b0.js";const e="lidoDragSelectedMap",o="lidoDragMap",n="lidoSelectedValues",a="lidoActivityScore",r="lidoNextContainer",i="lidoElementDrop",c="dropLength",l="dropHasDrag",s="drop-to",d="drop-time";var u,m;function p(t,e){const o=new CustomEvent(t,{detail:e});window.dispatchEvent(o)}function f(){p("lidoGameCompleted",{})}function h(t){p("lidoActivityChange",{index:t})}function g(t,e){p("lidoElementClick",{element:t,isCorrect:e,createdAt:(new Date).toISOString()})}!function(t){t.NoFlow="noFlow",t.ShowFlow="showFlow",t.FreeTrace="freeTrace",t.BlindTracing="blindTracing",t.BlindFreeTrace="blindFreeTrace"}(u||(u={})),function(t){t.Diagonal="diagonal",t.Stretch="stretch",t.InfiniteDrop="infinite-drop"}(m||(m={}));class v{constructor(){}static getInstance(){return v.instance||(v.instance=new v),v.instance}setRiveInstance(t){this.riveInstance=t}getRiveInstance(){return this.riveInstance}}function b(t){t.classList.remove("highlight"),t.ariaPressed="false"}function S(t){if(!t)return;t.classList.add("speaking-highlight");const e="#speaking-highlight-style";if(!document.querySelector(e)){const o=document.createElement("style");o.id=e,o.innerHTML=`\n      .speaking-highlight {\n        --base-transform: ${t.style.transform};\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9) !important; /* Stronger orange glow effect */\n        // border: 3px solid green !important;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: var(--base-transform) scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n      }\n    `,document.head.appendChild(o)}}function w(t){t&&t.classList.remove("speaking-highlight")}class x{constructor(){this.audioElement=document.createElement("audio"),this.audioElement.id="audio",document.body.appendChild(this.audioElement)}static getI(){return x.instance||(x.instance=new x),x.instance}stop(){(null===window||void 0===window?void 0:window.speechSynthesis)&&window.speechSynthesis.cancel(),this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement.src="",document.querySelectorAll(".speaking-highlight").forEach((t=>w(t)));const t=document.querySelector("#play"),e=document.querySelector("#pause");t&&e&&(t.style.visibility="visible",e.style.visibility="hidden")}async play(t){let e=t.getAttribute("audio")||"";if(!e){const o=t.children;for(let t=0;t<o.length;t++){const n=o[t].getAttribute("audio");n&&(e=n)}}if(e){e=q(e),this.audioElement.src=e,console.log("ðŸš€ Playing audio:",this.audioElement.src);try{await this.audioElement.play(),S(t),await new Promise((e=>{this.audioElement.onended=()=>{w(t),e()}}))}catch(t){console.log("ðŸš€ Audio play error:",t)}}else if(t.textContent)try{S(t),await async function(t){return new Promise(((e,o)=>{if(!("speechSynthesis"in window))return void o(new Error("Speech synthesis is not supported in this browser."));const n=window.speechSynthesis;setTimeout((()=>{const o=new SpeechSynthesisUtterance(t);o.onend=()=>{e(!0)},n.speak(o)}),50)}))}(t.textContent),w(t)}catch(t){console.log("ðŸš€ TTS Error:",t)}}}let y;function O(t){const e=window.getComputedStyle(t).transform;if(e&&"none"!==e){const t=e.match(/matrix\(([^)]+)\)/);if(t)return t[1].split(",").map((t=>parseFloat(t.trim())))[0]}return 1}const N=t=>{const e=document.createElement("div");if("option"===t.getAttribute("type"))return e.style.width=t.style.width,e.style.height=t.style.height,e;const o=t.style.width,n=t.style.padding;return t.style.width="auto",t.style.padding="0 20px",e.style.width=`${t.offsetWidth+20}px`,e.style.height=`${t.offsetHeight+20}px`,e.style.border="1px solid",e.style.backgroundColor="#00000021",e.style.borderRadius="10px",t.style.width=o,t.style.padding=n,e.setAttribute("value",`${t.getAttribute("value")}`),e};const k=t=>{t.style.opacity="",t.style.cursor="move",t.style.zIndex="",t.style.transform="",t.style.position="",t.style.left="",t.style.top=""};function J(t,e){const o=Array.from(document.querySelectorAll(`[type="${e}"]`));let n=0,a=null;const r=t.getBoundingClientRect();for(const e of o){if(e===t)continue;const o=M(r,e.getBoundingClientRect());o>n&&(n=o,a=e)}return a}function $(t){return t instanceof MouseEvent?{clientX:t.clientX,clientY:t.clientY}:{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}}function M(t,e){return Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top))}const A=(t,e)=>{const o=document.querySelector("#lido-container"),a=o.getAttribute("objective").split(",");let r=JSON.parse(localStorage.getItem(n))||[];r=Array.from(t.children).map((t=>t.getAttribute("value"))),localStorage.setItem(n,JSON.stringify(r));const i=r.indexOf(e.value);if(i>=0){const t=L(e.value,[a[i].trim()]);!t&&o.isAllowOnlyCorrect&&Array.from(o.querySelectorAll(`[value="${e.value}"]`)).find((t=>t!==e)).replaceWith(e),U(t),Y()}};async function C(t,o){let n=JSON.parse(localStorage.getItem(e))||{},a=n[o.tabIndex];if(!Array.isArray(a)||!a.includes(t.value)){for(const e in n){const o=n[e].indexOf(t.value);-1!==o&&n[e].splice(o,1)}localStorage.setItem(e,JSON.stringify(n)),await X(t,o)}}const E=t=>{t.style.animation="unset";const e=window.getComputedStyle(t).transform;if("none"===e)return 1;{const t=e.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");return parseFloat(e[0])}}return 1},I=(t,e)=>{const o=t.getBoundingClientRect(),n=document.querySelectorAll(`[type="${e}"]`);let a=null,r=0;return n.forEach((n=>{if(n===t)return;const i=n.getBoundingClientRect(),c=Math.max(0,Math.min(o.right,i.right)-Math.max(o.left,i.left))*Math.max(0,Math.min(o.bottom,i.bottom)-Math.max(o.top,i.top));0!==c&&("slide"===e?c>=.8*Math.min(o.width*o.height,i.width*i.height)&&c>r&&(r=c,a=n):c>r&&(r=c,a=n))})),a};async function j(t,a){var r;const u=localStorage.getItem(n)||"",f=localStorage.getItem(e),h=localStorage.getItem(o);let g=JSON.parse(localStorage.getItem(l)||" {}");if(t&&(a?t.setAttribute(s,null==a?void 0:a.id):t.removeAttribute(s),t.setAttribute(d,(new Date).getTime().toString())),a&&(null===(r=a.getAttribute("dropAttr"))||void 0===r?void 0:r.toLowerCase())!==m.Diagonal&&("true"===a.getAttribute("isAllowOnlyOneDrop")||!a.getAttribute("isAllowOnlyOneDrop"))){const o=Object.values(g).find((t=>document.getElementById(t.drop)===a));if(o?o.isFull=!0:console.warn("No matching drop item found for",a),localStorage.setItem(l,JSON.stringify(g)),I(t,"drag")){if(t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease",f){let o=JSON.parse(f);for(const e in o)o[e].includes(t.value)&&delete o[e];localStorage.setItem(e,JSON.stringify(o))}return void document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==m.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))}))}}if(!a){t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease";let a=D.get(t);if(a){let e=Object.values(g).find((t=>document.getElementById(t.drop)===a));e&&(e.isFull=!1,localStorage.setItem(l,JSON.stringify(g))),D.delete(t)}if(u){let e=JSON.parse(u);e=e.filter((e=>e!=t.value)),localStorage.setItem(n,JSON.stringify(e))}if(f){let n=JSON.parse(f),a=JSON.parse(h);for(const e in n)if(n[e].includes(t.value))for(const e in a)a[e].includes(t.id)&&(delete a[e],delete n[e]);localStorage.setItem(e,JSON.stringify(n)),localStorage.setItem(o,JSON.stringify(a))}return document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==m.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),void Y()}if(f){let e=D.get(t);if(e){let t=Object.values(g).find((t=>document.getElementById(t.drop)===e));t&&(t.isFull=!1,localStorage.setItem(l,JSON.stringify(g)))}}let v=JSON.parse(localStorage.getItem(c))||0;if(v+=1,localStorage.setItem(c,JSON.stringify(v)),v===G(a.value)){const t=Object.values(g).find((t=>document.getElementById(t.drop)===a));t?t.isFull=!0:console.warn("No matching drop item found for",a),localStorage.setItem(l,JSON.stringify(g)),v=0,localStorage.setItem(c,JSON.stringify(v))}D.set(t,a);const b=a.value.includes(t.value);if(function(t,e,o){p(i,{dragElement:t,dropElement:e,isCorrect:o,createdAt:(new Date).toISOString()})}(t,a,b),b){const e=a.getAttribute("onCorrect");e&&await R(e,a,t)}else{const e=a.getAttribute("onInCorrect");await R(e,a,t)}U(b),t.style.opacity="1",await X(t,a)}async function T(t,e){if(document.querySelectorAll(`[type='${e}']`).forEach((t=>{b(t)})),!document.querySelector("#dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style",t.innerHTML="\n      .highlight {\n        // border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        // border-radius: 12px; /* Larger rounded corners */\n        // background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        // box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        // outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    ",document.head.appendChild(t)}null==t||t.classList.add("highlight"),t.ariaPressed="true";const o="drop"===e?t:document.querySelector("[type='drop'].highlight"),n="drag"===e?t:document.querySelector("[type='drag'].highlight");if(o||async function(t){const e=JSON.parse(localStorage.getItem(l)||"{}"),o=t;if(!o)return void console.error("Element not found");const n=getComputedStyle(o).transform;if(b(t),n&&"none"!==n&&"matrix(1, 0, 0, 1, 0, 0)"!==n)return o.style.transition="transform 0.5s ease",o.style.transform="translate(0px, 0px)",void j(o,null);let a=Object.values(e).find((t=>!t.isFull));if(a){const t=document.querySelector(`#${a.drop}`);o.style.transition="transform 0.5s ease",j(o,t)}}(t),o&&n){n.style.transition="transform 0.5s ease",n.style.transform="";const t=document.querySelector("#lido-container"),e=E(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",e);const a=o.getBoundingClientRect(),r=n.getBoundingClientRect();n.style.transform=`translate(${(a.left-r.left)/e}px, ${(a.top-r.top)/e}px)`,document.querySelectorAll("*").forEach((t=>{b(t)})),await j(n,o)}}const D=new Map,F=new class{constructor(){this.rightMoves=0,this.wrongMoves=0,this.finalScore=0}};function W(t,e,o){return(t||"")+(e?` ${e}`:"")+(o?` ${o}`:"")}const P=async(t,o)=>{const a=document.querySelector("#lido-container");if(!a)return;const r=t.getAttribute("onEntry");await R(r,t);const i=a.getAttribute("canplay");if(null==i||"false"!==i){switch(o){case"drag":!function(t){let o=!1,n=!1,a=0,r=0,i=0,c=0,l=null,s=null;const d=document.querySelector("#lido-container");if(!d)return void console.error('Container with ID "container" not found.');let u,p;Q(t,"drag");const f=e=>{var d,u;if(x.getI().stop(),b(t),o=!0,n=!0,e instanceof MouseEvent?(a=e.clientX,r=e.clientY):(a=e.touches[0].clientX,r=e.touches[0].clientY),t.style.opacity="1",t.style.cursor="grabbing",(null===(d=t.getAttribute("dropAttr"))||void 0===d?void 0:d.toLowerCase())===m.Diagonal){const e=window.getComputedStyle(t),o=t.getBoundingClientRect();l||(l=t.cloneNode(!0),l.style.left=`${o.left}px`,l.style.top=`${o.top}px`,l.style.width=`${o.width}px`,l.style.height=`${o.height}px`,l.style.transform=e.transform,l.style.zIndex="0",l.setAttribute("visible","true"),l.classList.add("cloned-element"),document.body.appendChild(l))}if((null===(u=t.getAttribute("dropAttr"))||void 0===u?void 0:u.toLowerCase())===m.InfiniteDrop){const e=t.querySelector("img"),o=null==e?void 0:e.getAttribute("src"),n=window.getComputedStyle(t),a=t.getBoundingClientRect();if(s||(s=t.cloneNode(!1),s.setAttribute("src",o),s.setAttribute("value",t.getAttribute("value")),s.setAttribute("visible","true"),s.style.left=`${a.left}px`,s.style.top=`${a.top}px`,s.style.width=`${a.width}px`,s.style.height=`${a.height}px`,s.style.transform=n.transform,s.style.position="absolute",s.style.zIndex="0",t.style.zIndex="100",document.body.appendChild(s)),t.getAttribute("droppedelement")){const e=t.getAttribute("droppedelement");document.querySelectorAll(`body > [droppedelement="${e}"]`).forEach((t=>t.remove()))}}const p=window.getComputedStyle(t).transform;if("none"!==p){const t=p.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");i=parseFloat(e[4]),c=parseFloat(e[5])}}else i=0,c=0;document.addEventListener("mousemove",S),document.addEventListener("mouseup",y),document.addEventListener("touchmove",S),document.addEventListener("touchend",y)},h=d.getBoundingClientRect(),g=t.getBoundingClientRect();u=h.top-g.top,p=h.left-g.left;const v=new MutationObserver((e=>{for(const o of e)if("attributes"===o.type&&"style"===o.attributeName){const e=d.getBoundingClientRect(),o=t.getBoundingClientRect();u=e.top-o.top,p=e.left-o.left}}));v.observe(d,{attributes:!0,attributeFilter:["style"]});const S=l=>{if(!o)return;n=!1,t.style.transition="none";const s=E(d);let f=0,h=0;l instanceof MouseEvent?(f=(l.clientX-a)/s,h=(l.clientY-r)/s):(f=(l.touches[0].clientX-a)/s,h=(l.touches[0].clientY-r)/s);const g=i+f,v=c+h,b=d.getBoundingClientRect(),S=t.getBoundingClientRect(),w=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),x=S.left/s-w[0],y=S.top-w[1],O=b.width/s-Math.abs(p/s)-S.width/s,N=b.left-x,k=b.top-y,J=b.height/s-Math.abs(u/s)-S.height/s,$=g+x<=b.left?N:Math.min(g,O),M=v+y<=b.top?k:Math.min(v,J);t.style.transform=`translate(${$}px, ${M}px)`;let A=I(t,"drop");document.querySelectorAll("[type='drop']").forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==m.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))})),A&&("lido-text"===A.tagName.toLowerCase()?(A.style.border="2px dashed #ff0000",A.style.backgroundColor="rgba(255, 0, 0, 0.1)"):A.style.opacity="0.3")};let w=null;const y=()=>{var a,r,i;if(o=!1,n)return l&&(l.remove(),l=null),void(t.style.opacity="1");document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",S),document.removeEventListener("touchend",y),t.style.opacity="",t.style.cursor="move";const c=document.querySelectorAll("[type='drop']");c.forEach((()=>{c.forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==m.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))}))}));let s=I(t,"drop");if(j(t,s),(null===(a=t.getAttribute("dropAttr"))||void 0===a?void 0:a.toLowerCase())===m.Diagonal&&(s?t&&(t.classList.add("diagonal-drop"),s.classList.add("diagonal-target"),w=s):(w&&(w.classList.remove("diagonal-target"),w=null),null==t||t.classList.remove("diagonal-drop"),t.style.transform="translate(0, 0)",l&&(l.remove(),l=null))),(null===(r=t.getAttribute("dropAttr"))||void 0===r?void 0:r.toLowerCase())===m.Stretch){const e=window.getComputedStyle(t);s.style.width=e.width}(null===(i=t.getAttribute("dropAttr"))||void 0===i?void 0:i.toLowerCase())===m.InfiniteDrop&&(s.style.opacity="0",t.getAttribute("value")&&t.setAttribute("droppedElement",`${t.getAttribute("value")}-dropped`))};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",f),t.addEventListener("touchstart",f),t.addEventListener("click",(()=>{n&&T(t,"drag")}))}(t);break;case"click":!function(t){Q(t,"click"),t.style.cursor="pointer",t?(t.addEventListener("click",(async()=>{x.getI().stop();const o=document.querySelector("#lido-container"),a=o.objective.split(","),r=document.querySelector("#lido-checkButton"),i="true"===o.getAttribute("showCheck");if("lido-checkButton"==t.getAttribute("id"))return r.classList.add("lido-disable-check-button"),void await H();const c=t.classList.contains("lido-element-selected");let l=JSON.parse(localStorage.getItem(n))||[];if(1===a.length){localStorage.setItem(n,JSON.stringify([t.value]));const e=a.includes(t.value);if(g(t,e),e){const e=t.getAttribute("onCorrect");t.style.pointerEvents="none",await R(e,t)}else{const e=t.getAttribute("onInCorrect");await R(e,t)}return U(e),void Y()}if(i&&r.classList.remove("lido-disable-check-button"),c){t.classList.remove("lido-element-selected"),R(t.getAttribute("onEntry"),t),l=l.filter((e=>e!=t.value)),localStorage.setItem(n,JSON.stringify(l));let o=JSON.parse(localStorage.getItem(e))||{};const a=t.value,c=Object.keys(o).find((t=>o[t].includes(a)));if(c){o[c]=o[c].filter((t=>t!==a)),0===o[c].length&&delete o[c],localStorage.setItem(e,JSON.stringify(o));const t=Object.keys(o).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(o[e])),[]);localStorage.setItem(n,JSON.stringify(t))}i&&0===l.length&&r.classList.add("lido-disable-check-button")}else{{t.classList.add("lido-element-selected");const o=t.value,r=Object.keys(a).find((t=>a[t]===o));let i=JSON.parse(localStorage.getItem(e))||{};r?i[r]=[o]:i[a.length+l.length]=[o],localStorage.setItem(e,JSON.stringify(i));const c=Object.keys(i).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(i[e])),[]);localStorage.setItem(n,JSON.stringify(c));const s=a.includes(t.value);if(g(t,s),s){const e=t.getAttribute("onCorrect");await R(e,t)}else{const e=t.getAttribute("onInCorrect");await R(e,t)}U(s)}i||G(a)!==G(l)||H()}})),t.addEventListener("pointerdown",(()=>{"clickable"===t.getAttribute("animation")&&(t.classList.add("removeShadow"),t.style.top="40px",t.style.position="relative")})),t.addEventListener("pointerup",(()=>{"clickable"===t.getAttribute("animation")&&setTimeout((()=>{t.classList.remove("removeShadow"),t.style.top="0px",t.style.position="relative"}),50)}))):console.error("No element provided.")}(t);break;case"drop":!function(t){let e=JSON.parse(localStorage.getItem(l)||"{}");const o=t.getAttribute("tabIndex");"object"==typeof e&&null!==e||(e={}),e[o]||(e[o]={drop:t.id,isFull:!1},localStorage.setItem(l,JSON.stringify(e))),t.onclick=()=>{T(t,"drop")},Q(t,"drop")}(t);break;case"slide":!function(t){let e=!1,o=!1,a=0,r=0,i=0,c=0;const l=t.parentElement;if(!l)return void console.error("Parent element not found.");const s=e=>{b(t),o=!0,e instanceof MouseEvent?(a=e.clientX,r=e.clientY):(a=e.touches[0].clientX,r=e.touches[0].clientY),t.style.opacity="0.8",t.style.cursor="grabbing";const n=window.getComputedStyle(t).transform;if("none"!==n){const t=n.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");i=parseFloat(e[4]),c=parseFloat(e[5])}}else i=0,c=0;l.getBoundingClientRect(),t.getBoundingClientRect(),document.addEventListener("mousemove",d),document.addEventListener("mouseup",u),document.addEventListener("touchmove",d),document.addEventListener("touchend",u)};new MutationObserver((e=>{for(const o of e)"attributes"===o.type&&"style"===o.attributeName&&(l.getBoundingClientRect(),t.getBoundingClientRect())})).observe(l,{attributes:!0,attributeFilter:["style"]});const d=n=>{if(!o)return;const s=E(l);let d=0,u=0;n instanceof MouseEvent?(d=(n.clientX-a)/s,u=(n.clientY-r)/s):(d=(n.touches[0].clientX-a)/s,u=(n.touches[0].clientY-r)/s);const m=i+d,p=c+u,f=l.getBoundingClientRect(),h=t.getBoundingClientRect(),g=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),v=h.left/s-g[0],b=h.top-g[1],S=f.top-b,w=f.bottom-(h.bottom-g[1]),x=m+v<=f.left?f.left-v:Math.min(m,f.right-(h.right/s-g[0])),y=p+b<=f.top?S:Math.min(p,w);t.style.transform=`translate(${x}px, ${y}px)`;let O=I(t,"slide");if(O&&O!=t){const o=t.parentElement,l=O.parentElement;if(o&&l){const s=document.createComment("element-placeholder"),d=document.createComment("overlapped-placeholder");o.replaceChild(s,t),l.replaceChild(d,O),o.replaceChild(O,s),l.replaceChild(t,d),t.style.transform="translate(0, 0)",a=n instanceof MouseEvent?n.clientX:n.touches[0].clientX,r=n instanceof MouseEvent?n.clientY:n.touches[0].clientY,i=0,c=0,e=!0}}},u=()=>{o=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",u),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",u),t.style.opacity="",t.style.cursor="move",t.style.transform="translate(0, 0)",e&&((t=>{const e=JSON.parse(localStorage.getItem(n))||[],o=document.querySelectorAll("[type='slide']");let a=0;o.forEach((t=>{e[a++]=t.value})),localStorage.setItem(n,JSON.stringify(e));const r=document.querySelector("#lido-container").objective.split(","),i=e.indexOf(t.value),c=L(t.value,[r[i].trim()]);U(c),Y()})(t),e=!1)};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",s),t.addEventListener("touchstart",s),t.addEventListener("click",(()=>{T(t,"drag")}))}(t);break;case"word":case"option":!function(t){let o=!1,n=!1,a=0,r=0,i=0,c=0;const l=document.querySelector("#lido-container"),s=document.querySelector('[type="blank"]'),d=t.parentElement!==s?t.parentElement:null,u=t.getAttribute("type"),m=l.querySelector('[type="optionArea"]');if(m&&(m.style.display="block",m.style.overflowY="auto"),!l)return void console.error('Container with ID "lido-container" not found.');const p=e=>{const d=$(e),m=Math.abs(d.clientX-i),p=Math.abs(d.clientY-c);if(!o&&(m>5||p>5)){if(o=!0,t.parentElement!==s&&"word"===u){const e=N(t);t.parentElement.insertBefore(e,t.nextElementSibling)}if("category"!==t.parentElement.getAttribute("type")&&"option"===u){const e=N(t);e.setAttribute("value",`${t.getAttribute("value")}`),e.style.visibility="hidden",t.parentElement.insertBefore(e,t.nextElementSibling)}const e=l.getBoundingClientRect(),n=O(l),i=(d.clientY-e.top-r)/n;t.style.left=(d.clientX-e.left-a)/n+"px",t.style.top=`${i}px`;const c=t.getBoundingClientRect();a=d.clientX-c.left,r=d.clientY-c.top,t.style.opacity="0.8",t.style.cursor="grabbing",t.style.position="absolute",t.style.zIndex="1000",t.style.touchAction="none",t.style.transition="none"}if(!o)return;n=!1,e.preventDefault();const f=l.getBoundingClientRect(),h=O(l),g=(d.clientY-f.top-r)/h;let v;if(t.style.left=(d.clientX-f.left-a)/h+"px",t.style.top=`${g}px`,"option"===u)v=J(t,"option")||J(t,"dummy");else if(v=J(t,"word")||J(t,"dummy"),v&&v.parentElement!==document.querySelector('[type="blank"]'))return;v&&"dummy"===v.getAttribute("type")||null!==y&&y===v||(function(t,e){var o,n;if(t===e)return;if(e&&"option"===e.getAttribute("type")&&"category"!==e.parentElement.getAttribute("type"))return;if("word"===t.getAttribute("type")&&!J(t,"blank"))return;if("option"===t.getAttribute("type")&&!J(t,"category"))return;const a=document.querySelector('[type="blank"]'),r=document.querySelector('[type="dummy"]');if(r)if(e)null===(o=e.parentNode)||void 0===o||o.insertBefore(r,e);else{const e=J(t,"category");e?e.appendChild(r):a.appendChild(r)}else{const o=N(t);o.style.visibility="hidden",o.setAttribute("type","dummy");const r=`\n      @keyframes widthIncrease {\n        0% { width: 0px; height: 0px; }\n        100% { width: ${t.offsetWidth}px; height: ${t.offsetHeight}px;}\n      }\n    `;if(e)null===(n=e.parentNode)||void 0===n||n.insertBefore(o,e);else{const e=J(t,"category");e?e.appendChild(o):a.appendChild(o)}const i=document.styleSheets[0];i.insertRule(r,i.cssRules.length),o.style.animation="widthIncrease 0.5s",o.addEventListener("animationend",(()=>{o.style.width=`${t.offsetWidth}px`,o.style.height=`${t.offsetHeight}px`}))}}(t,v),y=v)},f=()=>{o=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",f);const a=document.querySelector('[type="dummy"]');if(n)h(t);else if("option"!==u){if(J(t,"blank")&&a&&a.replaceWith(t),d){const e=Array.from(d.children);(function(t,e){const o=t.getBoundingClientRect(),n=e.getBoundingClientRect();return!(o.right<n.left||o.left>n.right||o.bottom<n.top||o.top>n.bottom)}(t,d)||t.parentElement===d)&&e.forEach((e=>{e!==t&&e.getAttribute("value")===t.getAttribute("value")&&e.replaceWith(t)}))}k(t),y=null,A(s,t)}else{const o=J(t,"category"),n=Array.from(l.querySelectorAll(`[value="${t.getAttribute("value")}"]`)).find((e=>e!==t));if(o){if(a&&(a.replaceWith(t),o.parentElement.classList.add("highlight-element"),l.querySelectorAll('[type="category"]').forEach((t=>{t!==o&&t.parentElement.classList.remove("highlight-element")})),C(t,o)),n){const t=document.styleSheets[0];t.insertRule(`\n            @keyframes widthDecrease {\n              0% { width: ${n.offsetWidth}px; height: ${n.offsetHeight}px; }\n              100% { width: 0px; height: 0px;}\n            }\n          `,t.cssRules.length),n.style.animation="widthDecrease 0.5s",n.addEventListener("animationend",(()=>{n.remove()}))}}else if("category"!==t.parentElement.type)R("this.alignMatch=true",n,t),setTimeout((()=>{n.replaceWith(t)}),500);else{const o=t.parentElement,n=JSON.parse(localStorage.getItem(e))||{},r=o.tabIndex,i=t.value;n[r]&&(n[r]=n[r].filter((t=>t!==i)),localStorage.setItem(e,JSON.stringify(n))),m.scrollTo({top:m.scrollHeight,behavior:"smooth"}),m.appendChild(t),a&&a.remove()}k(t)}},h=t=>{if("option"===u){const o=l.querySelectorAll('[type="category"]'),n=Array.from(o).find((t=>t.parentElement.className.includes("highlight-element")));if("category"===t.parentElement.getAttribute("type")){const o=JSON.parse(localStorage.getItem(e))||{},a=n.tabIndex,r=t.value;o[a]&&(o[a]=o[a].filter((t=>t!==r)),localStorage.setItem(e,JSON.stringify(o)));const i=N(t);return m.appendChild(i),m.scrollTo({top:m.scrollHeight,behavior:"smooth"}),t.style.position="absolute",R("this.alignMatch='true'",i,t),void setTimeout((()=>{k(t),i.replaceWith(t)}),500)}{if(!n)return;const e=N(t);return n.appendChild(e),t.style.position="absolute",R("this.alignMatch=true",e,t),void setTimeout((()=>{e.replaceWith(t),k(t),C(t,n),t.style.transform="translate(0,0)",t.style.marginBottom="10px"}),500)}}if("word"===u&&t.parentElement===d){const e=N(t);return e.style.visibility="hidden",s.appendChild(e),R("this.alignMatch=true",e,t),void setTimeout((()=>{const o=N(t);t.parentElement.insertBefore(o,t.nextElementSibling),e.replaceWith(t),t.style.transform="translate(0,0)",A(s,t)}),500)}{const e=Array.from(d.children).find((e=>e.getAttribute("value")===t.getAttribute("value")));R("this.alignMatch=true",e,t),setTimeout((()=>{e.replaceWith(t),t.style.transform="translate(0,0)"}),500)}};t.style.cursor="move",t.addEventListener("pointerdown",(t=>{n=!0,o=!1;const e=$(t);i=e.clientX,c=e.clientY,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f),document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",f)}))}(t)}!function(t){if(!t)return;const e=t.getAttribute("onTouch");e&&(t.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",e),e&&await R(e,t)})}(t)}},R=async(t,e,o)=>{var n;const a=B(t);for(let t=0;t<a.length;t++){const r=a[t],i=document.querySelector(r.actor),c="this"===r.actor?e:"element"===r.actor?o:i||document.getElementById(r.actor);if(c)switch(r.action){case"transform":{const t=window.getComputedStyle(c).transform;c.style.transform="none"!==t?`${t} ${r.value}`:r.value;break}case"alignMatch":{const t=c,e=o,a=document.querySelector("#lido-container"),r=E(a);e.style.transform="translate(0,0)";const i=t.getBoundingClientRect(),l=e.getBoundingClientRect(),s=(i.left+i.width/2-(l.left+l.width/2))/r,d=(i.top+i.height/2-(l.top+l.height/2))/r;e.style.transform=(null===(n=o.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())===m.Diagonal?`translate(${s-70}px, ${d-70}px)`:`translate(${s}px, ${d}px)`;break}case"removeClone":document.querySelectorAll(r.value).forEach((t=>t.remove()));break;case"addClass":c.classList.add(r.value);break;case"removeClass":c.classList.remove(r.value);break;case"speak":await x.getI().play(c);break;case"stop":await x.getI().stop();break;case"sleep":!isNaN(Number(r.value))&&await new Promise((t=>setTimeout(t,Number(r.value))));break;case"avatarAnimate":{const t=v.getInstance().getRiveInstance();t&&r.value&&t.play(r.value);break}default:c.style[r.action]=r.value}}},B=t=>{var e;const o=[];return t?((null===(e=t.split(";"))||void 0===e?void 0:e.map((t=>t.trim()))).forEach((t=>{if(t){const[e,n]=t.split("=").map((t=>t.trim())),a=e.lastIndexOf(".");if(-1!==a){const t=e.substring(0,a).trim(),r=e.substring(a+1).trim();o.push({actor:t,action:r,value:n.replace(/['"]/g,"")})}}})),o):o},L=(t,e)=>{const o=t.split(",").map((t=>t.trim()));let n=0,a=new Set;for(const t of o)if(t.startsWith("(")&&t.endsWith(")")){const o=t.slice(1,-1).split("|").map((t=>t.trim())),a=e[n].slice(1,-1).split("|").map((t=>t.trim()));if(n>a.length)return!1;for(let t=0;t<o.length;t++)if(!o.includes(a[t]))return!1;n++}else if(t.includes("|")){const e=t.split("|").map((t=>t.trim()));for(const t of e)a.add(t)}else{if(n>=e.length||e[n]!==t)return!1;n++}for(;n<e.length;){if(!a.has(e[n]))return!1;a.delete(e[n]),n++}return n===e.length},G=t=>{const e=t.split(",").map((t=>t.trim()));let o=0;for(const t of e)t.startsWith("(")&&t.endsWith(")")?t.includes("|")?o+=t.split("|").length:o+=1:o+=t.split("|").length;return o},U=t=>{t?F.rightMoves+=1:F.wrongMoves+=1,console.log("Right Moves : ",F.rightMoves),console.log("Wrong Moves : ",F.wrongMoves)};async function X(t,a){var r,i;const c=document.querySelector("#lido-container");if(!c)return;if("true"===c.getAttribute("isAllowOnlyCorrect")&&!a.value.includes(t.value))return t.style.transform="translate(0,0)",void("option"===t.type&&Array.from(c.querySelectorAll(`[value="${t.value}"]`)).forEach((e=>{e!==t&&e.getAttribute("value")===t.getAttribute("value")&&e.replaceWith(t)})));await R("this.alignMatch='true'",a,t);let l=JSON.parse(null!==(r=localStorage.getItem(e))&&void 0!==r?r:"{}");const s=a.getAttribute("tabindex");l[s]||(l[s]=[]),l[s].push(t.value),localStorage.setItem(e,JSON.stringify(l));let d=JSON.parse(null!==(i=localStorage.getItem(o))&&void 0!==i?i:"{}");const u=a.getAttribute("tabindex");d[u]||(d[u]=[]),d[u].push(t.id),localStorage.setItem(o,JSON.stringify(d));const p=Object.keys(l).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>{const o=l[e];return t.push(o.length>1?`(${o.join("|")})`:o[0]),t}),[]);localStorage.setItem(n,JSON.stringify(p)),document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==m.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),Y()}const Y=()=>{var t,e;const o=document.querySelector("#lido-container"),a=o.objective,r=null!==(t=localStorage.getItem(n))&&void 0!==t?t:"",i=document.querySelector("#lido-checkButton");r&&G(r)===G(a)?"true"==o.getAttribute("showCheck")?null===(e=null==i?void 0:i.classList)||void 0===e||e.remove("lido-disable-check-button"):H():R("this.addClass='lido-disable-check-button'",i)},H=async()=>{var t;const e=document.querySelector("#lido-container");if(!e)return;const o=e.objective,r=null!==(t=JSON.parse(localStorage.getItem(n)))&&void 0!==t?t:[];if(L(o,r)){const t=e.getAttribute("onCorrect");t&&await R(t,e),V()}else{const t=e.getAttribute("onInCorrect");await R(t,e),"true"===e.getAttribute("isContinueOnCorrect")||V()}await(()=>{const t=F.rightMoves;(t=>{var e,o,n;const r=document.querySelector("lido-home");if(!r)return;const i=Number(null!==(e=r.getAttribute("index"))&&void 0!==e?e:0),c=Number(null!==(o=r.getAttribute("totalIndex"))&&void 0!==o?o:0),l=JSON.parse(null!==(n=localStorage.getItem(a))&&void 0!==n?n:"{}");if(l[i.toString()]=t,function(t,e,o){p("lidoActivityEnd",{index:t,totalIndex:e,score:o})}(i,c,t),localStorage.setItem(a,JSON.stringify(l)),c-1==i){const t=Object.values(l),e=t.reduce(((t,e)=>t+e),0)/t.length;F.finalScore=Math.floor(e),console.log("Total Score : ",F.finalScore),function(t){p("lidoLessonEnd",{score:t})}(e),localStorage.removeItem(a)}})(Math.floor(t/(t+F.wrongMoves)*100)),F.rightMoves=0,F.wrongMoves=0})()},V=()=>{x.getI().stop(),console.log("ðŸš€ ~ triggerNextContainer ~ event:",event),p(r,{})};function q(e){const o=document.querySelector("#lido-container").getAttribute("baseUrl");return(null==e?void 0:e.startsWith("http"))||(null==e?void 0:e.startsWith("blob"))?e:o?o+e:t(e)}function z(t,e,o,n,a){if(void 0===n)return;const r=Array.from(t.children);let i=n;e&&n<e&&(i=e),o&&n>o&&(i=o),r.forEach(((t,e)=>{t.style.display=e<i?a:"none"}))}const K=(t,e)=>t&&t.includes(",")?t.split(",").reduce(((t,e)=>{const[o,n]=e.split(".");return t[o.trim()]=n.trim(),t}),{})[e]||"":t,Q=(t,e)=>{const o=document.querySelectorAll("[type='drag']"),n=document.querySelectorAll("[type='drop']"),a=document.querySelectorAll("[type='click']");let r=0;if("click"===e)return a.forEach((t=>{const e=t;let o=null;if(e.getAttribute("flexibleWidth"))o=e;else{const t=e.children;for(let e=0;e<t.length;e++){const n=t[e];if(n.getAttribute("flexibleWidth")){o=n;break}}}if(o){const t=o.style.width,e=o.style.padding;o.style.width="auto",o.style.padding="0 20px";const n=o.offsetWidth;o.style.width=t,o.style.padding=e,n>r&&(r=n)}})),void a.forEach((t=>{const e=t;if(e.getAttribute("flexibleWidth")){if("true"===e.getAttribute("flexibleWidth"))return;e.style.width=`${r}px`}else{const t=e.children;for(let e=0;e<t.length;e++){const o=t[e];if(o.getAttribute("flexibleWidth")){if("true"===o.getAttribute("flexibleWidth"))return;o.style.width=`${r}px`;break}}}}));o.forEach((e=>{var o;const n=e,a=n.style.width,i=n.style.padding;n.style.width="auto",n.style.padding="0 20px";const c=n.offsetWidth;n.style.width=a,n.style.padding=i,(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==m.Stretch&&c>r&&(r=c)})),o.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");"false"===n?o.style.width=`${r}px`:"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")})),n.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");if("false"===n){const t=parseFloat(getComputedStyle(o).borderWidth);if("number"==typeof t){const e=r-2*t,n=parseFloat(o.style.height)-2*t;return o.style.height=`${n}px`,void(o.style.width=`${e}px`)}}else"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")}))};export{e as D,r as N,v as R,n as S,u as T,c as a,l as b,q as c,o as d,h as e,W as f,f as g,z as h,P as i,K as p,V as t}