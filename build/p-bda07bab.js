const t="dragSelectedMap";const n="selectedValues";function e(t,n,e){return(t||"")+(n?` ${n}`:"")+(e?` ${e}`:"")}function o(e){let o=false;let c=0;let l=0;let i=0;let u=0;const d=document.getElementById("container");if(!d){console.error(`Container with ID "container" not found.`);return}const m=t=>{const n=window.getComputedStyle(t).transform;if(n==="none"){return 1}else{const t=n.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");const e=parseFloat(n[0]);return e}}return 1};const h=t=>{o=true;if(t instanceof MouseEvent){c=t.clientX;l=t.clientY}else{c=t.touches[0].clientX;l=t.touches[0].clientY}e.style.opacity="0.8";e.style.cursor="grabbing";const n=window.getComputedStyle(e).transform;if(n!=="none"){const t=n.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");i=parseFloat(n[4]);u=parseFloat(n[5])}}else{i=0;u=0}document.addEventListener("mousemove",M);document.addEventListener("mouseup",S);document.addEventListener("touchmove",M);document.addEventListener("touchend",S)};const p=d.getBoundingClientRect();const g=e.getBoundingClientRect();let x=p.top-g.top;let w=p.left-g.left;const b=new MutationObserver((t=>{for(const n of t){if(n.type==="attributes"&&n.attributeName==="style"){const t=d.getBoundingClientRect();const n=e.getBoundingClientRect();x=t.top-n.top;w=t.left-n.left}}}));const v={attributes:true,attributeFilter:["style"]};b.observe(d,v);const M=t=>{if(!o)return;const n=m(d);let s=0;let a=0;if(t instanceof MouseEvent){s=(t.clientX-c)/n;a=(t.clientY-l)/n}else{s=(t.touches[0].clientX-c)/n;a=(t.touches[0].clientY-l)/n}const r=i+s;const f=u+a;const h=d.getBoundingClientRect();const p=e.getBoundingClientRect();const g=e.style.transform.match(/-?\d+(\.\d+)?/g);const b=g.map(Number);const v=p.left/n-b[0];const M=p.top-b[1];const S=h.width/n-Math.abs(w/n)-p.width/n;const k=h.left-v;const y=h.top-M;const N=h.height/n-Math.abs(x/n)-p.height/n;const E=r+v<=h.left?k:Math.min(r,S);const O=f+M<=h.top?y:Math.min(f,N);e.style.transform=`translate(${E}px, ${O}px)`;const $=document.querySelectorAll("[type='drop']");let C=null;let F=0;$.forEach((t=>{const n=t.getBoundingClientRect();const e=Math.max(0,Math.min(p.right,n.right)-Math.max(p.left,n.left));const o=Math.max(0,Math.min(p.bottom,n.bottom)-Math.max(p.top,n.top));const s=e*o;if(s>F){F=s;C=t}}));$.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));if(C){C.style.border="2px dashed #ff0000";C.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const S=()=>{var c;o=false;document.removeEventListener("mousemove",M);document.removeEventListener("mouseup",S);document.removeEventListener("touchmove",M);document.removeEventListener("touchend",S);e.style.opacity="";e.style.cursor="move";const l=document.querySelectorAll("[type='drop']");l.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));const i=e.getBoundingClientRect();let u=null;let d=0;l.forEach((t=>{const n=t.getBoundingClientRect();const e=Math.max(0,Math.min(i.right,n.right)-Math.max(i.left,n.left));const o=Math.max(0,Math.min(i.bottom,n.bottom)-Math.max(i.top,n.top));const s=e*o;if(s>d){d=s;u=t}}));if(!u)return;let m=JSON.parse((c=localStorage.getItem(t))!==null&&c!==void 0?c:"{}");if(!m[u.getAttribute("tabindex")]){m[u.getAttribute("tabindex")]=[]}m[u.getAttribute("tabindex")]=[e["value"]];localStorage.setItem(t,JSON.stringify(m));const h=Object.keys(m).sort(((t,n)=>parseInt(t)-parseInt(n)));const p=h.reduce(((t,n)=>t.concat(m[n])),[]);console.log("ðŸš€ ~ onEnd ~ dragScore:",m,p);localStorage.setItem(n,JSON.stringify(p));if(a(u["value"],[e["value"]])){const t=u.getAttribute("onMatch");if(t){s(t,u,e)}}else{f([u,e])}r()};e.style.cursor="move";e.style.transform="translate(0, 0)";e.addEventListener("mousedown",h);e.addEventListener("touchstart",h)}const s=(t,n,e)=>{console.log("ðŸš€ ~ executeActions ~ actionsString:",t);const o=c(t);console.log("ðŸš€ ~ executeActions ~ actions:",o);o.forEach((t=>{const o=t.actor==="this"?n:t.actor==="element"?e:document.getElementById(t.actor);console.log("ðŸš€ ~ executeActions ~ targetElement:",o,t.action);if(o){if(t.action==="transform"){const n=window.getComputedStyle(o).transform;o.style.transform=n!=="none"?`${n} ${t.value}`:t.value}else{o.style[t.action]=t.value}}}))};const c=t=>{const n=[];const e=t.split(";").map((t=>t.trim()));e.forEach((t=>{if(t){const[e,o]=t.split("=").map((t=>t.trim()));const s=e.lastIndexOf(".");if(s!==-1){const t=e.substring(0,s).trim();const c=e.substring(s+1).trim();n.push({actor:t,action:c,value:o.replace(/['"]/g,"")})}}}));return n};const a=(t,n)=>{const e=t.split(",").map((t=>t.trim()));let o=0;let s=new Set;for(const t of e){if(t.startsWith("(")&&t.endsWith(")")){const e=t.slice(1,-1).split("|").map((t=>t.trim()));if(o>=n.length)return false;if(!e.includes(n[o]))return false;o++}else if(t.includes("|")){const n=t.split("|").map((t=>t.trim()));for(const t of n){s.add(t)}}else{if(o>=n.length||n[o]!==t)return false;o++}}while(o<n.length){if(!s.has(n[o])){return false}s.delete(n[o]);o++}return o===n.length};function r(){var e;const o=document.getElementById("container");if(!o)return;const s=o["objective"];const c=JSON.parse((e=localStorage.getItem(n))!==null&&e!==void 0?e:"[]");const r=a(s,c);console.log("ðŸš€ ~ onActivityComplete ~ res:",r,s,c);if(r){localStorage.removeItem(n);localStorage.removeItem(t);setTimeout((()=>{l()}),1500)}}const l=()=>{const t=new CustomEvent("nextContainer");console.log("ðŸš€ ~ triggerNextContainer ~ event:",t);window.dispatchEvent(t)};const i=(t,n)=>{switch(n){case"drag":{o(t);break}case"click":{u(t);break}}};function u(t){t.style.cursor="pointer";if(!t){console.error("No element provided.");return}const e=()=>{console.log("Element clicked:",t);localStorage.setItem(n,JSON.stringify([t["value"]]));t.style.border="2px solid yellow";t.style.boxShadow="0px 0px 10px rgba(255, 255, 0, 0.7)";t.style.transition="transform 0.2s ease, border 0.5s ease";t.style.transform="scale(1.1)";setTimeout((()=>{t.style.transform="scale(1)";t.style.border="";t.style.boxShadow="";const n=document.getElementById("container");const e=n["objective"];if(a(e,[t["value"]])){const n=t.getAttribute("onTouch");s(n,t)}else{f([t])}}),500);r()};t.addEventListener("click",e)}function f(t){const n="wrong-answer-animation-style";if(!document.getElementById(n)){const t=document.createElement("style");t.id=n;t.innerHTML=`\n          @keyframes enhanced-shake {\n              0% { left: 0; }\n              10% { left: -8px; }\n              20% { left: 8px; }\n              30% { left: -8px; }\n              40% { left: 8px; }\n              50% { left: -6px; }\n              60% { left: 6px; }\n              70% { left: -4px; }\n              80% { left: 4px; }\n              90% { left: -2px; }\n              100% { left: 0; }\n          }\n          \n          .wrong-answer {\n              position: relative; /* Enable relative positioning to move the element */\n              animation: enhanced-shake 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97);\n              background-color: #ffdddd; /* Flash red background to indicate wrong answer */\n              box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); /* Subtle red shadow */\n          }\n      `;document.head.appendChild(t)}t.forEach((t=>{t.classList.add("wrong-answer");t.addEventListener("animationend",(()=>{t.classList.remove("wrong-answer")}),{once:true})}))}export{t as D,n as S,e as f,i};
//# sourceMappingURL=p-bda07bab.js.map