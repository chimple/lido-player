import{g as t}from"./p-37351245.js";const e="lidoDragSelectedMap";const o="lidoSelectedValues";const n="lidoActivityScore";const c="lidoActivityEnd";const s="lidoLessonEnd";const r="lidoNextContainer";const a="lidoActivityChange";const i="lidoGameCompleted";const l="lidoElementDrop";const u="lidoElementClick";var d;(function(t){t["NoFlow"]="lido-noFlow";t["ShowFlow"]="lido-showFlow";t["FreeTrace"]="lido-freeTrace";t["BlindTracing"]="lido-blindTracing";t["BlindFreeTrace"]="lido-blindFreeTrace"})(d||(d={}));class f{constructor(){this.rightMoves=0;this.wrongMoves=0;this.finalScore=0}}function m(t,e){const o=new CustomEvent(t,{detail:e});window.dispatchEvent(o)}function h(t,e,o){m(c,{index:t,totalIndex:e,score:o})}function p(t){m(s,{score:t})}function g(){m(r,{})}function b(){m(i,{})}function S(t){m(a,{index:t})}function w(t,e,o){m(l,{dragElement:t,dropElement:e,isCorrect:o,createdAt:(new Date).toISOString()})}function v(t,e){m(u,{element:t,isCorrect:e,createdAt:(new Date).toISOString()})}class y{constructor(){}static getInstance(){if(!y.instance){y.instance=new y}return y.instance}setRiveInstance(t){this.riveInstance=t}getRiveInstance(){return this.riveInstance}}const O=new f;function N(t,e,o){return(t||"")+(e?` ${e}`:"")+(o?` ${o}`:"")}const x=t=>{t.style.animation="unset";const e=window.getComputedStyle(t).transform;if(e==="none"){return 1}else{const t=e.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");const o=parseFloat(e[0]);return o}}return 1};function k(t){let e=false;let o=false;let n=0;let c=0;let s=0;let r=0;const a=t.parentElement;if(!a){console.error(`Parent element not found.`);return}const i=e=>{H(t);o=true;if(e instanceof MouseEvent){n=e.clientX;c=e.clientY}else{n=e.touches[0].clientX;c=e.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const i=window.getComputedStyle(t).transform;if(i!=="none"){const t=i.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");s=parseFloat(e[4]);r=parseFloat(e[5])}}else{s=0;r=0}a.getBoundingClientRect();t.getBoundingClientRect();document.addEventListener("mousemove",d);document.addEventListener("mouseup",f);document.addEventListener("touchmove",d);document.addEventListener("touchend",f)};const l=new MutationObserver((e=>{for(const o of e){if(o.type==="attributes"&&o.attributeName==="style"){a.getBoundingClientRect();t.getBoundingClientRect()}}}));const u={attributes:true,attributeFilter:["style"]};l.observe(a,u);const d=i=>{if(!o)return;const l=x(a);let u=0;let d=0;if(i instanceof MouseEvent){u=(i.clientX-n)/l;d=(i.clientY-c)/l}else{u=(i.touches[0].clientX-n)/l;d=(i.touches[0].clientY-c)/l}const f=s+u;const m=r+d;const h=a.getBoundingClientRect();const p=t.getBoundingClientRect();const g=t.style.transform.match(/-?\d+(\.\d+)?/g);const b=g.map(Number);const S=p.left/l-b[0];const w=p.top-b[1];const v=p.right/l-b[0];const y=p.bottom-b[1];const O=h.right-v;const N=h.left-S;const k=h.top-w;const J=h.bottom-y;const M=f+S<=h.left?N:Math.min(f,O);const E=m+w<=h.top?k:Math.min(m,J);t.style.transform=`translate(${M}px, ${E}px)`;let I=C(t,"slide");if(I){if(I!=t){const o=t.parentElement;const a=I.parentElement;if(o&&a){const l=document.createComment("element-placeholder");const u=document.createComment("overlapped-placeholder");o.replaceChild(l,t);a.replaceChild(u,I);o.replaceChild(I,l);a.replaceChild(t,u);t.style.transform="translate(0, 0)";n=i instanceof MouseEvent?i.clientX:i.touches[0].clientX;c=i instanceof MouseEvent?i.clientY:i.touches[0].clientY;s=0;r=0;e=true}}}};const f=n=>{o=false;document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",f);document.removeEventListener("touchmove",d);document.removeEventListener("touchend",f);t.style.opacity="";t.style.cursor="move";t.style.transform="translate(0, 0)";if(e){J(t);e=false}};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",i);t.addEventListener("touchstart",i);t.addEventListener("click",(e=>{z(t,"drag")}))}const J=t=>{const e=JSON.parse(localStorage.getItem(o))||[];const n=document.querySelectorAll("[type='slide']");let c=0;n.forEach((t=>{e[c++]=t["value"]}));localStorage.setItem(o,JSON.stringify(e));const s=document.querySelector("#lido-container")["objective"];const r=s.split(",");const a=e.indexOf(t["value"]);const i=j(t["value"],[r[a].trim()]);T(i);R()};function M(t){let o=false;let n=0;let c=0;let s=0;let r=0;const a=document.querySelector("#lido-container");if(!a){console.error(`Container with ID "container" not found.`);return}let i;let l;const u=e=>{H(t);o=true;if(e instanceof MouseEvent){n=e.clientX;c=e.clientY}else{n=e.touches[0].clientX;c=e.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const a=window.getComputedStyle(t).transform;if(a!=="none"){const t=a.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");s=parseFloat(e[4]);r=parseFloat(e[5])}}else{s=0;r=0}document.addEventListener("mousemove",p);document.addEventListener("mouseup",g);document.addEventListener("touchmove",p);document.addEventListener("touchend",g)};const d=a.getBoundingClientRect();const f=t.getBoundingClientRect();i=d.top-f.top;l=d.left-f.left;const m=new MutationObserver((e=>{for(const o of e){if(o.type==="attributes"&&o.attributeName==="style"){const e=a.getBoundingClientRect();const o=t.getBoundingClientRect();i=e.top-o.top;l=e.left-o.left}}}));const h={attributes:true,attributeFilter:["style"]};m.observe(a,h);const p=u=>{if(!o)return;const d=x(a);let f=0;let m=0;if(u instanceof MouseEvent){f=(u.clientX-n)/d;m=(u.clientY-c)/d}else{f=(u.touches[0].clientX-n)/d;m=(u.touches[0].clientY-c)/d}const h=s+f;const p=r+m;const g=a.getBoundingClientRect();const b=t.getBoundingClientRect();const S=t.style.transform.match(/-?\d+(\.\d+)?/g);const w=S.map(Number);const v=b.left/d-w[0];const y=b.top-w[1];const O=g.width/d-Math.abs(l/d)-b.width/d;const N=g.left-v;const k=g.top-y;const J=g.height/d-Math.abs(i/d)-b.height/d;const M=h+v<=g.left?N:Math.min(h,O);const E=p+y<=g.top?k:Math.min(p,J);t.style.transform=`translate(${M}px, ${E}px)`;let I=C(t,"drop");const $=document.querySelectorAll("[type='drop']");$.forEach((t=>{const o=JSON.parse(localStorage.getItem(e))||{};const n=Object.keys(o).map(Number);if(n.includes(t["tabIndex"])){t.style.border="";t.style.backgroundColor="transparent"}else{t.style.border="";t.style.backgroundColor=""}}));if(I){I.style.border="2px dashed #ff0000";I.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const g=n=>{o=false;document.removeEventListener("mousemove",p);document.removeEventListener("mouseup",g);document.removeEventListener("touchmove",p);document.removeEventListener("touchend",g);t.style.opacity="";t.style.cursor="move";const c=document.querySelectorAll("[type='drop']");c.forEach((t=>{c.forEach((t=>{const o=JSON.parse(localStorage.getItem(e))||{};const n=Object.keys(o).map(Number);if(n.includes(t["tabIndex"])){t.style.border="";t.style.backgroundColor="transparent"}else{t.style.border="";t.style.backgroundColor=""}}))}));let s=C(t,"drop");E(t,s)};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",u);t.addEventListener("touchstart",u);t.addEventListener("click",(e=>{z(t,"drag")}))}const C=(t,e)=>{const o=t.getBoundingClientRect();const n=document.querySelectorAll(`[type="${e}"]`);let c=null;let s=0;n.forEach((n=>{if(n===t)return;const r=n.getBoundingClientRect();const a=Math.max(0,Math.min(o.right,r.right)-Math.max(o.left,r.left));const i=Math.max(0,Math.min(o.bottom,r.bottom)-Math.max(o.top,r.top));const l=a*i;if(e==="slide"){const t=o.width*o.height;const e=r.width*r.height;const a=Math.min(t,e)*.8;if(l>=a&&l>s){s=l;c=n}return}if(l>s){s=l;c=n}}));return c};async function E(t,n){const c=localStorage.getItem(o);const s=localStorage.getItem(e);if(n&&n.getAttribute("isAllowOnlyOneDrop")==="true"){let o=C(t,"drag");if(o){t.style.transform="translate(0,0)";if(s){let o=JSON.parse(s);for(const e in o){if(o[e].includes(t["value"])){delete o[e]}}localStorage.setItem(e,JSON.stringify(o))}const o=document.querySelectorAll("[type='drop']");o.forEach((t=>{const o=JSON.parse(localStorage.getItem(e))||{};const n=Object.keys(o).map(Number);if(n.includes(t["tabIndex"])){t.style.border="";t.style.backgroundColor="transparent"}else{t.style.border="";t.style.backgroundColor=""}}));return}}if(!n){if(c){let e=JSON.parse(c);e=e.filter((e=>e!=t["value"]));localStorage.setItem(o,JSON.stringify(e))}if(s){let o=JSON.parse(s);for(const e in o){if(o[e].includes(t["value"])){delete o[e]}}localStorage.setItem(e,JSON.stringify(o))}const n=document.querySelectorAll("[type='drop']");n.forEach((t=>{const o=JSON.parse(localStorage.getItem(e))||{};const n=Object.keys(o).map(Number);if(n.includes(t["tabIndex"])){t.style.border="";t.style.backgroundColor="transparent"}else{t.style.border="";t.style.backgroundColor=""}}));R();return}if(s){let o=JSON.parse(s);for(const e in o){if(o[e].includes(t["value"])){delete o[e]}}localStorage.setItem(e,JSON.stringify(o))}const r=n["value"].includes(t["value"]);w(t,n,r);if(r){const e=n.getAttribute("onCorrect");if(e){await I(e,n,t)}}else{const e=n.getAttribute("onInCorrect");await I(e,n,t)}T(r);await F(t,n)}const I=async(t,e,o)=>{const n=$(t);for(let t=0;t<n.length;t++){const c=n[t];const s=document.querySelector(c.actor);const r=c.actor==="this"?e:c.actor==="element"?o:s?s:document.getElementById(c.actor);if(r){switch(c.action){case"transform":{const t=window.getComputedStyle(r).transform;r.style.transform=t!=="none"?`${t} ${c.value}`:c.value;break}case"alignMatch":{const t=r;const e=o;const n=document.querySelector("#lido-container");const c=x(n);e.style.transform="translate(0,0)";const s=t.getBoundingClientRect();const a=e.getBoundingClientRect();const i=(s.left-a.left)/c;const l=(s.top-a.top)/c;e.style.transform=`translate(${i}px, ${l}px)`;break}case"addClass":{r.classList.add(c.value);break}case"speak":{{let t=r.getAttribute("audio");if(t){t=X(t);let e=document.querySelector("#audio");if(!e){const t=document.createElement("audio");t.id="audio";document.body.appendChild(t);e=t}e.pause();e.currentTime=0;e.src=t;console.log("🚀 ~ executeActions ~ audioElement.src:",e.src);try{await e.play();K(r);while(!e.ended||e.error){await new Promise((t=>setTimeout(t,100)))}Q(r)}catch(t){console.log("🚀 ~ executeActions ~ audioElement.src: error",t)}}else if(r.textContent){try{K(r);await Y(r.textContent);Q(r)}catch(t){console.log("🚀 ~ executeActions ~ error:",t)}}break}}case"sleep":{const t=!isNaN(Number(c.value));if(t){await new Promise((t=>setTimeout(t,Number(c.value))))}break}case"avatarAnimate":{const t=y.getInstance();const e=t.getRiveInstance();if(e&&c.value){e.play(c.value)}break}default:{r.style[c.action]=c.value;break}}}}};const $=t=>{var e;const o=[];if(!t)return o;const n=(e=t.split(";"))===null||e===void 0?void 0:e.map((t=>t.trim()));n.forEach((t=>{if(t){const[e,n]=t.split("=").map((t=>t.trim()));const c=e.lastIndexOf(".");if(c!==-1){const t=e.substring(0,c).trim();const s=e.substring(c+1).trim();o.push({actor:t,action:s,value:n.replace(/['"]/g,"")})}}}));return o};const j=(t,e)=>{const o=t.split(",").map((t=>t.trim()));let n=0;let c=new Set;for(const t of o){if(t.startsWith("(")&&t.endsWith(")")){const e=t.slice(1,-1).split("|").map((t=>t.trim()));const o=t.slice(1,-1).split("|").map((t=>t.trim()));if(n>=o.length)return false;if(!e.includes(o[n]))return false;n++}else if(t.includes("|")){const e=t.split("|").map((t=>t.trim()));for(const t of e){c.add(t)}}else{if(n>=e.length||e[n]!==t)return false;n++}}while(n<e.length){if(!c.has(e[n])){return false}c.delete(e[n]);n++}return n===e.length};const A=t=>{const e=t.split(",").map((t=>t.trim()));let o=0;for(const t of e){if(t.startsWith("(")&&t.endsWith(")")){if(t.includes("|")){o+=t.split("|").length}else{o+=1}}else{o+=t.split("|").length}}return o};async function F(t,n){var c;const s=document.querySelector("#lido-container");if(!s)return;const r=s.getAttribute("isAllowOnlyCorrect")==="true";if(r){const e=n["value"].includes(t["value"]);if(!e){t.style.transform="translate(0,0)";return}}await I("this.alignMatch='true'",n,t);let a=JSON.parse((c=localStorage.getItem(e))!==null&&c!==void 0?c:"{}");const i=n.getAttribute("tabindex");if(!a[i]){a[i]=[]}a[i].push(t["value"]);localStorage.setItem(e,JSON.stringify(a));const l=Object.keys(a).sort(((t,e)=>parseInt(t)-parseInt(e)));const u=l.reduce(((t,e)=>{const o=a[e];if(o.length>1){t.push(`(${o.join("|")})`)}else{t.push(o[0])}return t}),[]);localStorage.setItem(o,JSON.stringify(u));const d=document.querySelectorAll("[type='drop']");d.forEach((t=>{const o=JSON.parse(localStorage.getItem(e))||{};const n=Object.keys(o).map(Number);if(n.includes(t["tabIndex"])){t.style.border="";t.style.backgroundColor="transparent"}else{t.style.border="";t.style.backgroundColor=""}}));R()}const T=t=>{if(t){O.rightMoves+=1}else{O.wrongMoves+=1}console.log("Right Moves : ",O.rightMoves);console.log("Wrong Moves : ",O.wrongMoves)};const D=()=>{const t=O.rightMoves;const e=O.wrongMoves;let o=Math.floor(t/(t+e)*100);P(o);O.rightMoves=0;O.wrongMoves=0};const P=t=>{var e,o,c;const s=document.querySelector("lido-home");if(!s)return;const r=Number((e=s.getAttribute("index"))!==null&&e!==void 0?e:0);const a=Number((o=s.getAttribute("totalIndex"))!==null&&o!==void 0?o:0);const i=JSON.parse((c=localStorage.getItem(n))!==null&&c!==void 0?c:"{}");const l=r.toString();i[l]=t;h(r,a,t);localStorage.setItem(n,JSON.stringify(i));if(a-1==r){const t=Object.values(i);const e=t.reduce(((t,e)=>t+e),0)/t.length;O.finalScore=Math.floor(e);console.log("Total Score : ",O.finalScore);p(e);localStorage.removeItem(n)}};const R=()=>{var t;const e=document.querySelector("#lido-container");const n=e["objective"];const c=(t=localStorage.getItem(o))!==null&&t!==void 0?t:"";const s=document.querySelector("#lido-checkButton");if(!c||A(c)!==A(n)){I("this.addClass='lido-disable-check-button'",s);return}const r=e.getAttribute("showCheck")=="true";if(r){s.classList.remove("lido-disable-check-button")}else{B()}};const B=async()=>{var t;const e=document.querySelector("#lido-container");if(!e)return;const n=e["objective"];const c=(t=JSON.parse(localStorage.getItem(o)))!==null&&t!==void 0?t:[];const s=j(n,c);if(s){G();const t=e.getAttribute("onCorrect");if(t){await I(t,e)}L()}else{const t=e.getAttribute("onInCorrect");await I(t,e);const o=e.getAttribute("isContinueOnCorrect")==="true";if(!o){L()}}await D()};const G=()=>{const t=document.querySelectorAll("[type='drag']");const e=document.querySelectorAll("[type='drop']");if(!t||!e)return;e.forEach((e=>{t.forEach((t=>{const o=t;if(e["value"].includes(o["value"])){o.style.transform="translate(0,0)";e.appendChild(o)}}))}))};const L=()=>{console.log("🚀 ~ triggerNextContainer ~ event:",event);g()};const U=async(t,e)=>{const o=document.querySelector("#lido-container");if(!o)return;const n=t.getAttribute("onEntry");await I(n,t);const c=o.getAttribute("canplay");if(c!=null&&c==="false")return;switch(e){case"drag":{M(t);break}case"click":{W(t);break}case"drop":{q(t);break}case"slide":{k(t);break}}V(t)};function V(t){if(!t)return;const e=t.getAttribute("onTouch");if(!e)return;t.onclick=async()=>{console.log("🚀 ~ element.onclick= ~ onTouch:",e);if(!e)return;await I(e,t)}}function W(t){t.style.cursor="pointer";if(!t){console.error("No element provided.");return}const n=async()=>{const n=document.querySelector("#lido-container");const c=n["objective"].split(",");const s=document.querySelector("#lido-checkButton");const r=n.getAttribute("showCheck")==="true";if(t.getAttribute("id")=="lido-checkButton"){s.classList.add("lido-disable-check-button");await B();return}const a=t.classList.contains("lido-element-selected");let i=JSON.parse(localStorage.getItem(o))||[];if(c.length===1){localStorage.setItem(o,JSON.stringify([t["value"]]));const e=c.includes(t["value"]);v(t,e);if(e){const e=t.getAttribute("onCorrect");await I(e,t)}else{const e=t.getAttribute("onInCorrect");await I(e,t)}T(e);R();return}if(r){s.classList.remove("lido-disable-check-button")}if(a){t.classList.remove("lido-element-selected");I(t.getAttribute("onEntry"),t);i=i.filter((e=>e!=t["value"]));localStorage.setItem(o,JSON.stringify(i));let n=JSON.parse(localStorage.getItem(e))||{};const c=t["value"];const a=Object.keys(n).find((t=>n[t].includes(c)));if(a){n[a]=n[a].filter((t=>t!==c));if(n[a].length===0){delete n[a]}localStorage.setItem(e,JSON.stringify(n));const t=Object.keys(n).sort(((t,e)=>parseInt(t)-parseInt(e)));const s=t.reduce(((t,e)=>t.concat(n[e])),[]);localStorage.setItem(o,JSON.stringify(s))}if(r&&i.length===0){s.classList.add("lido-disable-check-button")}return}else{t.classList.add("lido-element-selected");const n=t["value"];const s=Object.keys(c).find((t=>c[t]===n));let r=JSON.parse(localStorage.getItem(e))||{};if(!s){r[c.length+i.length]=[n]}else{r[s]=[n]}localStorage.setItem(e,JSON.stringify(r));const a=Object.keys(r).sort(((t,e)=>parseInt(t)-parseInt(e)));const l=a.reduce(((t,e)=>t.concat(r[e])),[]);localStorage.setItem(o,JSON.stringify(l));const u=c.includes(t["value"]);v(t,u);if(u){const e=t.getAttribute("onCorrect");await I(e,t)}else{const e=t.getAttribute("onInCorrect");await I(e,t)}T(u)}if(!r&&A(c)===A(i)){B()}};t.addEventListener("click",n)}function q(t){t.onclick=()=>{z(t,"drop")}}async function z(t,e){const o=document.querySelectorAll(`[type='${e}']`);o.forEach((t=>{H(t)}));if(!document.querySelector("#dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style";t.innerHTML=`\n      .highlight {\n        border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        border-radius: 12px; /* Larger rounded corners */\n        background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    `;document.head.appendChild(t)}t===null||t===void 0?void 0:t.classList.add("highlight");t.ariaPressed="true";const n=e==="drop"?t:document.querySelector("[type='drop'].highlight");const c=e==="drag"?t:document.querySelector("[type='drag'].highlight");if(n&&c){c.style.transition="transform 0.5s ease";c.style.transform="";const t=document.querySelector("#lido-container");const e=x(t);console.log("🚀 ~ onClickDropOrDragElement ~ containerScale:",e);const o=n.getBoundingClientRect();const s=c.getBoundingClientRect();const r=(o.left-s.left)/e;const a=(o.top-s.top)/e;c.style.transform=`translate(${r}px, ${a}px)`;const i=document.querySelectorAll(`*`);i.forEach((t=>{H(t)}));await E(c,n)}}function H(t){t.classList.remove("highlight");t.ariaPressed="false"}function K(t){if(!t)return;t.classList.add("speaking-highlight");const e="#speaking-highlight-style";if(!document.querySelector(e)){const t=document.createElement("style");t.id=e;t.innerHTML=`\n      .speaking-highlight {\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9) !important; /* Stronger orange glow effect */\n        border: 3px solid green !important;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n      }\n    `;document.head.appendChild(t)}}function Q(t){if(!t)return;t.classList.remove("speaking-highlight")}function X(e){const o=document.querySelector("#lido-container");const n=o.getAttribute("baseUrl");if(e.startsWith("http")){return e}else if(n){return n+e}else{return t(e)}}async function Y(t){return new Promise(((e,o)=>{if(!("speechSynthesis"in window)){o(new Error("Speech synthesis is not supported in this browser."));return}const n=new SpeechSynthesisUtterance(t);n.onend=()=>{e(true)};n.onerror=t=>{o(new Error(`Speech synthesis error: ${t.error}`))};window.speechSynthesis.speak(n)}))}export{e as D,r as N,y as R,o as S,d as T,b as a,X as c,S as d,N as f,U as i,L as t};
//# sourceMappingURL=p-c35ed209.js.map