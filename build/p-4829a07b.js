const n="dragSelectedMap";const t="selectedValues";var e;(function(n){n["NoFlow"]="noFlow";n["ShowFlow"]="showFlow";n["FreeTrace"]="freeTrace";n["BlindTracing"]="blindTracing";n["BlindFreeTrace"]="blindFreeTrace"})(e||(e={}));function o(n,t,e){return(n||"")+(t?` ${t}`:"")+(e?` ${e}`:"")}const s=n=>{const t=window.getComputedStyle(n).transform;if(t==="none"){return 1}else{const n=t.match(/matrix\(([^)]+)\)/);if(n){const t=n[1].split(", ");const e=parseFloat(t[0]);return e}}return 1};function c(n){let t=false;let e=0;let o=0;let c=0;let r=0;const i=document.getElementById("container");if(!i){console.error(`Container with ID "container" not found.`);return}const l=s=>{b(n);t=true;if(s instanceof MouseEvent){e=s.clientX;o=s.clientY}else{e=s.touches[0].clientX;o=s.touches[0].clientY}n.style.opacity="0.8";n.style.cursor="grabbing";const a=window.getComputedStyle(n).transform;if(a!=="none"){const n=a.match(/matrix\(([^)]+)\)/);if(n){const t=n[1].split(", ");c=parseFloat(t[4]);r=parseFloat(t[5])}}else{c=0;r=0}document.addEventListener("mousemove",p);document.addEventListener("mouseup",x);document.addEventListener("touchmove",p);document.addEventListener("touchend",x)};const u=i.getBoundingClientRect();const d=n.getBoundingClientRect();let f=u.top-d.top;let m=u.left-d.left;const h=new MutationObserver((t=>{for(const e of t){if(e.type==="attributes"&&e.attributeName==="style"){const t=i.getBoundingClientRect();const e=n.getBoundingClientRect();f=t.top-e.top;m=t.left-e.left}}}));const g={attributes:true,attributeFilter:["style"]};h.observe(i,g);const p=a=>{if(!t)return;const l=s(i);let u=0;let d=0;if(a instanceof MouseEvent){u=(a.clientX-e)/l;d=(a.clientY-o)/l}else{u=(a.touches[0].clientX-e)/l;d=(a.touches[0].clientY-o)/l}const h=c+u;const g=r+d;const p=i.getBoundingClientRect();const w=n.getBoundingClientRect();const b=n.style.transform.match(/-?\d+(\.\d+)?/g);const x=b.map(Number);const y=w.left/l-x[0];const k=w.top-x[1];const v=p.width/l-Math.abs(m/l)-w.width/l;const M=p.left-y;const S=p.top-k;const T=p.height/l-Math.abs(f/l)-w.height/l;const N=h+y<=p.left?M:Math.min(h,v);const E=g+k<=p.top?S:Math.min(g,T);n.style.transform=`translate(${N}px, ${E}px)`;const $=document.querySelectorAll("[type='drop']");let F=null;let O=0;$.forEach((n=>{const t=n.getBoundingClientRect();const e=Math.max(0,Math.min(w.right,t.right)-Math.max(w.left,t.left));const o=Math.max(0,Math.min(w.bottom,t.bottom)-Math.max(w.top,t.top));const s=e*o;if(s>O){O=s;F=n}}));$.forEach((n=>{n.style.border="";n.style.backgroundColor=""}));if(F){F.style.border="2px dashed #ff0000";F.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const x=e=>{t=false;document.removeEventListener("mousemove",p);document.removeEventListener("mouseup",x);document.removeEventListener("touchmove",p);document.removeEventListener("touchend",x);n.style.opacity="";n.style.cursor="move";const o=document.querySelectorAll("[type='drop']");o.forEach((n=>{n.style.border="";n.style.backgroundColor=""}));const s=n.getBoundingClientRect();let c=null;let r=0;o.forEach((n=>{const t=n.getBoundingClientRect();const e=Math.max(0,Math.min(s.right,t.right)-Math.max(s.left,t.left));const o=Math.max(0,Math.min(s.bottom,t.bottom)-Math.max(s.top,t.top));const a=e*o;if(a>r){r=a;c=n}}));a(n,c)};n.style.cursor="move";n.style.transform="translate(0, 0)";n.addEventListener("mousedown",l);n.addEventListener("touchstart",l);n.addEventListener("click",(t=>{w(n,"drag")}))}async function a(e,o){var s;if(!o)return;let c=JSON.parse((s=localStorage.getItem(n))!==null&&s!==void 0?s:"{}");if(!c[o.getAttribute("tabindex")]){c[o.getAttribute("tabindex")]=[]}c[o.getAttribute("tabindex")]=[e["value"]];localStorage.setItem(n,JSON.stringify(c));const a=Object.keys(c).sort(((n,t)=>parseInt(n)-parseInt(t)));const i=a.reduce(((n,t)=>n.concat(c[t])),[]);localStorage.setItem(t,JSON.stringify(i));if(l(o["value"],[e["value"]])){const n=o.getAttribute("onCorrectMatch");if(n){await r(n,o,e)}}else{g([o,e])}await u()}const r=async(n,t,e)=>{const o=i(n);for(let n=0;n<o.length;n++){const s=o[n];const c=s.actor==="this"?t:s.actor==="element"?e:document.getElementById(s.actor);if(c){switch(s.action){case"transform":{const n=window.getComputedStyle(c).transform;c.style.transform=n!=="none"?`${n} ${s.value}`:s.value;break}case"speak":{{const n=c.getAttribute("audio");if(n){let t=document.getElementById("audio");if(!t){const n=document.createElement("audio");n.id="audio";document.body.appendChild(n);t=n}t.pause();t.currentTime=0;t.src=n;console.log("ðŸš€ ~ executeActions ~ audioElement.src:",t.src);try{await t.play();x(c);while(!t.ended||t.error){await new Promise((n=>setTimeout(n,100)))}y(c)}catch(n){console.log("ðŸš€ ~ executeActions ~ audioElement.src: error",n)}}break}}case"sleep":{const n=!isNaN(Number(s.value));if(n){await new Promise((n=>setTimeout(n,Number(s.value))))}break}default:{c.style[s.action]=s.value;break}}}}};const i=n=>{var t;const e=[];if(!n)return e;const o=(t=n.split(";"))===null||t===void 0?void 0:t.map((n=>n.trim()));o.forEach((n=>{if(n){const[t,o]=n.split("=").map((n=>n.trim()));const s=t.lastIndexOf(".");if(s!==-1){const n=t.substring(0,s).trim();const c=t.substring(s+1).trim();e.push({actor:n,action:c,value:o.replace(/['"]/g,"")})}}}));return e};const l=(n,t)=>{const e=n.split(",").map((n=>n.trim()));let o=0;let s=new Set;for(const n of e){if(n.startsWith("(")&&n.endsWith(")")){const e=n.slice(1,-1).split("|").map((n=>n.trim()));if(o>=t.length)return false;if(!e.includes(t[o]))return false;o++}else if(n.includes("|")){const t=n.split("|").map((n=>n.trim()));for(const n of t){s.add(n)}}else{if(o>=t.length||t[o]!==n)return false;o++}}while(o<t.length){if(!s.has(t[o])){return false}s.delete(t[o]);o++}return o===t.length};async function u(){var e;const o=document.getElementById("container");if(!o)return;const s=o["objective"];const c=JSON.parse((e=localStorage.getItem(t))!==null&&e!==void 0?e:"[]");const a=l(s,c);if(a){localStorage.removeItem(t);localStorage.removeItem(n);await new Promise((n=>setTimeout(n,1500)));d()}}const d=()=>{const n=new CustomEvent("nextContainer");console.log("ðŸš€ ~ triggerNextContainer ~ event:",n);window.dispatchEvent(n)};const f=async(n,t)=>{switch(t){case"drag":{c(n);break}case"click":{h(n);break}case"drop":{p(n);break}}const e=n.getAttribute("onEntry");await r(e,n);m(n)};function m(n){if(!n)return;const t=n.getAttribute("onTouch");if(!t)return;n.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",t);if(!t)return;await r(t,n)}}function h(n){n.style.cursor="pointer";if(!n){console.error("No element provided.");return}const e=async()=>{console.log("Element clicked:",n);localStorage.setItem(t,JSON.stringify([n["value"]]));n.style.border="2px solid yellow";n.style.boxShadow="0px 0px 10px rgba(255, 255, 0, 0.7)";n.style.transition="transform 0.2s ease, border 0.5s ease";n.style.transform="scale(1.1)";n.style.transform="scale(1)";n.style.border="";n.style.boxShadow="";const e=document.getElementById("container");const o=e["objective"];if(l(o,[n["value"]])){const t=n.getAttribute("onCorrectTouch");await r(t,n)}else{g([n])}await u()};n.addEventListener("click",e)}function g(n){const t="wrong-answer-animation-style";if(!document.getElementById(t)){const n=document.createElement("style");n.id=t;n.innerHTML=`\n          @keyframes enhanced-shake {\n              0% { left: 0; }\n              10% { left: -8px; }\n              20% { left: 8px; }\n              30% { left: -8px; }\n              40% { left: 8px; }\n              50% { left: -6px; }\n              60% { left: 6px; }\n              70% { left: -4px; }\n              80% { left: 4px; }\n              90% { left: -2px; }\n              100% { left: 0; }\n          }\n          \n          .wrong-answer {\n              position: relative; /* Enable relative positioning to move the element */\n              animation: enhanced-shake 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97);\n              background-color: #ffdddd; /* Flash red background to indicate wrong answer */\n              box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); /* Subtle red shadow */\n          }\n      `;document.head.appendChild(n)}n.forEach((n=>{n.classList.add("wrong-answer");n.addEventListener("animationend",(()=>{n.classList.remove("wrong-answer")}),{once:true})}))}function p(n){n.onclick=()=>{w(n,"drop")}}async function w(n,t){const e=document.querySelectorAll(`[type='${t}']`);e.forEach((n=>{b(n)}));if(!document.getElementById("dynamic-highlight-style")){const n=document.createElement("style");n.id="dynamic-highlight-style";n.innerHTML=`\n      .highlight {\n        border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        border-radius: 12px; /* Larger rounded corners */\n        background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    `;document.head.appendChild(n)}n===null||n===void 0?void 0:n.classList.add("highlight");n.ariaPressed="true";const o=t==="drop"?n:document.querySelector("[type='drop'].highlight");const c=t==="drag"?n:document.querySelector("[type='drag'].highlight");if(o&&c){c.style.transition="transform 0.5s ease";c.style.transform="";const n=document.getElementById("container");const t=s(n);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",t);const e=o.getBoundingClientRect();const r=c.getBoundingClientRect();const i=(e.left-r.left)/t;const l=(e.top-r.top)/t;c.style.transform=`translate(${i}px, ${l}px)`;const u=document.querySelectorAll(`*`);u.forEach((n=>{b(n)}));await new Promise((n=>setTimeout(n,500)));await a(c,o);await new Promise((n=>setTimeout(n,500)));c.style.transform="translate(0px, 0px)"}}function b(n){n.classList.remove("highlight");n.ariaPressed="false"}function x(n){if(!n)return;n.classList.add("speaking-highlight");const t="speaking-highlight-style";if(!document.getElementById(t)){const n=document.createElement("style");n.id=t;n.innerHTML=`\n      .speaking-highlight {\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9); /* Stronger orange glow effect */\n        border: 3px solid orange;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n      }\n    `;document.head.appendChild(n)}}function y(n){if(!n)return;n.classList.remove("speaking-highlight");n.style.boxShadow="";n.style.border=""}export{n as D,t as S,e as T,o as f,f as i,d as t};
//# sourceMappingURL=p-4829a07b.js.map