import{r as t,h as e,H as n,g as i,a as s}from"./p-160313d2.js";import{i as o,S as d,D as r,T as h,t as a}from"./p-4db699ee.js";const c=".col{top:var(--y, 0);left:var(--x, 0);height:var(--height, 100%);width:var(--width, 100%);background-color:var(--bgColor, #eeeeee);padding:15px;border-radius:10px;display:flex;justify-content:space-around;flex-direction:column;align-items:center}.col>*{}";const l=c;const u=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,display:this.visible?"flex":"none",zIndex:this.z};return e(n,{key:"3cd3b141cf167e7c43132fc0f28fe049765e3e68",id:this.id,class:"col",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("slot",{key:"fecc9cdf6b7204461c07e89de0ebec35559f8daf"}))}get el(){return i(this)}};u.style=l;const f=".container{position:relative;height:100%;width:100%;background-color:var(--bgColor, #ffffff);display:flex;flex-direction:column;justify-content:center;align-items:center}";const p=f;const g=class{constructor(e){t(this,e);this.id=undefined;this.objective=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onIncorrectTouch=undefined;this.onEntry=undefined;this.canplay=true}scaleContainer(t){var e;const n=[window.innerWidth];if((e=window.screen)===null||e===void 0?void 0:e.width){n.push(window.screen.width)}const i=Math.min(...n);const s=document.documentElement.clientHeight;const o=i/1600;const d=s/900;const r=Math.min(o,d);t.style.transform=`translate(-50%, -50%) scale(${r})`}componentDidLoad(){this.scaleContainer(this.el);document.body.style.backgroundColor=this.bgColor;window.addEventListener("resize",(()=>this.scaleContainer(this.el)));window.addEventListener("load",(()=>this.scaleContainer(this.el)));o(this.el,this.type)}render(){const t={backgroundColor:this.bgColor,width:"1600px",height:"900px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"};console.log("ðŸš€ ~ AppContainer ~ canplay:",this.canplay);return e(n,{key:"3de4da721c5eb3dcdd9b29e01cfcc7968d40a761",id:"container",tabindex:0,class:"container",objective:this.objective,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onIncorrectTouch:this.onIncorrectTouch,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onEntry:this.onEntry},e("slot",{key:"bd4abd0fd97b92a6f942554be26a28d3948f7a5d"}))}get el(){return i(this)}};g.style=p;const b="@import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap'); body{overflow:hidden}";const x=b;const v="@keyframes rightToPlace{from{transform:translateX(2000px)}to{left:0}}@keyframes placeToLeft{from{}to{transform:translateX(-2000px)}}@keyframes shake{0%{transform:translateX(0);color:red;outline:4px solid red}10%{transform:translateX(-5px);color:red;outline:4px solid red}20%{transform:translateX(5px);color:red;outline:4px solid red}30%{transform:translateX(-5px);color:red;outline:4px solid red}40%{transform:translateX(5px);color:red;outline:4px solid red}50%{transform:translateX(-5px);color:red;outline:4px solid red}60%{transform:translateX(5px);color:red;outline:4px solid red}70%{transform:translateX(-5px);color:red;outline:4px solid red}80%{transform:translateX(5px);color:red;outline:4px solid red}90%{transform:translateX(-5px);color:red;outline:4px solid red}100%{transform:translateX(0);color:red;outline:4px solid red}}@keyframes fallAndBounce{0%{transform:translateY(-1000px)}25%{transform:translateY(0px)}50%{transform:translateY(-200px)}75%{transform:translateY(0)}90%{transform:translateY(-100px)}100%{transform:translateY(0)}}";const y=v;const m=class{constructor(e){t(this,e);this.nextContainer=t=>{if(t!=undefined&&t==this.currentContainerIndex)return;localStorage.removeItem(d);localStorage.removeItem(r);if(t!=undefined&&t<this.containers.length){this.currentContainerIndex=t;window.dispatchEvent(new CustomEvent("activityChange",{detail:{index:this.currentContainerIndex}}))}else if(this.currentContainerIndex<this.containers.length-1){this.currentContainerIndex++;window.dispatchEvent(new CustomEvent("activityChange",{detail:{index:this.currentContainerIndex}}))}else{this.showCompletionMessage=true;const t=new CustomEvent("gameCompleted");window.dispatchEvent(t);setTimeout((()=>{this.showCompletionMessage=false}),3e3)}this.containers=[...this.containers]};this.xmlData=undefined;this.initialIndex=0;this.canplay=true;this.currentContainerIndex=this.initialIndex;this.showCompletionMessage=false;this.containers=[]}componentWillLoad(){window.addEventListener("nextContainer",(()=>{this.nextContainer()}));window.addEventListener("changeContainer",(t=>{this.nextContainer(t.detail.index)}));this.parseXMLData(this.xmlData);window.addEventListener("beforeunload",(()=>{localStorage.removeItem(d);localStorage.removeItem(r)}))}disconnectedCallback(){window.removeEventListener("nextContainer",(()=>{this.nextContainer()}));window.removeEventListener("changeContainer",(t=>{this.nextContainer(t.detail.index)}))}parseXMLData(t){if(t){const e=new DOMParser;const n=e.parseFromString(t,"text/xml");const i=n.documentElement;this.parseContainers(i)}}parseElement(t){const n=t.nodeName.toLowerCase();const i={};Array.from(t.attributes).forEach((t=>{i[t.name]=t.value}));const s=Array.from(t.childNodes).map((t=>{if(t.nodeType===1){return this.parseElement(t)}else if(t.nodeType===3&&t.textContent.trim()!==""){return t.textContent}return null})).filter(Boolean);const o={"app-container":e("app-container",Object.assign({},i,{canplay:this.canplay}),s),"app-col":e("app-col",Object.assign({},i),s),"app-trace":e("app-trace",Object.assign({},i),s),"app-image":e("app-image",Object.assign({},i),s),"app-row":e("app-row",Object.assign({},i),s),"app-text":e("app-text",Object.assign({},i),s),"app-pos":e("app-pos",Object.assign({},i),s),"app-shape":e("app-shape",Object.assign({},i),s),"app-wrap":e("app-wrap",Object.assign({},i),s),"app-random":e("app-random",Object.assign({},i),s)};if(o[n]){return o[n]}else{console.warn(`Unknown tag: ${n}`);return null}}parseContainers(t){const e=[];const n=t.querySelectorAll("app-container");n.forEach((t=>{const n=this.parseElement(t);if(n){e.push(n)}}));this.containers=e}renderDots(){return e("div",{id:"dot-indicator",class:"dot-container"},this.containers.map(((t,n)=>e("span",{class:`dot ${n<this.currentContainerIndex?"completed":n===this.currentContainerIndex?"current":""}`,onClick:()=>this.jumpToContainer(n)}))))}jumpToContainer(t){this.nextContainer(t)}render(){if(!this.xmlData){return e("div",null,"Please provide XML data.")}return e("div",null,e("div",{key:this.currentContainerIndex},this.containers[this.currentContainerIndex]),this.renderDots(),this.showCompletionMessage&&e("div",{class:"snackbar"},"All containers have been displayed!"),e("style",null,`\n            .snackbar {\n              visibility: visible;\n              min-width: 250px;\n              background-color: #333;\n              color: #fff;\n              text-align: center;\n              border-radius: 2px;\n              padding: 16px;\n              position: fixed;\n              z-index: 1;\n              bottom: 30px;\n              left: 50%;\n              transform: translateX(-50%);\n              font-size: 17px;\n            }\n\n            .dot-container {\n              text-align: center;\n              position: fixed;\n              z-index: 1;\n              width: fit-content;\n              top: 1%;\n              left: 50%;\n              transform: translate(-50%);\n            }\n\n            .dot {\n              height: 15px;\n              width: 15px;\n              margin: 0 4px;\n              background-color: #bbb;\n              border-radius: 50%;\n              display: inline-block;\n              transition: background-color 0.3s;\n              cursor: pointer;\n            }\n\n            .dot.completed {\n              background-color: grey;\n            }\n\n            .dot.current {\n              background-color: green;\n            }\n\n            .dot:not(.completed):not(.current) {\n              background-color: #bbb;\n            }\n          `))}};m.style=x+y;const w=".image{user-select:none;-webkit-user-drag:none;object-fit:contain;max-width:100%;max-height:100%;aspect-ratio:1 / 1;}";const k=w;const C=class{constructor(e){t(this,e);this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined;this.src=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,display:this.visible?"flex":"none",alignItems:"center",justifyContent:"center"};return e(n,{key:"d85a216c432132afe8d3a4d738eee9b3d90a620f",type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,value:this.value,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("img",{key:"dfbc9c9de03ec162505b318da925f2ebb31e1d97",class:"image",src:this.src,style:t}))}get el(){return i(this)}};C.style=k;const T=".pos{top:var(--y, 0);left:var(--x, 0);height:var(--height, 100%);width:var(--width, 100%);background-color:var(--bgColor, #eeeeee);display:flex;justify-content:space-around;flex-direction:column;position:fixed}.pos>*{position:absolute}";const M=T;const I=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,display:this.visible?"block":"none"};return e(n,{key:"c63889200e5b87ccddf17f236898df959b643aee",id:this.id,class:"pos",type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,value:this.value,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("slot",{key:"09b1a03217ffc2c02836f4ac6f61f0887b8445cb"}))}get el(){return i(this)}};I.style=M;const j=".random{display:flex;justify-content:space-between;align-items:center;position:absolute;}.random>*{position:absolute}";const $=j;const W=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){const t=this.el.querySelectorAll(".random > *");t.forEach((t=>{const e=Math.random()*100;const n=Math.random()*100;t.style.top=`${e}%`;t.style.left=`${n}%`}))}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"block":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(n,{key:"66b661510df51498d8aaeaa3b8c43d7caf3ab6d1",class:"random",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("slot",{key:"70b2819af97f7d1f85de0ea1161ae95014e427f4"}))}get el(){return i(this)}};W.style=$;const D=class{constructor(e){t(this,e);this.xmlData=undefined}async componentWillLoad(){const t=s("./assets/xmlData.xml");const e=await fetch(t);const n=await e.text();this.xmlData=n}render(){if(!this.xmlData){return e("div",null,"Loading...")}return e("app-home",{initialIndex:0,canplay:true,xmlData:this.xmlData})}static get assetsDirs(){return["assets"]}};const z=".row{display:flex;justify-content:space-between;align-items:center;}.row>*{}";const L=z;const E=class{constructor(e){t(this,e);this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"flex":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(n,{key:"fc3153fcef0ccc98d99afd2e93607e8c71c0a591",class:"row",type:this.type,tabindex:this.tabIndex,value:this.value,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("slot",{key:"b28ce98adfc7ad7c9ac191eae523b974f9bb97f6"}))}get el(){return i(this)}};E.style=L;const P=".shape{position:absolute;top:var(--y);left:var(--x);display:var(--display);z-index:var(--z)}.rectangle{border-radius:0}.circle{width:var(--width);height:var(--width);border-radius:50%;background-color:var(--bgColor)}.ellipse{width:var(--width);height:var(--height);border-radius:50%;background-color:var(--bgColor)}.triangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--bgColor);clip-path:polygon(50% 0%, 100% 100%, 0% 100%)}.rightTriangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--bgColor);clip-path:polygon(100% 0%, 100% 100%, 0% 100%)}.leftTriangle{width:var(--triangleWidth);height:var(--triangleHeight);background-color:var(--triangleBgColor);clip-path:polygon(0% 0%, 100% 100%, 0% 100%)}.parallelogram{width:var(--paralleWidth);height:var(--paralleHeight);transform:skew(20deg)}.star{width:var(--starWidth);height:var(--starHeight);background-color:var(--starBgColor);clip-path:polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)}.pentagon{width:var(--pentagonWidth);height:var(--pentagonHeight);background-color:var(--pentagonBgColor);clip-path:polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%)}.heptagon{width:var(--heptagonWidth);height:var(--heptagonHeight);background-color:var(--heptagonBgColor);clip-path:polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)}.octagon{width:var(--octagonWidth);height:var(--octagonHeight);background-color:var(--octagonBgColor);clip-path:polygon(25% 0%, 75% 0%, 100% 25%, 100% 75%, 75% 100%, 25% 100%, 0% 75%, 0% 25%)}.rhombus{width:var(--rhombusWidth);height:var(--rhombusHeight);background-color:var(--rhombusBgColor);clip-path:polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)}.heart{height:var(--heartHeight);width:var(--heartWidth);border-image:radial-gradient(var(--heartBgColor) 69%, #0000 70%) 84.5%/50%;clip-path:polygon(-41% 0, 50% 91%, 141% 0)}";const X=P;const S=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.shapeType=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.shapeType!=="polygon"?this.height:undefined,width:this.shapeType!=="polygon"?this.width:undefined,top:this.y,left:this.x,display:this.visible?"block":"none",zIndex:this.z,backgroundColor:this.shapeType!=="polygon"?this.bgColor:"transparent"};return e(n,{key:"64db966fc0a1f601fd0002d0f71de3ec3aae241a",class:`shape ${this.shapeType}`,value:this.value,type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry})}get el(){return i(this)}};S.style=X;const B=".text{background-color:#fff;box-shadow:0 2px 4px rgba(0, 0, 0, 0.1);transition:background-color 0.3s ease;user-select:none;align-items:center;justify-content:center;text-align:center;border-radius:8px;color:#333;cursor:pointer}.text:hover{background-color:#f0f0f0}";const O=B;const _=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.string=undefined;this.font=undefined;this.fontSize=undefined;this.fontColor=undefined;this.highlightWhileSpeaking=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,backgroundColor:this.bgColor,top:this.y,left:this.x,zIndex:this.z,fontSize:this.fontSize,fontFamily:this.font,color:this.fontColor,display:this.visible?"flex":"none"};return e(n,{key:"06c76433420706301a70a892a9081dfea480167e",class:"text",value:this.value,type:this.type,tabindex:this.tabIndex,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry,id:this.id,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden},this.string)}get el(){return i(this)}};_.style=O;const F=":host{display:block;position:relative}#svgContainer{position:absolute;top:0;left:0;right:0;bottom:50px;display:flex;justify-content:center;align-items:center;overflow:hidden}svg{width:100%;height:100%;max-height:calc(100vh - 50px);touch-action:none}#draggableCircle{cursor:pointer;fill:red;transition:fill 0.2s, r 0.2s}.blindTracing{stroke:none !important}.blindFreeTrace{stroke:none !important}.hovered{cursor:grab;fill:darkred}#controls{position:fixed;bottom:0;left:0;right:0;display:flex;justify-content:space-between;padding:10px;background-color:#f0f0f0;border-top:1px solid #ccc}button{padding:10px;font-size:16px}@media (max-width: 600px){button{padding:8px;font-size:14px}}.trace-path-green{stroke:green !important}";const H=F;const A=class{constructor(e){t(this,e);this.id=undefined;this.svgSource=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.tabIndex=undefined;this.mode=undefined;this.fileIndex=-1;this.isDragging=false;this.activePointerId=null}async initializeSVG(){let t={fileIndex:-1,currentPathIndex:0,lastLength:0,totalPathLength:0,isDragging:false,circle:null,paths:[],svg:null,proximityThreshold:100,freeTraceProximityThreshold:50,rafId:null,pointerMoveEvent:null,activePointerId:null,mode:this.mode,flowMarkers:[],freeTraceLines:[]};await this.loadAnotherSVG(t,true)}componentWillLoad(){this.initializeSVG()}async fetchSVG(t){const e=await fetch(t);if(!e.ok){throw new Error(`Failed to fetch SVG (${t}): ${e.statusText}`)}return await e.text()}calculateBoundingBox(t,e=22){let n=Infinity,i=Infinity,s=-Infinity,o=-Infinity;t.forEach((t=>{const e=t.getTotalLength();const d=100;for(let r=0;r<=d;r++){const h=t.getPointAtLength(r/d*e);if(h.x<n)n=h.x;if(h.y<i)i=h.y;if(h.x>s)s=h.x;if(h.y>o)o=h.y}}));n-=e;i-=e;s+=e;o+=e;return{minX:n,minY:i,maxX:s,maxY:o}}insertSVG(t){const e=document.getElementById("svgContainer");e.innerHTML=t;const n=e.querySelector("svg");n.removeAttribute("width");n.removeAttribute("height");const i=n.querySelectorAll("path, line");const s=this.calculateBoundingBox(Array.from(i));const o=s.maxX-s.minX;const d=s.maxY-s.minY;n.setAttribute("viewBox",`${s.minX} ${s.minY} ${o} ${d}`)}getSVGElement(){const t=document.getElementById("svgContainer");return t.querySelector("svg")}getPaths(t){return Array.from(t.querySelectorAll("path, line"))}createFlowMarkersForPath(t,e=10){var n;const i=t.getTotalLength();const s=i/(e+1);const o=[];for(let i=1;i<=e;i++){const e=t.getPointAtLength(i*s);const d=t.getPointAtLength((i+.5)*s);const r=Math.atan2(d.y-e.y,d.x-e.x);const h=document.createElementNS("http://www.w3.org/2000/svg","polygon");h.setAttribute("points","-5,-5 0,0 -5,5");h.setAttribute("fill","blue");h.setAttribute("transform",`translate(${e.x},${e.y}) rotate(${r*180/Math.PI})`);h.setAttribute("class","flow-indicator");o.push(h);(n=t.parentNode)===null||n===void 0?void 0:n.appendChild(h)}return o}updateFlowIndicators(t){const e=t.svg.querySelectorAll(".flow-indicator");e.forEach((e=>{if(t.mode===h.NoFlow){e.style.display="none"}else if(t.mode===h.ShowFlow){e.style.display="block"}}))}setupDrawingPath(t){t.paths.forEach(((e,n)=>{const i=e.getTotalLength();const s=e.cloneNode();s.setAttribute("stroke","green");s.setAttribute("stroke-width","13");s.setAttribute("stroke-dasharray",i.toString());s.setAttribute("stroke-dashoffset",i.toString());e.parentNode.appendChild(s,e);e.setAttribute("class","trace-path");s.setAttribute("class","trace-path-green");e.greenPath=s;e.classList.add(t.mode);if(t.mode===h.BlindTracing||t.mode===h.BlindFreeTrace){e.setAttribute("stroke","none")}else{e.setAttribute("stroke","#000");e.setAttribute("stroke-width","10");e.setAttribute("fill","none");e.setAttribute("stroke-dasharray",i.toString());e.setAttribute("stroke-dashoffset","0")}if(n===t.currentPathIndex&&t.mode===h.ShowFlow){t.flowMarkers=this.createFlowMarkersForPath(e)}}));t.totalPathLength=t.paths[t.currentPathIndex].getTotalLength()}setupDraggableCircle(t){var e;const n=t.paths[0].getPointAtLength(0);const i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("id","draggableCircle");i.setAttribute("cx",n.x.toString());i.setAttribute("cy",n.y.toString());i.setAttribute("r","20");i.setAttribute("fill","red");(e=t.svg)===null||e===void 0?void 0:e.appendChild(i);t.circle=i}addEventListeners(t){var e,n,i,s;if(!t.circle||!t.paths||t.paths.length===0)return;t.circle.addEventListener("pointerdown",(e=>{e.preventDefault();const n=this.getPointerPosition(e,t.svg);const i={x:parseFloat(t.circle.getAttribute("cx")),y:parseFloat(t.circle.getAttribute("cy"))};const s=this.getDistanceSquared(n,i);if(s<=t.proximityThreshold*t.proximityThreshold){t.isDragging=true;t.activePointerId=e.pointerId;t.circle.setPointerCapture(e.pointerId)}}));(e=t.svg)===null||e===void 0?void 0:e.addEventListener("pointermove",(e=>{if(!t.isDragging||e.pointerId!==t.activePointerId)return;t.pointerMoveEvent=e;if(!t.rafId){t.rafId=requestAnimationFrame((()=>{this.handlePointerMove(t);t.rafId=null}))}}));(n=t.svg)===null||n===void 0?void 0:n.addEventListener("pointerup",(e=>{if(e.pointerId===t.activePointerId){t.isDragging=false;t.activePointerId=null}}));(i=t.svg)===null||i===void 0?void 0:i.addEventListener("pointercancel",(e=>{if(e.pointerId===t.activePointerId){t.isDragging=false;t.activePointerId=null}}));(s=t.svg)===null||s===void 0?void 0:s.addEventListener("contextmenu",(t=>{t.preventDefault()}))}handlePointerMove(t){var e,n,i,s;if(!t.isDragging)return;if(!t.circle||!t.paths||t.paths.length===0)return;const o=t.pointerMoveEvent;const d=this.getPointerPosition(o,t.svg);const r={x:parseFloat(t.circle.getAttribute("cx")),y:parseFloat(t.circle.getAttribute("cy"))};const c=t.paths[t.currentPathIndex];if(!c){console.error("No valid path found at the current index");return}let l;if(t.mode===h.FreeTrace||t.mode===h.BlindFreeTrace){l=t.freeTraceProximityThreshold*t.freeTraceProximityThreshold}else{l=t.proximityThreshold*t.proximityThreshold}const u=this.getDistanceSquared(d,r);if(u>l){return}const f=this.getClosestPointOnPath(c,d);const p=this.getDistanceSquared(d,f);if(p>l){return}if(t.mode===h.FreeTrace||t.mode===h.BlindFreeTrace){if(!t.currentFreePath){t.currentFreePath=[]}if(!t.currentFreePath[t.currentPathIndex]){const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("stroke","green");n.setAttribute("stroke-width","8");n.setAttribute("fill","none");n.setAttribute("d",`M${d.x},${d.y}`);(e=t.svg)===null||e===void 0?void 0:e.appendChild(n);t.currentFreePath[t.currentPathIndex]=n;t.lastPointerPos=d}const i=t.lastPointerPos||d;const s=t.currentFreePath[t.currentPathIndex].getAttribute("d");const o=(i.x+d.x)/2;const r=(i.y+d.y)/2;const h=`${s} Q ${i.x},${i.y} ${o},${r}`;t.currentFreePath[t.currentPathIndex].setAttribute("d",h);t.circle.setAttribute("cx",d.x.toString());t.circle.setAttribute("cy",d.y.toString());(n=t.svg)===null||n===void 0?void 0:n.appendChild(t.circle);t.lastPointerPos=d;const a=c.getTotalLength();const l=a-f.length;if(l<5){this.moveToNextPath(t);t.currentFreePath[t.currentPathIndex]=null}return}if(t.isDragging&&f.length>=t.lastLength){t.lastLength=f.length;t.circle.setAttribute("cx",f.x.toString());t.circle.setAttribute("cy",f.y.toString());(i=t.svg)===null||i===void 0?void 0:i.appendChild(t.circle);(s=c.greenPath)===null||s===void 0?void 0:s.setAttribute("stroke-dashoffset",(t.totalPathLength-t.lastLength).toString())}if(t.totalPathLength-1-t.lastLength<5&&t.currentPathIndex<t.paths.length-1){this.moveToNextPath(t)}else if(t.totalPathLength-1-t.lastLength<5&&t.currentPathIndex===t.paths.length-1){a()}}getPointerPosition(t,e){var n;const i=e.createSVGPoint();i.x=t.clientX;i.y=t.clientY;const s=(n=e.getScreenCTM())===null||n===void 0?void 0:n.inverse();return s?i.matrixTransform(s):{x:t.clientX,y:t.clientY}}getDistanceSquared(t,e){const n=t.x-e.x;const i=t.y-e.y;return n*n+i*i}getClosestPointOnPath(t,e){const n=t.getTotalLength();let i={x:0,y:0,length:0};let s=Infinity;const o=20;let d={x:0,y:0,length:0};let r=Infinity;for(let i=0;i<=n;i+=o){const n=t.getPointAtLength(i);const s=this.getDistanceSquared(e,n);if(s<r){r=s;d={x:n.x,y:n.y,length:i}}}const h=2;const a=Math.max(d.length-o,0);const c=Math.min(d.length+o,n);for(let n=a;n<=c;n+=h){const o=t.getPointAtLength(n);const d=this.getDistanceSquared(e,o);if(d<s){s=d;i={x:o.x,y:o.y,length:n}}}return i}async loadAnotherSVG(t,e){t.isDragging=false;try{if(t.svg){this.cleanupPreviousSVG(t)}const e=await this.fetchSVG(this.svgSource);this.insertSVG(e);t.svg=this.getSVGElement();t.paths=this.getPaths(t.svg);this.setupDrawingPath(t);this.setupDraggableCircle(t);this.addEventListeners(t)}catch(t){console.error(`Error loading SVG (${this.svgSource}):`,t)}}cleanupPreviousSVG(t){var e,n;if(t.circle){(e=t.svg)===null||e===void 0?void 0:e.removeChild(t.circle);t.circle=null}const i=(n=t.svg)===null||n===void 0?void 0:n.querySelectorAll(".flow-indicator");i.forEach((t=>{t.remove()}));t.currentPathIndex=0;t.lastLength=0;t.totalPathLength=t.paths[0].getTotalLength()}moveToNextPath(t){var e,n;t.isDragging=false;t.currentPathIndex++;t.lastLength=0;if(t.currentPathIndex>=t.paths.length){a();return}const i=t.paths[t.currentPathIndex];if(!i){console.error("No valid path found at the next index");return}t.totalPathLength=i.getTotalLength();const s=i.getPointAtLength(0);(e=t.circle)===null||e===void 0?void 0:e.setAttribute("cx",s.x.toString());(n=t.circle)===null||n===void 0?void 0:n.setAttribute("cy",s.y.toString());if(t.mode===h.ShowFlow){t.flowMarkers=this.createFlowMarkersForPath(i)}}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,zIndex:this.z,position:"absolute"};return e(n,{key:"c957926b2f3e281966de8d1dca6580931af54019",class:"trace",id:this.id,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,tabindex:this.tabIndex},e("div",{key:"f841bf92fec27ed26594c5ccca937fa20210451f",id:"svgContainer"}))}static get assetsDirs(){return["svg"]}};A.style=H;const G=".wrap{display:grid;grid-gap:10px;grid-template-columns:repeat(auto-fill, minmax(186px, auto))}.wrap>*{padding:10px;background-color:var(--child-bg-color, #f0f0f0);box-sizing:border-box}";const V=G;const Y=class{constructor(e){t(this,e);this.id=undefined;this.value=undefined;this.height=undefined;this.width=undefined;this.ariaLabel=undefined;this.ariaHidden=undefined;this.x=undefined;this.y=undefined;this.z=undefined;this.bgColor=undefined;this.type=undefined;this.tabIndex=undefined;this.visible=undefined;this.audio=undefined;this.onTouch=undefined;this.onCorrectTouch=undefined;this.onInCorrectTouch=undefined;this.onCorrectMatch=undefined;this.onMatch=undefined;this.onWrong=undefined;this.onEntry=undefined}componentDidLoad(){o(this.el,this.type)}render(){const t={height:this.height,width:this.width,top:this.y,left:this.x,display:this.visible?"grid":"none",zIndex:this.z,backgroundColor:this.bgColor};return e(n,{key:"7e955c4ff7d20f7138088114ccf344d0fda171d8",class:"wrap",value:this.value,type:this.type,tabindex:this.tabIndex,style:t,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,audio:this.audio,onTouch:this.onTouch,onMatch:this.onMatch,onWrong:this.onWrong,onCorrectMatch:this.onCorrectMatch,onCorrectTouch:this.onCorrectTouch,onInCorrectTouch:this.onInCorrectTouch,onEntry:this.onEntry},e("slot",{key:"1ee6b59cfe7cbb8b3bc1c830c51e38e0711e6e62"}))}get el(){return i(this)}};Y.style=V;export{u as app_col,g as app_container,m as app_home,C as app_image,I as app_pos,W as app_random,D as app_root,E as app_row,S as app_shape,_ as app_text,A as app_trace,Y as app_wrap};
//# sourceMappingURL=p-b871b8e5.entry.js.map