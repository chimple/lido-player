import{g as t}from"./p-ddf627b0.js";const e="lidoDragSelectedMap",o="lidoSelectedValues",n="lidoActivityScore",a="lidoNextContainer",r="lidoElementDrop",i="dropLength",c="dropHasDrag";var l,s;function d(t,e){const o=new CustomEvent(t,{detail:e});window.dispatchEvent(o)}function u(){d("lidoGameCompleted",{})}function m(t){d("lidoActivityChange",{index:t})}function f(t,e){d("lidoElementClick",{element:t,isCorrect:e,createdAt:(new Date).toISOString()})}!function(t){t.NoFlow="noFlow",t.ShowFlow="showFlow",t.FreeTrace="freeTrace",t.BlindTracing="blindTracing",t.BlindFreeTrace="blindFreeTrace"}(l||(l={})),function(t){t.Diagonal="diagonal"}(s||(s={}));class p{constructor(){}static getInstance(){return p.instance||(p.instance=new p),p.instance}setRiveInstance(t){this.riveInstance=t}getRiveInstance(){return this.riveInstance}}class h{constructor(){this.audioElement=document.createElement("audio"),this.audioElement.id="audio",document.body.appendChild(this.audioElement)}static getI(){return h.instance||(h.instance=new h),h.instance}stop(){(null===window||void 0===window?void 0:window.speechSynthesis)&&window.speechSynthesis.cancel(),this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement.src="",document.querySelectorAll(".speaking-highlight").forEach((t=>X(t)));const t=document.querySelector("#play"),e=document.querySelector("#pause");t&&e&&(t.style.visibility="visible",e.style.visibility="hidden")}async play(t){let e=t.getAttribute("audio")||"";if(!e){const o=t.children;for(let t=0;t<o.length;t++){const n=o[t].getAttribute("audio");n&&(e=n)}}if(e){e=Y(e),this.audioElement.src=e,console.log("ðŸš€ Playing audio:",this.audioElement.src);try{await this.audioElement.play(),U(t),await new Promise((e=>{this.audioElement.onended=()=>{X(t),e()}}))}catch(t){console.log("ðŸš€ Audio play error:",t)}}else if(t.textContent)try{U(t),await async function(t){return new Promise(((e,o)=>{if(!("speechSynthesis"in window))return void o(new Error("Speech synthesis is not supported in this browser."));const n=window.speechSynthesis;setTimeout((()=>{const o=new SpeechSynthesisUtterance(t);o.onend=()=>{e(!0)},n.speak(o)}),50)}))}(t.textContent),X(t)}catch(t){console.log("ðŸš€ TTS Error:",t)}}}let g;function v(t){const e=window.getComputedStyle(t).transform;if(e&&"none"!==e){const t=e.match(/matrix\(([^)]+)\)/);if(t)return t[1].split(",").map((t=>parseFloat(t.trim())))[0]}return 1}const b=t=>{const e=document.createElement("div");if("option"===t.getAttribute("type"))return e.style.width=t.style.width,e.style.height=t.style.height,e;const o=t.style.width,n=t.style.padding;return t.style.width="auto",t.style.padding="0 20px",e.style.width=`${t.offsetWidth+20}px`,e.style.height=`${t.offsetHeight+20}px`,e.style.border="1px solid",e.style.backgroundColor="#00000021",e.style.borderRadius="10px",t.style.width=o,t.style.padding=n,e.setAttribute("value",`${t.getAttribute("value")}`),e};const S=t=>{t.style.opacity="",t.style.cursor="move",t.style.zIndex="",t.style.transform="",t.style.position="",t.style.left="",t.style.top=""};function y(t,e){const o=Array.from(document.querySelectorAll(`[type="${e}"]`));let n=0,a=null;const r=t.getBoundingClientRect();for(const e of o){if(e===t)continue;const o=x(r,e.getBoundingClientRect());o>n&&(n=o,a=e)}return a}function w(t){return t instanceof MouseEvent?{clientX:t.clientX,clientY:t.clientY}:{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}}function x(t,e){return Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top))}const O=(t,e)=>{const n=document.querySelector("#lido-container"),a=n.getAttribute("objective").split(",");let r=JSON.parse(localStorage.getItem(o))||[];r=Array.from(t.children).map((t=>t.getAttribute("value"))),localStorage.setItem(o,JSON.stringify(r));const i=r.indexOf(e.value);if(i>=0){const t=I(e.value,[a[i].trim()]);!t&&n.isAllowOnlyCorrect&&Array.from(n.querySelectorAll(`[value="${e.value}"]`)).find((t=>t!==e)).replaceWith(e),D(t),F()}};async function N(t,o){let n=JSON.parse(localStorage.getItem(e))||{},a=n[o.tabIndex];if(!Array.isArray(a)||!a.includes(t.value)){for(const e in n){const o=n[e].indexOf(t.value);-1!==o&&n[e].splice(o,1)}localStorage.setItem(e,JSON.stringify(n)),await T(t,o)}}const k=new class{constructor(){this.rightMoves=0,this.wrongMoves=0,this.finalScore=0}};function J(t,e,o){return(t||"")+(e?` ${e}`:"")+(o?` ${o}`:"")}const $=t=>{t.style.animation="unset";const e=window.getComputedStyle(t).transform;if("none"===e)return 1;{const t=e.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");return parseFloat(e[0])}}return 1},M=(t,e)=>{const o=t.getBoundingClientRect(),n=document.querySelectorAll(`[type="${e}"]`);let a=null,r=0;return n.forEach((n=>{if(n===t)return;const i=n.getBoundingClientRect(),c=Math.max(0,Math.min(o.right,i.right)-Math.max(o.left,i.left))*Math.max(0,Math.min(o.bottom,i.bottom)-Math.max(o.top,i.top));0!==c&&("slide"===e?c>=.8*Math.min(o.width*o.height,i.width*i.height)&&c>r&&(r=c,a=n):c>r&&(r=c,a=n))})),a};async function A(t,n){var a;const l=localStorage.getItem(o)||"",u=localStorage.getItem(e);let m=JSON.parse(localStorage.getItem(c)||" {}");if(n&&(null===(a=n.getAttribute("dropAttr"))||void 0===a?void 0:a.toLowerCase())!==s.Diagonal&&("true"===n.getAttribute("isAllowOnlyOneDrop")||!n.getAttribute("isAllowOnlyOneDrop"))){const o=Object.values(m).find((t=>document.getElementById(t.drop)===n));if(o?o.isFull=!0:console.warn("No matching drop item found for",n),localStorage.setItem(c,JSON.stringify(m)),M(t,"drag")){if(t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease",u){let o=JSON.parse(u);for(const e in o)o[e].includes(t.value)&&delete o[e];localStorage.setItem(e,JSON.stringify(o))}return void document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))}))}}if(!n){t.style.transform="translate(0,0)",t.style.transition="transform 0.5s ease";let n=L.get(t);if(n){let e=Object.values(m).find((t=>document.getElementById(t.drop)===n));e&&(e.isFull=!1,localStorage.setItem(c,JSON.stringify(m))),L.delete(t)}if(l){let e=JSON.parse(l);e=e.filter((e=>e!=t.value)),localStorage.setItem(o,JSON.stringify(e))}if(u){let o=JSON.parse(u);for(const e in o)o[e].includes(t.value)&&delete o[e];localStorage.setItem(e,JSON.stringify(o))}return document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),void F()}if(u){let o=L.get(t);if(o){let t=Object.values(m).find((t=>document.getElementById(t.drop)===o));t&&(t.isFull=!1,localStorage.setItem(c,JSON.stringify(m)))}let n=JSON.parse(u);for(const e in n)n[e].includes(t.value)&&delete n[e];localStorage.setItem(e,JSON.stringify(n))}let f=JSON.parse(localStorage.getItem(i))||0;if(f+=1,localStorage.setItem(i,JSON.stringify(f)),f===j(n.value)){const t=Object.values(m).find((t=>document.getElementById(t.drop)===n));t?t.isFull=!0:console.warn("No matching drop item found for",n),localStorage.setItem(c,JSON.stringify(m)),f=0,localStorage.setItem(i,JSON.stringify(f))}L.set(t,n);const p=n.value.includes(t.value);if(function(t,e,o){d(r,{dragElement:t,dropElement:e,isCorrect:o,createdAt:(new Date).toISOString()})}(t,n,p),p){const e=n.getAttribute("onCorrect");e&&await C(e,n,t)}else{const e=n.getAttribute("onInCorrect");await C(e,n,t)}D(p),t.style.opacity="1",await T(t,n)}const C=async(t,e,o)=>{var n;const a=E(t);for(let t=0;t<a.length;t++){const r=a[t],i=document.querySelector(r.actor),c="this"===r.actor?e:"element"===r.actor?o:i||document.getElementById(r.actor);if(c)switch(r.action){case"transform":{const t=window.getComputedStyle(c).transform;c.style.transform="none"!==t?`${t} ${r.value}`:r.value;break}case"alignMatch":{const t=c,e=o,a=document.querySelector("#lido-container"),r=$(a);e.style.transform="translate(0,0)";const i=t.getBoundingClientRect(),l=e.getBoundingClientRect(),d=(i.left+i.width/2-(l.left+l.width/2))/r,u=(i.top+i.height/2-(l.top+l.height/2))/r;e.style.transform=(null===(n=o.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())===s.Diagonal?`translate(${d-70}px, ${u-70}px)`:`translate(${d}px, ${u}px)`;break}case"removeClone":document.querySelectorAll(r.value).forEach((t=>t.remove()));break;case"addClass":c.classList.add(r.value);break;case"removeClass":c.classList.remove(r.value);break;case"speak":await h.getI().play(c);break;case"stop":await h.getI().stop();break;case"sleep":!isNaN(Number(r.value))&&await new Promise((t=>setTimeout(t,Number(r.value))));break;case"avatarAnimate":{const t=p.getInstance().getRiveInstance();t&&r.value&&t.play(r.value);break}default:c.style[r.action]=r.value}}},E=t=>{var e;const o=[];return t?((null===(e=t.split(";"))||void 0===e?void 0:e.map((t=>t.trim()))).forEach((t=>{if(t){const[e,n]=t.split("=").map((t=>t.trim())),a=e.lastIndexOf(".");if(-1!==a){const t=e.substring(0,a).trim(),r=e.substring(a+1).trim();o.push({actor:t,action:r,value:n.replace(/['"]/g,"")})}}})),o):o},I=(t,e)=>{const o=t.split(",").map((t=>t.trim()));let n=0,a=new Set;for(const t of o)if(t.startsWith("(")&&t.endsWith(")")){const o=t.slice(1,-1).split("|").map((t=>t.trim())),a=e[n].slice(1,-1).split("|").map((t=>t.trim()));if(n>a.length)return!1;for(let t=0;t<o.length;t++)if(!o.includes(a[t]))return!1;n++}else if(t.includes("|")){const e=t.split("|").map((t=>t.trim()));for(const t of e)a.add(t)}else{if(n>=e.length||e[n]!==t)return!1;n++}for(;n<e.length;){if(!a.has(e[n]))return!1;a.delete(e[n]),n++}return n===e.length},j=t=>{const e=t.split(",").map((t=>t.trim()));let o=0;for(const t of e)t.startsWith("(")&&t.endsWith(")")?t.includes("|")?o+=t.split("|").length:o+=1:o+=t.split("|").length;return o};async function T(t,n){var a;const r=document.querySelector("#lido-container");if(!r)return;if("true"===r.getAttribute("isAllowOnlyCorrect")&&!n.value.includes(t.value))return t.style.transform="translate(0,0)",void("option"===t.type&&Array.from(r.querySelectorAll(`[value="${t.value}"]`)).forEach((e=>{e!==t&&e.getAttribute("value")===t.getAttribute("value")&&e.replaceWith(t)})));await C("this.alignMatch='true'",n,t);let i=JSON.parse(null!==(a=localStorage.getItem(e))&&void 0!==a?a:"{}");const c=n.getAttribute("tabindex");i[c]||(i[c]=[]),i[c].push(t.value),localStorage.setItem(e,JSON.stringify(i));const l=Object.keys(i).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>{const o=i[e];return t.push(o.length>1?`(${o.join("|")})`:o[0]),t}),[]);localStorage.setItem(o,JSON.stringify(l)),document.querySelectorAll("[type='drop']").forEach((t=>{var o;const n=JSON.parse(localStorage.getItem(e))||{};Object.keys(n).map(Number).includes(t.tabIndex)?(null===(o=t.getAttribute("dropAttr"))||void 0===o?void 0:o.toLowerCase())!==s.Diagonal&&("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor="transparent"),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="0")):("lido-text"===t.tagName.toLowerCase()&&(t.style.border="",t.style.backgroundColor=""),"lido-image"===t.tagName.toLowerCase()&&(t.style.opacity="1"))})),F()}const D=t=>{t?k.rightMoves+=1:k.wrongMoves+=1,console.log("Right Moves : ",k.rightMoves),console.log("Wrong Moves : ",k.wrongMoves)},F=()=>{var t;const e=document.querySelector("#lido-container"),n=e.objective,a=null!==(t=localStorage.getItem(o))&&void 0!==t?t:"",r=document.querySelector("#lido-checkButton");a&&j(a)===j(n)?"true"==e.getAttribute("showCheck")?r.classList.remove("lido-disable-check-button"):W():C("this.addClass='lido-disable-check-button'",r)},W=async()=>{var t;const e=document.querySelector("#lido-container");if(!e)return;const a=e.objective,r=null!==(t=JSON.parse(localStorage.getItem(o)))&&void 0!==t?t:[];if(I(a,r)){const t=e.getAttribute("onCorrect");t&&await C(t,e),P()}else{const t=e.getAttribute("onInCorrect");await C(t,e),"true"===e.getAttribute("isContinueOnCorrect")||P()}await(()=>{const t=k.rightMoves;(t=>{var e,o,a;const r=document.querySelector("lido-home");if(!r)return;const i=Number(null!==(e=r.getAttribute("index"))&&void 0!==e?e:0),c=Number(null!==(o=r.getAttribute("totalIndex"))&&void 0!==o?o:0),l=JSON.parse(null!==(a=localStorage.getItem(n))&&void 0!==a?a:"{}");if(l[i.toString()]=t,function(t,e,o){d("lidoActivityEnd",{index:t,totalIndex:e,score:o})}(i,c,t),localStorage.setItem(n,JSON.stringify(l)),c-1==i){const t=Object.values(l),e=t.reduce(((t,e)=>t+e),0)/t.length;k.finalScore=Math.floor(e),console.log("Total Score : ",k.finalScore),function(t){d("lidoLessonEnd",{score:t})}(e),localStorage.removeItem(n)}})(Math.floor(t/(t+k.wrongMoves)*100)),k.rightMoves=0,k.wrongMoves=0})()},P=()=>{h.getI().stop(),console.log("ðŸš€ ~ triggerNextContainer ~ event:",event),d(a,{})},R=async(t,n)=>{const a=document.querySelector("#lido-container");if(!a)return;const r=t.getAttribute("onEntry");await C(r,t);const i=a.getAttribute("canplay");if(null==i||"false"!==i){switch(n){case"drag":!function(t){let o=!1,n=!1,a=0,r=0,i=0,c=0,l=null;const d=document.querySelector("#lido-container");if(!d)return void console.error('Container with ID "container" not found.');let u,m;q(t,"drag");const f=e=>{var d;if(h.getI().stop(),G(t),o=!0,n=!0,e instanceof MouseEvent?(a=e.clientX,r=e.clientY):(a=e.touches[0].clientX,r=e.touches[0].clientY),t.style.opacity="0.8",t.style.cursor="grabbing",(null===(d=t.getAttribute("dropAttr"))||void 0===d?void 0:d.toLowerCase())===s.Diagonal){const e=window.getComputedStyle(t),o=t.getBoundingClientRect();l||(l=t.cloneNode(!0),l.style.left=`${o.left}px`,l.style.top=`${o.top}px`,l.style.width=`${o.width}px`,l.style.height=`${o.height}px`,l.style.transform=e.transform,l.style.zIndex="0",l.setAttribute("visible","true"),l.classList.add("cloned-element"),document.body.appendChild(l))}const u=window.getComputedStyle(t).transform;if("none"!==u){const t=u.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");i=parseFloat(e[4]),c=parseFloat(e[5])}}else i=0,c=0;document.addEventListener("mousemove",b),document.addEventListener("mouseup",y),document.addEventListener("touchmove",b),document.addEventListener("touchend",y)},p=d.getBoundingClientRect(),g=t.getBoundingClientRect();u=p.top-g.top,m=p.left-g.left;const v=new MutationObserver((e=>{for(const o of e)if("attributes"===o.type&&"style"===o.attributeName){const e=d.getBoundingClientRect(),o=t.getBoundingClientRect();u=e.top-o.top,m=e.left-o.left}}));v.observe(d,{attributes:!0,attributeFilter:["style"]});const b=l=>{if(!o)return;n=!1,t.style.transition="none";const f=$(d);let p=0,h=0;l instanceof MouseEvent?(p=(l.clientX-a)/f,h=(l.clientY-r)/f):(p=(l.touches[0].clientX-a)/f,h=(l.touches[0].clientY-r)/f);const g=i+p,v=c+h,b=d.getBoundingClientRect(),S=t.getBoundingClientRect(),y=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),w=S.left/f-y[0],x=S.top-y[1],O=b.width/f-Math.abs(m/f)-S.width/f,N=b.left-w,k=b.top-x,J=b.height/f-Math.abs(u/f)-S.height/f,A=g+w<=b.left?N:Math.min(g,O),C=v+x<=b.top?k:Math.min(v,J);t.style.transform=`translate(${A}px, ${C}px)`;let E=M(t,"drop");document.querySelectorAll("[type='drop']").forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==s.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))})),E&&("lido-text"===E.tagName.toLowerCase()?(E.style.border="2px dashed #ff0000",E.style.backgroundColor="rgba(255, 0, 0, 0.1)"):E.style.opacity="0.3")};let S=null;const y=()=>{var a;if(o=!1,n)return l&&(l.remove(),l=null),void(t.style.opacity="1");document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",y),t.style.opacity="",t.style.cursor="move";const r=document.querySelectorAll("[type='drop']");r.forEach((()=>{r.forEach((o=>{var n;const a=JSON.parse(localStorage.getItem(e))||{};Object.keys(a).map(Number).includes(o.tabIndex)?(null===(n=t.getAttribute("dropAttr"))||void 0===n?void 0:n.toLowerCase())!==s.Diagonal&&("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor="transparent"),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="0")):("lido-text"===o.tagName.toLowerCase()&&(o.style.border="",o.style.backgroundColor=""),"lido-image"===o.tagName.toLowerCase()&&(o.style.opacity="1"))}))}));let i=M(t,"drop");A(t,i),(null===(a=t.getAttribute("dropAttr"))||void 0===a?void 0:a.toLowerCase())===s.Diagonal&&(i?t&&(t.classList.add("diagonal-drop"),i.classList.add("diagonal-target"),S=i):(S&&(S.classList.remove("diagonal-target"),S=null),null==t||t.classList.remove("diagonal-drop"),t.style.transform="translate(0, 0)",l&&(l.remove(),l=null)))};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",f),t.addEventListener("touchstart",f),t.addEventListener("click",(()=>{n&&B(t,"drag")}))}(t);break;case"click":!function(t){if(q(t,"click"),t.style.cursor="pointer",!t)return void console.error("No element provided.");t.addEventListener("click",(async()=>{h.getI().stop();const n=document.querySelector("#lido-container"),a=n.objective.split(","),r=document.querySelector("#lido-checkButton"),i="true"===n.getAttribute("showCheck");if("lido-checkButton"==t.getAttribute("id"))return r.classList.add("lido-disable-check-button"),void await W();const c=t.classList.contains("lido-element-selected");let l=JSON.parse(localStorage.getItem(o))||[];if(1===a.length){localStorage.setItem(o,JSON.stringify([t.value]));const e=a.includes(t.value);if(f(t,e),e){const e=t.getAttribute("onCorrect");t.style.pointerEvents="none",await C(e,t)}else{const e=t.getAttribute("onInCorrect");await C(e,t)}return D(e),void F()}if(i&&r.classList.remove("lido-disable-check-button"),c){t.classList.remove("lido-element-selected"),C(t.getAttribute("onEntry"),t),l=l.filter((e=>e!=t.value)),localStorage.setItem(o,JSON.stringify(l));let n=JSON.parse(localStorage.getItem(e))||{};const a=t.value,c=Object.keys(n).find((t=>n[t].includes(a)));if(c){n[c]=n[c].filter((t=>t!==a)),0===n[c].length&&delete n[c],localStorage.setItem(e,JSON.stringify(n));const t=Object.keys(n).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(n[e])),[]);localStorage.setItem(o,JSON.stringify(t))}i&&0===l.length&&r.classList.add("lido-disable-check-button")}else{{t.classList.add("lido-element-selected");const n=t.value,r=Object.keys(a).find((t=>a[t]===n));let i=JSON.parse(localStorage.getItem(e))||{};r?i[r]=[n]:i[a.length+l.length]=[n],localStorage.setItem(e,JSON.stringify(i));const c=Object.keys(i).sort(((t,e)=>parseInt(t)-parseInt(e))).reduce(((t,e)=>t.concat(i[e])),[]);localStorage.setItem(o,JSON.stringify(c));const s=a.includes(t.value);if(f(t,s),s){const e=t.getAttribute("onCorrect");await C(e,t)}else{const e=t.getAttribute("onInCorrect");await C(e,t)}D(s)}i||j(a)!==j(l)||W()}})),t.addEventListener("pointerdown",(()=>{"clickable"===t.getAttribute("animation")&&(t.classList.add("removeShadow"),t.style.top="40px",t.style.position="relative")})),t.addEventListener("pointerup",(()=>{"clickable"===t.getAttribute("animation")&&setTimeout((()=>{t.classList.remove("removeShadow"),t.style.top="0px",t.style.position="relative"}),50)}))}(t);break;case"drop":!function(t){let e=JSON.parse(localStorage.getItem(c)||"{}");const o=t.getAttribute("tabIndex");"object"==typeof e&&null!==e||(e={}),e[o]||(e[o]={drop:t.id,isFull:!1},localStorage.setItem(c,JSON.stringify(e))),t.onclick=()=>{B(t,"drop")},q(t,"drop")}(t);break;case"slide":!function(t){let e=!1,n=!1,a=0,r=0,i=0,c=0;const l=t.parentElement;if(!l)return void console.error("Parent element not found.");const s=e=>{G(t),n=!0,e instanceof MouseEvent?(a=e.clientX,r=e.clientY):(a=e.touches[0].clientX,r=e.touches[0].clientY),t.style.opacity="0.8",t.style.cursor="grabbing";const o=window.getComputedStyle(t).transform;if("none"!==o){const t=o.match(/matrix\(([^)]+)\)/);if(t){const e=t[1].split(", ");i=parseFloat(e[4]),c=parseFloat(e[5])}}else i=0,c=0;l.getBoundingClientRect(),t.getBoundingClientRect(),document.addEventListener("mousemove",d),document.addEventListener("mouseup",u),document.addEventListener("touchmove",d),document.addEventListener("touchend",u)};new MutationObserver((e=>{for(const o of e)"attributes"===o.type&&"style"===o.attributeName&&(l.getBoundingClientRect(),t.getBoundingClientRect())})).observe(l,{attributes:!0,attributeFilter:["style"]});const d=o=>{if(!n)return;const s=$(l);let d=0,u=0;o instanceof MouseEvent?(d=(o.clientX-a)/s,u=(o.clientY-r)/s):(d=(o.touches[0].clientX-a)/s,u=(o.touches[0].clientY-r)/s);const m=i+d,f=c+u,p=l.getBoundingClientRect(),h=t.getBoundingClientRect(),g=t.style.transform.match(/-?\d+(\.\d+)?/g).map(Number),v=h.left/s-g[0],b=h.top-g[1],S=p.top-b,y=p.bottom-(h.bottom-g[1]),w=m+v<=p.left?p.left-v:Math.min(m,p.right-(h.right/s-g[0])),x=f+b<=p.top?S:Math.min(f,y);t.style.transform=`translate(${w}px, ${x}px)`;let O=M(t,"slide");if(O&&O!=t){const n=t.parentElement,l=O.parentElement;if(n&&l){const s=document.createComment("element-placeholder"),d=document.createComment("overlapped-placeholder");n.replaceChild(s,t),l.replaceChild(d,O),n.replaceChild(O,s),l.replaceChild(t,d),t.style.transform="translate(0, 0)",a=o instanceof MouseEvent?o.clientX:o.touches[0].clientX,r=o instanceof MouseEvent?o.clientY:o.touches[0].clientY,i=0,c=0,e=!0}}},u=()=>{n=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",u),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",u),t.style.opacity="",t.style.cursor="move",t.style.transform="translate(0, 0)",e&&((t=>{const e=JSON.parse(localStorage.getItem(o))||[],n=document.querySelectorAll("[type='slide']");let a=0;n.forEach((t=>{e[a++]=t.value})),localStorage.setItem(o,JSON.stringify(e));const r=document.querySelector("#lido-container").objective.split(","),i=e.indexOf(t.value),c=I(t.value,[r[i].trim()]);D(c),F()})(t),e=!1)};t.style.cursor="move",t.style.transform="translate(0, 0)",t.addEventListener("mousedown",s),t.addEventListener("touchstart",s),t.addEventListener("click",(()=>{B(t,"drag")}))}(t);break;case"word":case"option":!function(t){let o=!1,n=!1,a=0,r=0,i=0,c=0;const l=document.querySelector("#lido-container"),s=document.querySelector('[type="blank"]'),d=t.parentElement!==s?t.parentElement:null,u=t.getAttribute("type"),m=l.querySelector('[type="optionArea"]');if(m&&(m.style.display="block",m.style.overflowY="auto"),!l)return void console.error('Container with ID "lido-container" not found.');const f=e=>{const d=w(e),m=Math.abs(d.clientX-i),f=Math.abs(d.clientY-c);if(!o&&(m>5||f>5)){if(o=!0,t.parentElement!==s&&"word"===u){const e=b(t);t.parentElement.insertBefore(e,t.nextElementSibling)}if("category"!==t.parentElement.getAttribute("type")&&"option"===u){const e=b(t);e.setAttribute("value",`${t.getAttribute("value")}`),e.style.visibility="hidden",t.parentElement.insertBefore(e,t.nextElementSibling)}const e=l.getBoundingClientRect(),n=v(l),i=(d.clientY-e.top-r)/n;t.style.left=(d.clientX-e.left-a)/n+"px",t.style.top=`${i}px`;const c=t.getBoundingClientRect();a=d.clientX-c.left,r=d.clientY-c.top,t.style.opacity="0.8",t.style.cursor="grabbing",t.style.position="absolute",t.style.zIndex="1000",t.style.touchAction="none",t.style.transition="none"}if(!o)return;n=!1,e.preventDefault();const p=l.getBoundingClientRect(),h=v(l),S=(d.clientY-p.top-r)/h;let x;if(t.style.left=(d.clientX-p.left-a)/h+"px",t.style.top=`${S}px`,"option"===u)x=y(t,"option")||y(t,"dummy");else if(x=y(t,"word")||y(t,"dummy"),x&&x.parentElement!==document.querySelector('[type="blank"]'))return;x&&"dummy"===x.getAttribute("type")||null!==g&&g===x||(function(t,e){var o,n;if(t===e)return;if(e&&"option"===e.getAttribute("type")&&"category"!==e.parentElement.getAttribute("type"))return;if("word"===t.getAttribute("type")&&!y(t,"blank"))return;if("option"===t.getAttribute("type")&&!y(t,"category"))return;const a=document.querySelector('[type="blank"]'),r=document.querySelector('[type="dummy"]');if(r)if(e)null===(o=e.parentNode)||void 0===o||o.insertBefore(r,e);else{const e=y(t,"category");e?e.appendChild(r):a.appendChild(r)}else{const o=b(t);o.style.visibility="hidden",o.setAttribute("type","dummy");const r=`\n      @keyframes widthIncrease {\n        0% { width: 0px; height: 0px; }\n        100% { width: ${t.offsetWidth}px; height: ${t.offsetHeight}px;}\n      }\n    `;if(e)null===(n=e.parentNode)||void 0===n||n.insertBefore(o,e);else{const e=y(t,"category");e?e.appendChild(o):a.appendChild(o)}const i=document.styleSheets[0];i.insertRule(r,i.cssRules.length),o.style.animation="widthIncrease 0.5s",o.addEventListener("animationend",(()=>{o.style.width=`${t.offsetWidth}px`,o.style.height=`${t.offsetHeight}px`}))}}(t,x),g=x)},p=()=>{o=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",f),document.removeEventListener("touchend",p);const a=document.querySelector('[type="dummy"]');if(n)h(t);else if("option"!==u){if(y(t,"blank")&&a&&a.replaceWith(t),d){const e=Array.from(d.children);(function(t,e){const o=t.getBoundingClientRect(),n=e.getBoundingClientRect();return!(o.right<n.left||o.left>n.right||o.bottom<n.top||o.top>n.bottom)}(t,d)||t.parentElement===d)&&e.forEach((e=>{e!==t&&e.getAttribute("value")===t.getAttribute("value")&&e.replaceWith(t)}))}S(t),g=null,O(s,t)}else{const o=y(t,"category"),n=Array.from(l.querySelectorAll(`[value="${t.getAttribute("value")}"]`)).find((e=>e!==t));if(o){if(a&&(a.replaceWith(t),o.parentElement.classList.add("highlight-element"),l.querySelectorAll('[type="category"]').forEach((t=>{t!==o&&t.parentElement.classList.remove("highlight-element")})),N(t,o)),n){const t=document.styleSheets[0];t.insertRule(`\n            @keyframes widthDecrease {\n              0% { width: ${n.offsetWidth}px; height: ${n.offsetHeight}px; }\n              100% { width: 0px; height: 0px;}\n            }\n          `,t.cssRules.length),n.style.animation="widthDecrease 0.5s",n.addEventListener("animationend",(()=>{n.remove()}))}}else if("category"!==t.parentElement.type)C("this.alignMatch=true",n,t),setTimeout((()=>{n.replaceWith(t)}),500);else{const o=t.parentElement,n=JSON.parse(localStorage.getItem(e))||{},r=o.tabIndex,i=t.value;n[r]&&(n[r]=n[r].filter((t=>t!==i)),localStorage.setItem(e,JSON.stringify(n))),m.scrollTo({top:m.scrollHeight,behavior:"smooth"}),m.appendChild(t),a&&a.remove()}S(t)}},h=t=>{if("option"===u){const o=l.querySelectorAll('[type="category"]'),n=Array.from(o).find((t=>t.parentElement.className.includes("highlight-element")));if("category"===t.parentElement.getAttribute("type")){const o=JSON.parse(localStorage.getItem(e))||{},a=n.tabIndex,r=t.value;o[a]&&(o[a]=o[a].filter((t=>t!==r)),localStorage.setItem(e,JSON.stringify(o)));const i=b(t);return m.appendChild(i),m.scrollTo({top:m.scrollHeight,behavior:"smooth"}),t.style.position="absolute",C("this.alignMatch='true'",i,t),void setTimeout((()=>{S(t),i.replaceWith(t)}),500)}{if(!n)return;const e=b(t);return n.appendChild(e),t.style.position="absolute",C("this.alignMatch=true",e,t),void setTimeout((()=>{e.replaceWith(t),S(t),N(t,n),t.style.transform="translate(0,0)",t.style.marginBottom="10px"}),500)}}if("word"===u&&t.parentElement===d){const e=b(t);return e.style.visibility="hidden",s.appendChild(e),C("this.alignMatch=true",e,t),void setTimeout((()=>{const o=b(t);t.parentElement.insertBefore(o,t.nextElementSibling),e.replaceWith(t),t.style.transform="translate(0,0)",O(s,t)}),500)}{const e=Array.from(d.children).find((e=>e.getAttribute("value")===t.getAttribute("value")));C("this.alignMatch=true",e,t),setTimeout((()=>{e.replaceWith(t),t.style.transform="translate(0,0)"}),500)}};t.style.cursor="move",t.addEventListener("pointerdown",(t=>{n=!0,o=!1;const e=w(t);i=e.clientX,c=e.clientY,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",p)}))}(t)}!function(t){if(!t)return;const e=t.getAttribute("onTouch");e&&(t.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",e),e&&await C(e,t)})}(t)}};async function B(t,e){if(document.querySelectorAll(`[type='${e}']`).forEach((t=>{G(t)})),!document.querySelector("#dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style",t.innerHTML="\n      .highlight {\n        // border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        // border-radius: 12px; /* Larger rounded corners */\n        // background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        // box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        // outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    ",document.head.appendChild(t)}null==t||t.classList.add("highlight"),t.ariaPressed="true";const o="drop"===e?t:document.querySelector("[type='drop'].highlight"),n="drag"===e?t:document.querySelector("[type='drag'].highlight");if(o||async function(t){const e=JSON.parse(localStorage.getItem(c)||"{}"),o=t;if(!o)return void console.error("Element not found");const n=getComputedStyle(o).transform;if(G(t),n&&"none"!==n&&"matrix(1, 0, 0, 1, 0, 0)"!==n)return o.style.transition="transform 0.5s ease",o.style.transform="translate(0px, 0px)",void A(o,null);let a=Object.values(e).find((t=>!t.isFull));if(a){const t=document.querySelector(`#${a.drop}`);o.style.transition="transform 0.5s ease",A(o,t)}}(t),o&&n){n.style.transition="transform 0.5s ease",n.style.transform="";const t=document.querySelector("#lido-container"),e=$(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",e);const a=o.getBoundingClientRect(),r=n.getBoundingClientRect();n.style.transform=`translate(${(a.left-r.left)/e}px, ${(a.top-r.top)/e}px)`,document.querySelectorAll("*").forEach((t=>{G(t)})),await A(n,o)}}const L=new Map;function G(t){t.classList.remove("highlight"),t.ariaPressed="false"}function U(t){if(!t)return;t.classList.add("speaking-highlight");const e="#speaking-highlight-style";if(!document.querySelector(e)){const o=document.createElement("style");o.id=e,o.innerHTML=`\n      .speaking-highlight {\n        --base-transform: ${t.style.transform};\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9) !important; /* Stronger orange glow effect */\n        // border: 3px solid green !important;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: var(--base-transform) scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: var(--base-transform) scale(1.05);\n        }\n      }\n    `,document.head.appendChild(o)}}function X(t){t&&t.classList.remove("speaking-highlight")}function Y(e){const o=document.querySelector("#lido-container").getAttribute("baseUrl");return(null==e?void 0:e.startsWith("http"))||(null==e?void 0:e.startsWith("blob"))?e:o?o+e:t(e)}function H(t,e,o,n,a){if(void 0===n)return;const r=Array.from(t.children);let i=n;e&&n<e&&(i=e),o&&n>o&&(i=o),r.forEach(((t,e)=>{t.style.display=e<i?a:"none"}))}const V=(t,e)=>t&&t.includes(",")?t.split(",").reduce(((t,e)=>{const[o,n]=e.split(".");return t[o.trim()]=n.trim(),t}),{})[e]||"":t,q=(t,e)=>{const o=document.querySelectorAll("[type='drag']"),n=document.querySelectorAll("[type='drop']"),a=document.querySelectorAll("[type='click']");let r=0;if("click"===e)return a.forEach((t=>{const e=t;let o=null;if(e.getAttribute("flexibleWidth"))o=e;else{const t=e.children;for(let e=0;e<t.length;e++){const n=t[e];if(n.getAttribute("flexibleWidth")){o=n;break}}}if(o){const t=o.style.width,e=o.style.padding;o.style.width="auto",o.style.padding="0 20px";const n=o.offsetWidth;o.style.width=t,o.style.padding=e,n>r&&(r=n)}})),void a.forEach((t=>{const e=t;if(e.getAttribute("flexibleWidth")){if("true"===e.getAttribute("flexibleWidth"))return;e.style.width=`${r}px`}else{const t=e.children;for(let e=0;e<t.length;e++){const o=t[e];if(o.getAttribute("flexibleWidth")){if("true"===o.getAttribute("flexibleWidth"))return;o.style.width=`${r}px`;break}}}}));o.forEach((t=>{const e=t,o=e.style.width,n=e.style.padding;e.style.width="auto",e.style.padding="0 20px";const a=e.offsetWidth;e.style.width=o,e.style.padding=n,a>r&&(r=a)})),o.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");"false"===n?o.style.width=`${r}px`:"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")})),n.forEach((t=>{const o=t,n=o.getAttribute("flexibleWidth");if("false"===n){const t=parseFloat(getComputedStyle(o).borderWidth);if("number"==typeof t){const e=r-2*t,n=parseFloat(o.style.height)-2*t;return o.style.height=`${n}px`,void(o.style.width=`${e}px`)}}else"true"===n&&"drag"===e&&(o.style.width="auto",o.style.padding="0 20px")}))};export{e as D,a as N,p as R,o as S,l as T,i as a,c as b,Y as c,m as d,u as e,J as f,H as h,R as i,V as p,P as t}