const t="lidoDragSelectedMap";const o="lidoSelectedValues";const n="lidoActivityScore";const e="lidoActivityEnd";const c="lidoLessonEnd";const s="lidoNextContainer";const a="lidoActivityChange";const i="lidoGameCompleted";const r="lidoElementDrop";const l="lidoElementClick";var u;(function(t){t["NoFlow"]="lido-noFlow";t["ShowFlow"]="lido-showFlow";t["FreeTrace"]="lido-freeTrace";t["BlindTracing"]="lido-blindTracing";t["BlindFreeTrace"]="lido-blindFreeTrace"})(u||(u={}));class d{constructor(){this.rightMoves=0;this.wrongMoves=0;this.finalScore=0}}function f(t,o){const n=new CustomEvent(t,{detail:o});window.dispatchEvent(n)}function m(t,o,n){f(e,{index:t,totalIndex:o,score:n})}function h(t){f(c,{score:t})}function g(){f(s,{})}function p(){f(i,{})}function b(t){f(a,{index:t})}function w(t,o,n){f(r,{dragElement:t,dropElement:o,isCorrect:n,createdAt:(new Date).toISOString()})}function x(t,o){f(l,{element:t,isCorrect:o,createdAt:(new Date).toISOString()})}const v=new d;function M(t,o,n){return(t||"")+(o?` ${o}`:"")+(n?` ${n}`:"")}const S=t=>{const o=window.getComputedStyle(t).transform;if(o==="none"){return 1}else{const t=o.match(/matrix\(([^)]+)\)/);if(t){const o=t[1].split(", ");const n=parseFloat(o[0]);return n}}return 1};function y(t){let o=false;let n=false;let e=0;let c=0;let s=0;let a=0;const i=t.parentElement;if(!i){console.error(`Parent element not found.`);return}const r=o=>{W(t);n=true;if(o instanceof MouseEvent){e=o.clientX;c=o.clientY}else{e=o.touches[0].clientX;c=o.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const r=window.getComputedStyle(t).transform;if(r!=="none"){const t=r.match(/matrix\(([^)]+)\)/);if(t){const o=t[1].split(", ");s=parseFloat(o[4]);a=parseFloat(o[5])}}else{s=0;a=0}i.getBoundingClientRect();t.getBoundingClientRect();document.addEventListener("mousemove",d);document.addEventListener("mouseup",f);document.addEventListener("touchmove",d);document.addEventListener("touchend",f)};const l=new MutationObserver((o=>{for(const n of o){if(n.type==="attributes"&&n.attributeName==="style"){i.getBoundingClientRect();t.getBoundingClientRect()}}}));const u={attributes:true,attributeFilter:["style"]};l.observe(i,u);const d=r=>{if(!n)return;const l=S(i);let u=0;let d=0;if(r instanceof MouseEvent){u=(r.clientX-e)/l;d=(r.clientY-c)/l}else{u=(r.touches[0].clientX-e)/l;d=(r.touches[0].clientY-c)/l}const f=s+u;const m=a+d;const h=i.getBoundingClientRect();const g=t.getBoundingClientRect();const p=t.style.transform.match(/-?\d+(\.\d+)?/g);const b=p.map(Number);const w=g.left/l-b[0];const x=g.top-b[1];const v=g.right/l-b[0];const M=g.bottom-b[1];const y=h.right-v;const k=h.left-w;const N=h.top-x;const C=h.bottom-M;const O=f+w<=h.left?k:Math.min(f,y);const E=m+x<=h.top?N:Math.min(m,C);t.style.transform=`translate(${O}px, ${E}px)`;const J=document.querySelectorAll("[type='slide']");let $=null;let T=0;J.forEach((o=>{if(o===t)return;const n=o.getBoundingClientRect();const e=g.width*g.height;const c=n.width*n.height;const s=Math.max(0,Math.min(g.right,n.right)-Math.max(g.left,n.left));const a=Math.max(0,Math.min(g.bottom,n.bottom)-Math.max(g.top,n.top));const i=s*a;const r=Math.min(e,c)*.8;if(i>=r&&i>T){T=i;$=o}}));if($){if($!=t){const n=t.parentElement;const i=$.parentElement;if(n&&i){const l=document.createComment("element-placeholder");const u=document.createComment("overlapped-placeholder");n.replaceChild(l,t);i.replaceChild(u,$);n.replaceChild($,l);i.replaceChild(t,u);t.style.transform="translate(0, 0)";e=r instanceof MouseEvent?r.clientX:r.touches[0].clientX;c=r instanceof MouseEvent?r.clientY:r.touches[0].clientY;s=0;a=0;o=true}}}};const f=e=>{n=false;document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",f);document.removeEventListener("touchmove",d);document.removeEventListener("touchend",f);t.style.opacity="";t.style.cursor="move";t.style.transform="translate(0, 0)";if(o){k(t);o=false}};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",r);t.addEventListener("touchstart",r);t.addEventListener("click",(o=>{V(t,"drag")}))}const k=t=>{const n=JSON.parse(localStorage.getItem(o))||[];const e=document.querySelectorAll("[type='slide']");let c=0;e.forEach((t=>{n[c++]=t["value"]}));localStorage.setItem(o,JSON.stringify(n));const s=document.getElementById("lido-container")["objective"];const a=s.split(",");const i=n.indexOf(t["value"]);const r=J(t["value"],[a[i].trim()]);F(r);D()};function N(t){let o=false;let n=0;let e=0;let c=0;let s=0;const a=document.getElementById("lido-container");if(!a){console.error(`Container with ID "container" not found.`);return}let i;let r;const l=l=>{W(t);o=true;if(l instanceof MouseEvent){n=l.clientX;e=l.clientY}else{n=l.touches[0].clientX;e=l.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const u=window.getComputedStyle(t).transform;if(u!=="none"){const t=u.match(/matrix\(([^)]+)\)/);if(t){const o=t[1].split(", ");c=parseFloat(o[4]);s=parseFloat(o[5])}}else{c=0;s=0}const d=a.getBoundingClientRect();const h=t.getBoundingClientRect();i=d.top-h.top;r=d.left-h.left;document.addEventListener("mousemove",f);document.addEventListener("mouseup",m);document.addEventListener("touchmove",f);document.addEventListener("touchend",m)};const u=new MutationObserver((o=>{for(const n of o){if(n.type==="attributes"&&n.attributeName==="style"){const o=a.getBoundingClientRect();const n=t.getBoundingClientRect();i=o.top-n.top;r=o.left-n.left}}}));const d={attributes:true,attributeFilter:["style"]};u.observe(a,d);const f=l=>{if(!o)return;const u=S(a);let d=0;let f=0;if(l instanceof MouseEvent){d=(l.clientX-n)/u;f=(l.clientY-e)/u}else{d=(l.touches[0].clientX-n)/u;f=(l.touches[0].clientY-e)/u}const m=c+d;const h=s+f;const g=a.getBoundingClientRect();const p=t.getBoundingClientRect();const b=t.style.transform.match(/-?\d+(\.\d+)?/g);const w=b.map(Number);const x=p.left/u-w[0];const v=p.top-w[1];const M=g.width/u-Math.abs(r/u)-p.width/u;const y=g.left-x;const k=g.top-v;const N=g.height/u-Math.abs(i/u)-p.height/u;const C=m+x<=g.left?y:Math.min(m,M);const O=h+v<=g.top?k:Math.min(h,N);t.style.transform=`translate(${C}px, ${O}px)`;const E=document.querySelectorAll("[type='drop']");let J=null;let $=0;E.forEach((t=>{const o=t.getBoundingClientRect();const n=Math.max(0,Math.min(p.right,o.right)-Math.max(p.left,o.left));const e=Math.max(0,Math.min(p.bottom,o.bottom)-Math.max(p.top,o.top));const c=n*e;if(c>$){$=c;J=t}}));E.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));if(J){J.style.border="2px dashed #ff0000";J.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const m=n=>{o=false;document.removeEventListener("mousemove",f);document.removeEventListener("mouseup",m);document.removeEventListener("touchmove",f);document.removeEventListener("touchend",m);t.style.opacity="";t.style.cursor="move";const e=document.querySelectorAll("[type='drop']");e.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));const c=t.getBoundingClientRect();let s=null;let a=0;e.forEach((t=>{const o=t.getBoundingClientRect();const n=Math.max(0,Math.min(c.right,o.right)-Math.max(c.left,o.left));const e=Math.max(0,Math.min(c.bottom,o.bottom)-Math.max(c.top,o.top));const i=n*e;if(i>a){a=i;s=t}}));C(t,s)};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",l);t.addEventListener("touchstart",l);t.addEventListener("click",(o=>{V(t,"drag")}))}async function C(n,e){if(!e){const e=localStorage.getItem(o);const c=localStorage.getItem(t);if(e){let t=JSON.parse(e);t=t.filter((t=>t!=n["value"]));localStorage.setItem(o,JSON.stringify(t))}if(c){let o=JSON.parse(c);const e=n.parentElement.getAttribute("tabIndex");if(e&&o.hasOwnProperty(e)){delete o[e]}localStorage.setItem(t,JSON.stringify(o))}D();return}const c=J(e["value"],[n["value"]]);w(n,e,c);if(c){const t=e.getAttribute("onCorrect");if(t){await O(t,e,n)}}else{const t=e.getAttribute("onInCorrect");await O(t,e,n)}F(c);await T(n,e)}const O=async(t,o,n)=>{const e=E(t);for(let t=0;t<e.length;t++){const c=e[t];const s=c.actor==="this"?o:c.actor==="element"?n:document.getElementById(c.actor);if(s){switch(c.action){case"transform":{const t=window.getComputedStyle(s).transform;s.style.transform=t!=="none"?`${t} ${c.value}`:c.value;break}case"alignMatch":{const t=s;const o=n;const e=document.getElementById("lido-container");const c=S(e);const a=e.getBoundingClientRect();const i=t.getBoundingClientRect();const r=(i.left-a.left)/c;const l=(i.top-a.top)/c;o.style.position="fixed";o.style.left=`${r}px`;o.style.top=`${l}px`;o.style.transform=`translate(0px, 0px)`;break}case"addClass":{s.classList.add(c.value);break}case"speak":{{let t=s.getAttribute("audio");if(t){t=H(t);let o=document.getElementById("audio");if(!o){const t=document.createElement("audio");t.id="audio";document.body.appendChild(t);o=t}o.pause();o.currentTime=0;o.src=t;console.log("ðŸš€ ~ executeActions ~ audioElement.src:",o.src);try{await o.play();q(s);while(!o.ended||o.error){await new Promise((t=>setTimeout(t,100)))}z(s)}catch(t){console.log("ðŸš€ ~ executeActions ~ audioElement.src: error",t)}}break}}case"sleep":{const t=!isNaN(Number(c.value));if(t){await new Promise((t=>setTimeout(t,Number(c.value))))}break}default:{s.style[c.action]=c.value;break}}}}};const E=t=>{var o;const n=[];if(!t)return n;const e=(o=t.split(";"))===null||o===void 0?void 0:o.map((t=>t.trim()));e.forEach((t=>{if(t){const[o,e]=t.split("=").map((t=>t.trim()));const c=o.lastIndexOf(".");if(c!==-1){const t=o.substring(0,c).trim();const s=o.substring(c+1).trim();n.push({actor:t,action:s,value:e.replace(/['"]/g,"")})}}}));return n};const J=(t,o)=>{const n=t.split(",").map((t=>t.trim()));let e=0;let c=new Set;for(const t of n){if(t.startsWith("(")&&t.endsWith(")")){const n=t.slice(1,-1).split("|").map((t=>t.trim()));if(e>=o.length)return false;if(!n.includes(o[e]))return false;e++}else if(t.includes("|")){const o=t.split("|").map((t=>t.trim()));for(const t of o){c.add(t)}}else{if(e>=o.length||o[e]!==t)return false;e++}}while(e<o.length){if(!c.has(o[e])){return false}c.delete(o[e]);e++}return e===o.length};const $=t=>{const o=t.split(",").map((t=>t.trim()));let n=0;for(const t of o){if(t.startsWith("(")&&t.endsWith(")")){n+=1}else{n+=t.split("|").length}}return n};async function T(n,e){var c;const s=document.getElementById("lido-container");if(!s)return;const a=s.getAttribute("isAllowOnlyCorrect")==="true";if(a){const t=J(e["value"],[n["value"]]);if(!t){n.style.transform="translate(0,0)";return}}await O("this.alignMatch='true'",e,n);let i=JSON.parse((c=localStorage.getItem(t))!==null&&c!==void 0?c:"{}");if(!i[e.getAttribute("tabindex")]){i[e.getAttribute("tabindex")]=[]}i[e.getAttribute("tabindex")]=[n["value"]];localStorage.setItem(t,JSON.stringify(i));const r=Object.keys(i).sort(((t,o)=>parseInt(t)-parseInt(o)));const l=r.reduce(((t,o)=>t.concat(i[o])),[]);localStorage.setItem(o,JSON.stringify(l));D()}const F=t=>{if(t){v.rightMoves+=1}else{v.wrongMoves+=1}console.log("Right Moves : ",v.rightMoves);console.log("Wrong Moves : ",v.wrongMoves)};const I=()=>{const t=v.rightMoves;const o=v.wrongMoves;let n=Math.floor(t/(t+o)*100);A(n);v.rightMoves=0;v.wrongMoves=0};const A=t=>{var o,e,c;const s=document.querySelector("lido-home");if(!s)return;const a=Number((o=s.getAttribute("index"))!==null&&o!==void 0?o:0);const i=Number((e=s.getAttribute("totalIndex"))!==null&&e!==void 0?e:0);const r=JSON.parse((c=localStorage.getItem(n))!==null&&c!==void 0?c:"{}");const l=a.toString();r[l]=t;m(a,i,t);localStorage.setItem(n,JSON.stringify(r));if(i-1==a){const t=Object.values(r);const o=t.reduce(((t,o)=>t+o),0)/t.length;v.finalScore=Math.floor(o);console.log("Total Score : ",v.finalScore);h(o);localStorage.removeItem(n)}};const D=()=>{var t;const n=document.getElementById("lido-container");const e=n["objective"];const c=JSON.parse((t=localStorage.getItem(o))!==null&&t!==void 0?t:"[]");const s=document.getElementById("lido-checkButton");if(!c||c.length!==$(e)){O("this.addClass='disable-check-button'",s);return}const a=n.getAttribute("showCheck")=="true";if(a){s.classList.remove("lido-disable-check-button")}else{P()}};const P=async()=>{var t;const n=document.getElementById("lido-container");if(!n)return;const e=n["objective"];const c=JSON.parse((t=localStorage.getItem(o))!==null&&t!==void 0?t:"[]");const s=J(e,c);if(s){j();const t=n.getAttribute("onCorrect");if(t){await O(t,n)}B()}else{const t=n.getAttribute("onInCorrect");await O(t,n);const o=n.getAttribute("isContinueOnCorrect")==="true";if(!o){B()}}await I()};const j=()=>{const t=document.querySelectorAll("[type='drag']");const o=document.querySelectorAll("[type='drop']");if(!t||!o)return;o.forEach((o=>{t.forEach((t=>{const n=t;if(n["value"]===o["value"]){n.style.position="unset";o.appendChild(n)}}))}))};const B=()=>{console.log("ðŸš€ ~ triggerNextContainer ~ event:",event);g()};const G=async(t,o)=>{const n=document.getElementById("lido-container");if(!n)return;const e=n.getAttribute("canplay");if(e!=null&&e==="false")return;switch(o){case"drag":{N(t);break}case"click":{R(t);break}case"drop":{U(t);break}case"slide":{y(t);break}}const c=t.getAttribute("onEntry");await O(c,t);L(t)};function L(t){if(!t)return;const o=t.getAttribute("onTouch");if(!o)return;t.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",o);if(!o)return;await O(o,t)}}function R(t){t.style.cursor="pointer";if(!t){console.error("No element provided.");return}const n=async()=>{const n=document.getElementById("lido-container");if(t.getAttribute("id")=="lido-checkButton"){P();return}localStorage.setItem(o,JSON.stringify([t["value"]]));t.style.border="2px solid yellow";t.style.boxShadow="0px 0px 10px rgba(255, 255, 0, 0.7)";t.style.transition="transform 0.2s ease, border 0.5s ease";t.style.transform="scale(1.1)";t.style.transform="scale(1)";t.style.border="";t.style.boxShadow="";const e=n["objective"];const c=J(e,[t["value"]]);x(t,c);if(c){const o=t.getAttribute("onCorrect");await O(o,t)}else{const o=t.getAttribute("onInCorrect");await O(o,t)}F(c);D()};t.addEventListener("click",n)}function U(t){t.onclick=()=>{V(t,"drop")}}async function V(t,o){const n=document.querySelectorAll(`[type='${o}']`);n.forEach((t=>{W(t)}));if(!document.getElementById("dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style";t.innerHTML=`\n      .highlight {\n        border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        border-radius: 12px; /* Larger rounded corners */\n        background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    `;document.head.appendChild(t)}t===null||t===void 0?void 0:t.classList.add("highlight");t.ariaPressed="true";const e=o==="drop"?t:document.querySelector("[type='drop'].highlight");const c=o==="drag"?t:document.querySelector("[type='drag'].highlight");if(e&&c){c.style.transition="transform 0.5s ease";c.style.transform="";const t=document.getElementById("lido-container");const o=S(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",o);const n=e.getBoundingClientRect();const s=c.getBoundingClientRect();const a=(n.left-s.left)/o;const i=(n.top-s.top)/o;c.style.transform=`translate(${a}px, ${i}px)`;const r=document.querySelectorAll(`*`);r.forEach((t=>{W(t)}));await new Promise((t=>setTimeout(t,500)));await C(c,e);await new Promise((t=>setTimeout(t,500)));c.style.transform="translate(0px, 0px)"}}function W(t){t.classList.remove("highlight");t.ariaPressed="false"}function q(t){if(!t)return;t.classList.add("speaking-highlight");const o="speaking-highlight-style";if(!document.getElementById(o)){const t=document.createElement("style");t.id=o;t.innerHTML=`\n      .speaking-highlight {\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9); /* Stronger orange glow effect */\n        border: 3px solid orange;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n      }\n    `;document.head.appendChild(t)}}function z(t){if(!t)return;t.classList.remove("speaking-highlight");t.style.boxShadow="";t.style.border=""}function H(t){if(t.startsWith("http")){return t}const o=document.getElementById("lido-container");if(!o)return t;const n=o.getAttribute("baseUrl");if(!n)return t;return n+t}export{t as D,s as N,o as S,u as T,p as a,H as c,b as d,M as f,G as i,B as t};
//# sourceMappingURL=p-77e62581.js.map