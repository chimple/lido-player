const t="lidoDragSelectedMap";const n="lidoSelectedValues";const o="lidoActivityScore";const e="lidoActivityEnd";const c="lidoLessonEnd";const s="lidoNextContainer";const i="lidoActivityChange";const a="lidoGameCompleted";const r="lidoElementDrop";const l="lidoElementClick";var u;(function(t){t["NoFlow"]="lido-noFlow";t["ShowFlow"]="lido-showFlow";t["FreeTrace"]="lido-freeTrace";t["BlindTracing"]="lido-blindTracing";t["BlindFreeTrace"]="lido-blindFreeTrace"})(u||(u={}));class d{constructor(){this.rightMoves=0;this.wrongMoves=0;this.finalScore=0}}function f(t,n){const o=new CustomEvent(t,{detail:n});window.dispatchEvent(o)}function m(t,n,o){f(e,{index:t,totalIndex:n,score:o})}function h(t){f(c,{score:t})}function g(){f(s,{})}function p(){f(a,{})}function b(t){f(i,{index:t})}function w(t,n,o){f(r,{dragElement:t,dropElement:n,isCorrect:o,createdAt:(new Date).toISOString()})}function x(t,n){f(l,{element:t,isCorrect:n,createdAt:(new Date).toISOString()})}const v=new d;function S(t,n,o){return(t||"")+(n?` ${n}`:"")+(o?` ${o}`:"")}const y=t=>{const n=window.getComputedStyle(t).transform;if(n==="none"){return 1}else{const t=n.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");const o=parseFloat(n[0]);return o}}return 1};function k(t){let n=false;let o=0;let e=0;let c=0;let s=0;const i=document.getElementById("lido-container");if(!i){console.error(`Container with ID "container" not found.`);return}let a;let r;const l=l=>{U(t);n=true;if(l instanceof MouseEvent){o=l.clientX;e=l.clientY}else{o=l.touches[0].clientX;e=l.touches[0].clientY}t.style.opacity="0.8";t.style.cursor="grabbing";const u=window.getComputedStyle(t).transform;if(u!=="none"){const t=u.match(/matrix\(([^)]+)\)/);if(t){const n=t[1].split(", ");c=parseFloat(n[4]);s=parseFloat(n[5])}}else{c=0;s=0}const d=i.getBoundingClientRect();const h=t.getBoundingClientRect();a=d.top-h.top;r=d.left-h.left;document.addEventListener("mousemove",f);document.addEventListener("mouseup",m);document.addEventListener("touchmove",f);document.addEventListener("touchend",m)};const u=new MutationObserver((n=>{for(const o of n){if(o.type==="attributes"&&o.attributeName==="style"){const n=i.getBoundingClientRect();const o=t.getBoundingClientRect();a=n.top-o.top;r=n.left-o.left}}}));const d={attributes:true,attributeFilter:["style"]};u.observe(i,d);const f=l=>{if(!n)return;const u=y(i);let d=0;let f=0;if(l instanceof MouseEvent){d=(l.clientX-o)/u;f=(l.clientY-e)/u}else{d=(l.touches[0].clientX-o)/u;f=(l.touches[0].clientY-e)/u}const m=c+d;const h=s+f;const g=i.getBoundingClientRect();const p=t.getBoundingClientRect();const b=t.style.transform.match(/-?\d+(\.\d+)?/g);const w=b.map(Number);const x=p.left/u-w[0];const v=p.top-w[1];const S=g.width/u-Math.abs(r/u)-p.width/u;const k=g.left-x;const M=g.top-v;const N=g.height/u-Math.abs(a/u)-p.height/u;const C=m+x<=g.left?k:Math.min(m,S);const O=h+v<=g.top?M:Math.min(h,N);t.style.transform=`translate(${C}px, ${O}px)`;const E=document.querySelectorAll("[type='drop']");let J=null;let T=0;E.forEach((t=>{const n=t.getBoundingClientRect();const o=Math.max(0,Math.min(p.right,n.right)-Math.max(p.left,n.left));const e=Math.max(0,Math.min(p.bottom,n.bottom)-Math.max(p.top,n.top));const c=o*e;if(c>T){T=c;J=t}}));E.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));if(J){J.style.border="2px dashed #ff0000";J.style.backgroundColor="rgba(255, 0, 0, 0.1)"}};const m=o=>{n=false;document.removeEventListener("mousemove",f);document.removeEventListener("mouseup",m);document.removeEventListener("touchmove",f);document.removeEventListener("touchend",m);t.style.opacity="";t.style.cursor="move";const e=document.querySelectorAll("[type='drop']");e.forEach((t=>{t.style.border="";t.style.backgroundColor=""}));const c=t.getBoundingClientRect();let s=null;let i=0;e.forEach((t=>{const n=t.getBoundingClientRect();const o=Math.max(0,Math.min(c.right,n.right)-Math.max(c.left,n.left));const e=Math.max(0,Math.min(c.bottom,n.bottom)-Math.max(c.top,n.top));const a=o*e;if(a>i){i=a;s=t}}));M(t,s)};t.style.cursor="move";t.style.transform="translate(0, 0)";t.addEventListener("mousedown",l);t.addEventListener("touchstart",l);t.addEventListener("click",(n=>{R(t,"drag")}))}async function M(o,e){if(!e){const e=localStorage.getItem(n);const c=localStorage.getItem(t);if(e){let t=JSON.parse(e);t=t.filter((t=>t!=o["value"]));localStorage.setItem(n,JSON.stringify(t))}if(c){let n=JSON.parse(c);const e=o.parentElement.getAttribute("tabIndex");if(e&&n.hasOwnProperty(e)){delete n[e]}localStorage.setItem(t,JSON.stringify(n))}A();return}const c=O(e["value"],[o["value"]]);w(o,e,c);if(c){const t=e.getAttribute("onCorrect");if(t){await N(t,e,o)}}else{const t=e.getAttribute("onInCorrect");await N(t,e,o)}T(c);await J(o,e)}const N=async(t,n,o)=>{const e=C(t);for(let t=0;t<e.length;t++){const c=e[t];const s=c.actor==="this"?n:c.actor==="element"?o:document.getElementById(c.actor);if(s){switch(c.action){case"transform":{const t=window.getComputedStyle(s).transform;s.style.transform=t!=="none"?`${t} ${c.value}`:c.value;break}case"alignMatch":{const t=s;const n=o;const e=document.getElementById("lido-container");const c=y(e);const i=e.getBoundingClientRect();const a=t.getBoundingClientRect();const r=(a.left-i.left)/c;const l=(a.top-i.top)/c;n.style.position="fixed";n.style.left=`${r}px`;n.style.top=`${l}px`;n.style.transform=`translate(0px, 0px)`;break}case"addClass":{s.classList.add(c.value);break}case"speak":{{let t=s.getAttribute("audio");if(t){t=q(t);let n=document.getElementById("audio");if(!n){const t=document.createElement("audio");t.id="audio";document.body.appendChild(t);n=t}n.pause();n.currentTime=0;n.src=t;console.log("ðŸš€ ~ executeActions ~ audioElement.src:",n.src);try{await n.play();V(s);while(!n.ended||n.error){await new Promise((t=>setTimeout(t,100)))}W(s)}catch(t){console.log("ðŸš€ ~ executeActions ~ audioElement.src: error",t)}}break}}case"sleep":{const t=!isNaN(Number(c.value));if(t){await new Promise((t=>setTimeout(t,Number(c.value))))}break}default:{s.style[c.action]=c.value;break}}}}};const C=t=>{var n;const o=[];if(!t)return o;const e=(n=t.split(";"))===null||n===void 0?void 0:n.map((t=>t.trim()));e.forEach((t=>{if(t){const[n,e]=t.split("=").map((t=>t.trim()));const c=n.lastIndexOf(".");if(c!==-1){const t=n.substring(0,c).trim();const s=n.substring(c+1).trim();o.push({actor:t,action:s,value:e.replace(/['"]/g,"")})}}}));return o};const O=(t,n)=>{const o=t.split(",").map((t=>t.trim()));let e=0;let c=new Set;for(const t of o){if(t.startsWith("(")&&t.endsWith(")")){const o=t.slice(1,-1).split("|").map((t=>t.trim()));if(e>=n.length)return false;if(!o.includes(n[e]))return false;e++}else if(t.includes("|")){const n=t.split("|").map((t=>t.trim()));for(const t of n){c.add(t)}}else{if(e>=n.length||n[e]!==t)return false;e++}}while(e<n.length){if(!c.has(n[e])){return false}c.delete(n[e]);e++}return e===n.length};const E=t=>{const n=t.split(",").map((t=>t.trim()));let o=0;for(const t of n){if(t.startsWith("(")&&t.endsWith(")")){o+=1}else{o+=t.split("|").length}}return o};async function J(o,e){var c;const s=document.getElementById("lido-container");if(!s)return;const i=s.getAttribute("isAllowOnlyCorrect")==="true";if(i){const t=O(e["value"],[o["value"]]);if(!t){o.style.transform="translate(0,0)";return}}await N("this.alignMatch='true'",e,o);let a=JSON.parse((c=localStorage.getItem(t))!==null&&c!==void 0?c:"{}");if(!a[e.getAttribute("tabindex")]){a[e.getAttribute("tabindex")]=[]}a[e.getAttribute("tabindex")]=[o["value"]];localStorage.setItem(t,JSON.stringify(a));const r=Object.keys(a).sort(((t,n)=>parseInt(t)-parseInt(n)));const l=r.reduce(((t,n)=>t.concat(a[n])),[]);localStorage.setItem(n,JSON.stringify(l));A()}const T=t=>{if(t){v.rightMoves+=1}else{v.wrongMoves+=1}console.log("Right Moves : ",v.rightMoves);console.log("Wrong Moves : ",v.wrongMoves)};const $=()=>{const t=v.rightMoves;const n=v.wrongMoves;let o=Math.floor(t/(t+n)*100);I(o);v.rightMoves=0;v.wrongMoves=0};const I=t=>{var n,e,c;const s=document.querySelector("lido-home");if(!s)return;const i=Number((n=s.getAttribute("index"))!==null&&n!==void 0?n:0);const a=Number((e=s.getAttribute("totalIndex"))!==null&&e!==void 0?e:0);const r=JSON.parse((c=localStorage.getItem(o))!==null&&c!==void 0?c:"{}");const l=i.toString();r[l]=t;m(i,a,t);localStorage.setItem(o,JSON.stringify(r));if(a-1==i){const t=Object.values(r);const n=t.reduce(((t,n)=>t+n),0)/t.length;v.finalScore=Math.floor(n);console.log("Total Score : ",v.finalScore);h(n);localStorage.removeItem(o)}};const A=()=>{var t;const o=document.getElementById("lido-container");const e=o["objective"];const c=JSON.parse((t=localStorage.getItem(n))!==null&&t!==void 0?t:"[]");const s=document.getElementById("lido-checkButton");if(!c||c.length!==E(e)){N("this.addClass='disable-check-button'",s);return}const i=o.getAttribute("showCheck")=="true";if(i){s.classList.remove("lido-disable-check-button")}else{D()}};const D=async()=>{var t;const o=document.getElementById("lido-container");if(!o)return;const e=o["objective"];const c=JSON.parse((t=localStorage.getItem(n))!==null&&t!==void 0?t:"[]");const s=O(e,c);if(s){F();const t=o.getAttribute("onCorrect");if(t){await N(t,o)}P()}else{const t=o.getAttribute("onInCorrect");await N(t,o);const n=o.getAttribute("isContinueOnCorrect")==="true";if(!n){P()}}await $()};const F=()=>{const t=document.querySelectorAll("[type='drag']");const n=document.querySelectorAll("[type='drop']");n.forEach((n=>{t.forEach((t=>{const o=t;if(o["value"]===n["value"]){o.style.position="unset";n.appendChild(o)}}))}))};const P=()=>{console.log("ðŸš€ ~ triggerNextContainer ~ event:",event);g()};const j=async(t,n)=>{const o=document.getElementById("lido-container");if(!o)return;const e=o.getAttribute("canplay");if(e!=null&&e==="false")return;switch(n){case"drag":{k(t);break}case"click":{G(t);break}case"drop":{L(t);break}}const c=t.getAttribute("onEntry");await N(c,t);B(t)};function B(t){if(!t)return;const n=t.getAttribute("onTouch");if(!n)return;t.onclick=async()=>{console.log("ðŸš€ ~ element.onclick= ~ onTouch:",n);if(!n)return;await N(n,t)}}function G(t){t.style.cursor="pointer";if(!t){console.error("No element provided.");return}const o=async()=>{const o=document.getElementById("lido-container");if(t.getAttribute("id")=="lido-checkButton"){D();return}localStorage.setItem(n,JSON.stringify([t["value"]]));t.style.border="2px solid yellow";t.style.boxShadow="0px 0px 10px rgba(255, 255, 0, 0.7)";t.style.transition="transform 0.2s ease, border 0.5s ease";t.style.transform="scale(1.1)";t.style.transform="scale(1)";t.style.border="";t.style.boxShadow="";const e=o["objective"];const c=O(e,[t["value"]]);x(t,c);if(c){const n=t.getAttribute("onCorrect");await N(n,t)}else{const n=t.getAttribute("onInCorrect");await N(n,t)}T(c);A()};t.addEventListener("click",o)}function L(t){t.onclick=()=>{R(t,"drop")}}async function R(t,n){const o=document.querySelectorAll(`[type='${n}']`);o.forEach((t=>{U(t)}));if(!document.getElementById("dynamic-highlight-style")){const t=document.createElement("style");t.id="dynamic-highlight-style";t.innerHTML=`\n      .highlight {\n        border: 4px solid #e74c3c; /* Thicker red border for more visibility */\n        border-radius: 12px; /* Larger rounded corners */\n        background-color: rgba(231, 76, 60, 0.3); /* Stronger, more noticeable background */\n        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2), 0 12px 40px rgba(0, 0, 0, 0.2); /* Stronger shadow */\n        outline: 4px solid rgba(231, 76, 60, 0.6); /* Glow effect */\n      }\n    `;document.head.appendChild(t)}t===null||t===void 0?void 0:t.classList.add("highlight");t.ariaPressed="true";const e=n==="drop"?t:document.querySelector("[type='drop'].highlight");const c=n==="drag"?t:document.querySelector("[type='drag'].highlight");if(e&&c){c.style.transition="transform 0.5s ease";c.style.transform="";const t=document.getElementById("lido-container");const n=y(t);console.log("ðŸš€ ~ onClickDropOrDragElement ~ containerScale:",n);const o=e.getBoundingClientRect();const s=c.getBoundingClientRect();const i=(o.left-s.left)/n;const a=(o.top-s.top)/n;c.style.transform=`translate(${i}px, ${a}px)`;const r=document.querySelectorAll(`*`);r.forEach((t=>{U(t)}));await new Promise((t=>setTimeout(t,500)));await M(c,e);await new Promise((t=>setTimeout(t,500)));c.style.transform="translate(0px, 0px)"}}function U(t){t.classList.remove("highlight");t.ariaPressed="false"}function V(t){if(!t)return;t.classList.add("speaking-highlight");const n="speaking-highlight-style";if(!document.getElementById(n)){const t=document.createElement("style");t.id=n;t.innerHTML=`\n      .speaking-highlight {\n        box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9); /* Stronger orange glow effect */\n        border: 3px solid orange;\n        transition: box-shadow 0.5s ease-in-out, transform 0.5s ease-in-out;\n        transform: scale(1.05); /* Subtle scale effect to pop the element */\n        animation: pulseEffect 1.5s infinite; /* Pulsing animation */\n      }\n\n      @keyframes pulseEffect {\n        0% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n        50% {\n          box-shadow: 0 0 30px 15px rgba(255, 165, 0, 1);\n          transform: scale(1.1);\n        }\n        100% {\n          box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0.9);\n          transform: scale(1.05);\n        }\n      }\n    `;document.head.appendChild(t)}}function W(t){if(!t)return;t.classList.remove("speaking-highlight");t.style.boxShadow="";t.style.border=""}function q(t){if(t.startsWith("http")){return t}const n=document.getElementById("lido-container");if(!n)return t;const o=n.getAttribute("baseUrl");if(!o)return t;return o+t}export{t as D,s as N,n as S,u as T,p as a,q as c,b as d,S as f,j as i,P as t};
//# sourceMappingURL=p-345bd5ca.js.map